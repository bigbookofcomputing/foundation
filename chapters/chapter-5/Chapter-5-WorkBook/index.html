
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive guide to the foundations of computational science">
      
      
        <meta name="author" content="Big Book of Computing">
      
      
        <link rel="canonical" href="https://bigbookofcomputing.github.io/chapters/chapter-5/Chapter-5-WorkBook/">
      
      
        <link rel="prev" href="../../chapter-4/Chapter-4-WorkBook/">
      
      
        <link rel="next" href="../../chapter-6/Chapter-6-WorkBook/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/book-icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>5. Numerical Differentiation - Big Book of Computing | Foundation of Computational Science</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
      <link rel="stylesheet" href="../../../static/styles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ECS7B3X8JM"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ECS7B3X8JM",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ECS7B3X8JM",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#51-the-physics-of-change" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Big Book of Computing | Foundation of Computational Science" class="md-header__button md-logo" aria-label="Big Book of Computing | Foundation of Computational Science" data-md-component="logo">
      
  <img src="../../../assets/book-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Big Book of Computing | Foundation of Computational Science
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. Numerical Differentiation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bigbookofcomputing/foundation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contents/" class="md-tabs__link">
        
  
  
    
  
  Contents

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../introduction/" class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-Essay/" class="md-tabs__link">
          
  
  
    
  
  Chapters

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../chapter-1/Chapter-1-WorkBook/" class="md-tabs__link">
          
  
  
    
  
  WorkBooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-CodeBook/" class="md-tabs__link">
          
  
  
    
  
  CodeBooks

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Big Book of Computing | Foundation of Computational Science" class="md-nav__button md-logo" aria-label="Big Book of Computing | Foundation of Computational Science" data-md-component="logo">
      
  <img src="../../../assets/book-icon.png" alt="logo">

    </a>
    Big Book of Computing | Foundation of Computational Science
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bigbookofcomputing/foundation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contents
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Chapters
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chapters
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Digital Lab Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Computational Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Root Finding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Interpolation & Fitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-5-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Numerical Differentiation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Numerical Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Initial Value Problems I
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Initial Value Problems II
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Boundary Value Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Elliptic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Parabolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Hyperbolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Systems of Linear Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Eigenvalue Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Fourier Analysis & The FFT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Data-Driven Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Randomness in Physics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    WorkBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    WorkBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Digital Lab Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Computational Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Root Finding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Interpolation & Fitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    5. Numerical Differentiation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Numerical Differentiation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#51-the-physics-of-change" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 The Physics of "Change"
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.1 The Physics of &#34;Change&#34;">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-electric-field-from-a-potential-grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Electric Field from a Potential Grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-the-taylor-series-foundation-of-finite-differences" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 The Taylor Series — Foundation of Finite Differences
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2 The Taylor Series — Foundation of Finite Differences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-verifying-taylor-series-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Verifying Taylor Series Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-the-forward-difference-first-order-approximation" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 The Forward Difference — First-Order Approximation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3 The Forward Difference — First-Order Approximation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-convergence-analysis-of-forward-difference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Convergence Analysis of Forward Difference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-the-central-difference-the-workhorse-method" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 The Central Difference — The Workhorse Method
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.4 The Central Difference — The Workhorse Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-comparing-first-order-vs-second-order-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Comparing First-Order vs. Second-Order Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#55-the-second-derivative-computing-curvature" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5 The Second Derivative — Computing Curvature
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5 The Second Derivative — Computing Curvature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-verifying-second-order-convergence-of-the-laplacian" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Verifying Second-Order Convergence of the Laplacian
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#56-the-war-between-errors-finding-the-sweet-spot" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6 The War Between Errors — Finding the Sweet Spot
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.6 The War Between Errors — Finding the Sweet Spot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-visualizing-the-v-plot-for-exponential-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Visualizing the V-Plot for Exponential Function
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#57-application-force-from-lennard-jones-potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.7 Application — Force from Lennard-Jones Potential
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.7 Application — Force from Lennard-Jones Potential">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-computing-force-from-morse-potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Computing Force from Morse Potential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Numerical Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Initial Value Problems I
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Initial Value Problems II
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Boundary Value Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Elliptic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Parabolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Hyperbolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Systems of Linear Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Eigenvalue Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Fourier Analysis & The FFT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Data-Driven Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Randomness in Physics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CodeBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    CodeBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Digital Lab Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Computational Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Root Finding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Interpolation & Fitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-5-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Numerical Differentiation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Numerical Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Initial Value Problems I
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Initial Value Problems II
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Boundary Value Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Elliptic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Parabolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Hyperbolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Systems of Linear Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Eigenvalue Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Fourier Analysis & The FFT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Data-Driven Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Randomness in Physics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#51-the-physics-of-change" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 The Physics of "Change"
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.1 The Physics of &#34;Change&#34;">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-electric-field-from-a-potential-grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Electric Field from a Potential Grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-the-taylor-series-foundation-of-finite-differences" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 The Taylor Series — Foundation of Finite Differences
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2 The Taylor Series — Foundation of Finite Differences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-verifying-taylor-series-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Verifying Taylor Series Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-the-forward-difference-first-order-approximation" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 The Forward Difference — First-Order Approximation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3 The Forward Difference — First-Order Approximation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-convergence-analysis-of-forward-difference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Convergence Analysis of Forward Difference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-the-central-difference-the-workhorse-method" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 The Central Difference — The Workhorse Method
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.4 The Central Difference — The Workhorse Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-comparing-first-order-vs-second-order-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Comparing First-Order vs. Second-Order Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#55-the-second-derivative-computing-curvature" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5 The Second Derivative — Computing Curvature
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5 The Second Derivative — Computing Curvature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-verifying-second-order-convergence-of-the-laplacian" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Verifying Second-Order Convergence of the Laplacian
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#56-the-war-between-errors-finding-the-sweet-spot" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6 The War Between Errors — Finding the Sweet Spot
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.6 The War Between Errors — Finding the Sweet Spot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-visualizing-the-v-plot-for-exponential-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Visualizing the V-Plot for Exponential Function
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#57-application-force-from-lennard-jones-potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.7 Application — Force from Lennard-Jones Potential
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.7 Application — Force from Lennard-Jones Potential">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-computing-force-from-morse-potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Computing Force from Morse Potential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/bigbookofcomputing/foundation/edit/master/docs/chapters/chapter-5/Chapter-5-WorkBook.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/bigbookofcomputing/foundation/raw/master/docs/chapters/chapter-5/Chapter-5-WorkBook.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>5. Numerical Differentiation</h1>

<h2 class="heading-with-pill" id="51-the-physics-of-change">5.1 The Physics of "Change"</h2>
<blockquote>
<p><strong>Concept:</strong> Discrete Grid vs. Continuous Derivatives • <strong>Difficulty:</strong> ★★☆☆☆</p>
<p><strong>Summary:</strong> Physics is the study of change, defined by the derivative (<span class="arithmatex">\(\frac{df}{dx}\)</span>). The core computational problem is finding the slope of a continuous function when only discrete data points on a grid are available.</p>
</blockquote>
<hr />
<h3 id="theoretical-background">Theoretical Background</h3>
<p>Physics <em>is</em> the study of change. The derivative, <span class="arithmatex">\(\frac{df}{dx}\)</span>, is the fundamental language we use to <strong>describe</strong> that change. We don't just solve static problems; we <strong>model dynamic systems</strong>, and those models are built from derivatives.</p>
<p>In the continuous mathematical world, derivatives are perfectly defined operations. The derivative of a function <span class="arithmatex">\(f(x)\)</span> at a point <span class="arithmatex">\(x\)</span> is the instantaneous rate of change, the slope of the tangent line at that exact location. This is the language in which the laws of physics are written:</p>
<ul>
<li><strong>Mechanics:</strong> Force (<span class="arithmatex">\(F\)</span>) is the <em>change</em> in potential (<span class="arithmatex">\(V\)</span>): <span class="arithmatex">\(F(x) = -\frac{dV}{dx}\)</span>.</li>
<li><strong>Electromagnetism:</strong> The electric field (<span class="arithmatex">\(\mathbf{E}\)</span>) is the <em>change</em> in potential (<span class="arithmatex">\(\phi\)</span>): <span class="arithmatex">\(\mathbf{E} = -\nabla \phi\)</span>.</li>
<li><strong>Dynamics:</strong> Velocity and acceleration are the first and second derivatives of position: <span class="arithmatex">\(v(t) = \frac{dx}{dt}\)</span>, <span class="arithmatex">\(a(t) = \frac{d^2x}{dt^2}\)</span>.</li>
<li><strong>Fundamental Laws:</strong> The great laws of physics—the Schrödinger Equation, the Heat Equation, and the Wave Equation—are all <strong>differential equations</strong> written in the language of derivatives.</li>
</ul>
<p><strong>The Computational Challenge</strong></p>
<p>In our computational world, we face a fundamental problem: we do not have smooth, continuous functions. Instead, we have <em>data on a discrete grid</em>. We might have the potential <span class="arithmatex">\(V(x_i)\)</span> at discrete points <span class="arithmatex">\(x_0, x_1, x_2, \dots\)</span>. The mathematical definition of a derivative requires the limit as the spacing approaches zero:</p>
<div class="arithmatex">\[
f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}
\]</div>
<p>But on a computer, we cannot take this limit. Our grid spacing <span class="arithmatex">\(h\)</span> is finite, and we must compute the derivative <strong>from the raw grid data itself</strong>. This creates the central tension of numerical differentiation: approximating a continuous operation using discrete data.</p>
<p><strong>The Strategy</strong></p>
<p>We will derive our "derivative-finders" from the <strong>Taylor series</strong>, using it to build simple <strong>algebraic approximations</strong> for the derivative. This process reveals the "great war" of computational physics: the battle between <strong>truncation error</strong> (error from the algorithm, which decreases as <span class="arithmatex">\(h\)</span> gets smaller) and <strong>round-off error</strong> (error from the hardware, which increases as <span class="arithmatex">\(h\)</span> gets smaller). We will learn that making our grid step size <span class="arithmatex">\(h\)</span> <strong>"as small as possible" is disastrous</strong>, as it amplifies round-off errors through catastrophic cancellation.</p>
<hr />
<h3 id="comprehension-check">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. According to Chapter 5, why do we need numerical differentiation in physics?</strong></p>
<ul>
<li>A. Because all physical laws are simple polynomial functions.  </li>
<li>B. Because we often have data on a discrete grid and cannot use standard analytical calculus.  </li>
<li>C. To find the area under the curve for a discrete function.  </li>
<li>D. To solve root-finding problems for transcendental equations.</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(We have discrete data points, not continuous functions, so we must approximate derivatives using finite differences.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. Which of the following is defined as the second derivative of position, <span class="arithmatex">\(x(t)\)</span>?</strong></p>
<ul>
<li>A. Potential (<span class="arithmatex">\(V(t)\)</span>)  </li>
<li>B. Force (<span class="arithmatex">\(F(t)\)</span>)  </li>
<li>C. Velocity (<span class="arithmatex">\(v(t)\)</span>)  </li>
<li>D. Acceleration (<span class="arithmatex">\(a(t)\)</span>)</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: D</strong></p>
<p><em>(Acceleration is <span class="arithmatex">\(a(t) = \frac{d^2x}{dt^2}\)</span>, the second derivative of position with respect to time.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. The "great war" in numerical differentiation refers to the conflict between:</strong></p>
<ul>
<li>A. Forward and backward difference formulas.  </li>
<li>B. Truncation error and round-off error.  </li>
<li>C. First-order and second-order accuracy.  </li>
<li>D. Taylor series and finite element methods.</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(Truncation error decreases as <span class="arithmatex">\(h\)</span> shrinks, but round-off error increases, creating an optimal balance point.)</em></p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Give two distinct examples from physics of laws that are defined by a derivative, emphasizing the concept of "change" inherent in the operation. Explain why the computational approximation of these derivatives is critical for numerical physics.</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests understanding of how derivatives encode physical change and why numerical methods are essential.</p>
<ol>
<li>
<p><strong>Classical Mechanics — Force:</strong><br />
   The force <span class="arithmatex">\(F(x) = -\frac{dV}{dx}\)</span> is the derivative of the potential <span class="arithmatex">\(V\)</span> with respect to position <span class="arithmatex">\(x\)</span>. This defines force as the instantaneous <strong>rate of change</strong> of potential energy with distance. To compute forces on a discrete grid (e.g., in molecular dynamics), we must numerically differentiate the potential energy function.</p>
</li>
<li>
<p><strong>Electromagnetism — Electric Field:</strong><br />
   The electric field <span class="arithmatex">\(\mathbf{E} = -\nabla \phi\)</span> is the negative gradient (a multidimensional derivative) of the electric potential <span class="arithmatex">\(\phi\)</span>. This defines the electric field as the instantaneous <strong>rate of change</strong> of electric potential in space. In computational electromagnetics, we calculate field strengths by numerically differentiating potential distributions.</p>
</li>
<li>
<p><strong>Computational Importance:</strong><br />
   In both cases, analytical derivatives may be unavailable (e.g., when <span class="arithmatex">\(V\)</span> or <span class="arithmatex">\(\phi\)</span> come from experimental data or complex simulations). We must use finite-difference approximations on discrete grids, making numerical differentiation a foundational tool for translating physical laws into computational models.</p>
</li>
<li>
<p><strong>The Challenge:</strong><br />
   The accuracy of these physical predictions depends directly on how well we approximate these derivatives. Poor differentiation methods introduce errors that propagate through the simulation, potentially invalidating results.</p>
</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-electric-field-from-a-potential-grid"><strong>Project:</strong> Electric Field from a Potential Grid</h4>
<hr />
<h4 id="project-blueprint"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>To demonstrate numerical differentiation by computing the electric field <span class="arithmatex">\(E_x(x) = -\frac{d\phi}{dx}\)</span> from a discrete 1D electrostatic potential <span class="arithmatex">\(\phi(x)\)</span> using finite-difference methods.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>In electrostatics, the electric field is the negative gradient of the electric potential: <span class="arithmatex">\(\mathbf{E} = -\nabla \phi\)</span>. In 1D, this becomes <span class="arithmatex">\(E_x(x) = -\frac{d\phi}{dx}\)</span>. We will approximate this derivative using the central difference formula: <span class="arithmatex">\(\frac{d\phi}{dx} \approx \frac{\phi(x+h) - \phi(x-h)}{2h}\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Define a 1D potential function (e.g., <span class="arithmatex">\(\phi(x) = x^2\)</span> or a Gaussian potential) on a discrete grid with spacing <span class="arithmatex">\(h\)</span>. Use the central difference method to calculate the electric field at each interior grid point.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Create a discrete grid of <span class="arithmatex">\(x\)</span> values. <br>2. Compute <span class="arithmatex">\(\phi(x)\)</span> at each grid point. <br>3. Apply the central difference formula to calculate <span class="arithmatex">\(E_x(x) = -\frac{\phi(x+h) - \phi(x-h)}{2h}\)</span>. <br>4. Compare numerical results with the analytical derivative where available.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>For <span class="arithmatex">\(\phi(x) = x^2\)</span>, the analytical field is <span class="arithmatex">\(E_x(x) = -2x\)</span>. The numerical approximation should closely match this for moderate grid spacing.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>x_grid</code>: array of position values <br> - <code>phi</code>: potential values at each grid point <br> - <code>E_numerical</code>: numerically computed electric field <br> - <code>E_analytical</code>: exact electric field (for validation) <br> - <code>error</code>: difference between numerical and analytical results</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm that the central difference method accurately reproduces the electric field, and observe how accuracy improves as grid spacing <span class="arithmatex">\(h\)</span> decreases (up to the point where round-off errors dominate).</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Two-panel plot: (1) the potential <span class="arithmatex">\(\phi(x)\)</span> and (2) both the numerical and analytical electric fields <span class="arithmatex">\(E_x(x)\)</span> for visual comparison.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>BEGIN
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>  // 1. Setup grid and potential
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>  SET h = 0.1
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>  SET x_grid = linspace(-5.0, 5.0, 101)
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>  SET phi = x_grid^2  // Example: quadratic potential
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>  PRINT &quot;Grid spacing (h):&quot;, h
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>  PRINT &quot;Number of grid points:&quot;, length(x_grid)
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>  // 2. Compute electric field using central difference
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>  INITIALIZE E_numerical as empty array
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>  FOR i FROM 1 TO length(x_grid)-2 DO
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>      E_x = -(phi[i+1] - phi[i-1]) / (2 * h)
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>      APPEND E_x TO E_numerical
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>  END FOR
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>  // 3. Compute analytical field for comparison
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>  SET E_analytical = -2 * x_grid[1:-1]  // Derivative of x^2 is 2x, so E = -2x
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>  // 4. Calculate error
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>  SET error = ABS(E_numerical - E_analytical)
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>  SET max_error = MAX(error)
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>  PRINT &quot;Maximum error:&quot;, max_error
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>  // 5. Visualization
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>  CREATE figure with 2 subplots
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>  SUBPLOT 1:
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>      PLOT x_grid vs phi
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>      LABEL axes: &quot;Position x&quot; and &quot;Potential φ(x)&quot;
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>      ADD title: &quot;Electrostatic Potential&quot;
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>  SUBPLOT 2:
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>      PLOT x_grid[1:-1] vs E_numerical (line)
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>      PLOT x_grid[1:-1] vs E_analytical (dashed line)
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>      LABEL axes: &quot;Position x&quot; and &quot;Electric Field Ex(x)&quot;
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>      ADD legend: [&quot;Numerical&quot;, &quot;Analytical&quot;]
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>      ADD title: &quot;Electric Field (Negative Gradient of Potential)&quot;
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>  DISPLAY plot
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li>
<p><strong>Validation of Method:</strong><br />
  The numerical electric field should closely match the analytical result, demonstrating that finite differences can accurately approximate derivatives on discrete grids.</p>
</li>
<li>
<p><strong>Physical Insight:</strong><br />
  Regions where the potential has steep slopes (large <span class="arithmatex">\(|\frac{d\phi}{dx}|\)</span>) correspond to strong electric fields. Regions where the potential is flat have nearly zero field, confirming the physical relationship <span class="arithmatex">\(\mathbf{E} = -\nabla \phi\)</span>.</p>
</li>
<li>
<p><strong>Error Behavior:</strong><br />
  For moderate grid spacing, the central difference method (which is <span class="arithmatex">\(O(h^2)\)</span> accurate) produces very small errors. As <span class="arithmatex">\(h\)</span> decreases, truncation error decreases quadratically until round-off errors begin to dominate at very small <span class="arithmatex">\(h\)</span> values.</p>
</li>
<li>
<p><strong>Computational Lesson:</strong><br />
  This project demonstrates the practical application of numerical differentiation to a fundamental physics problem and introduces the concept of balancing grid resolution with numerical precision.</p>
</li>
</ul>
<div class="section-divider"></div>

<h2 class="heading-with-pill" id="52-the-taylor-series-foundation-of-finite-differences">5.2 The Taylor Series — Foundation of Finite Differences</h2>
<blockquote>
<p><strong>Concept:</strong> Analytic Expansion vs. Discrete Approximation • <strong>Difficulty:</strong> ★★★☆☆</p>
<p><strong>Summary:</strong> The Taylor series is the mathematical bridge between derivatives and algebraic approximations, providing the fundamental expansions used to derive all numerical differentiation formulas.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_1">Theoretical Background</h3>
<p>The <strong>Taylor series</strong> is the cornerstone of numerical differentiation. It is the mathematical bridge that allows us to translate between the continuous world of calculus (derivatives <span class="arithmatex">\(f'\)</span>, <span class="arithmatex">\(f''\)</span>, etc.) and the discrete world of computation (arithmetic operations on grid values).</p>
<p><strong>The Fundamental Idea</strong></p>
<p>The Taylor series makes a profound statement: if we know <em>everything</em> about a function at a single point <span class="arithmatex">\(x\)</span>—its value <span class="arithmatex">\(f(x)\)</span>, its slope <span class="arithmatex">\(f'(x)\)</span>, its curvature <span class="arithmatex">\(f''(x)\)</span>, and all higher derivatives—we can use this local information to predict the function's value at any nearby point <span class="arithmatex">\(x+h\)</span>.</p>
<p>The series expresses this as an infinite sum of terms, each involving a higher derivative and a higher power of the step size <span class="arithmatex">\(h\)</span>:</p>
<div class="arithmatex">\[
f(x+h) = f(x) + h f'(x) + \frac{h^2}{2!} f''(x) + \frac{h^3}{3!} f'''(x) + \frac{h^4}{4!} f^{(4)}(x) + \cdots
\]</div>
<p>Each additional term in this expansion provides a correction that accounts for the function's behavior at increasingly fine scales. The more terms we include, the more accurate our approximation becomes.</p>
<p><strong>The Key Insight for Numerical Differentiation</strong></p>
<p>Here's the crucial observation: we can <strong>rearrange</strong> the Taylor series to <strong>solve for the derivatives</strong> in terms of function values. This is the strategy behind all finite-difference formulas.</p>
<p>For example, if we truncate the series after the first derivative term and rearrange:</p>
<div class="arithmatex">\[
f'(x) \approx \frac{f(x+h) - f(x)}{h} - \frac{h}{2} f''(x) - \frac{h^2}{6} f'''(x) - \cdots
\]</div>
<p>If <span class="arithmatex">\(h\)</span> is small and we ignore the higher-order terms (treating them as "error"), we obtain a simple algebraic formula for the derivative using only function values.</p>
<p><strong>The Essential Expansions</strong></p>
<p>For this chapter, we need only two fundamental Taylor expansions, both centered at point <span class="arithmatex">\(x\)</span>:</p>
<ol>
<li><strong>Forward expansion</strong> (stepping forward by <span class="arithmatex">\(h\)</span>):</li>
</ol>
<div class="arithmatex">\[
f(x+h) = f(x) + h f'(x) + \frac{h^2}{2!} f''(x) + \frac{h^3}{3!} f'''(x) + \frac{h^4}{4!} f^{(4)}(x) + \cdots
\]</div>
<ol>
<li><strong>Backward expansion</strong> (stepping backward by <span class="arithmatex">\(h\)</span>):</li>
</ol>
<div class="arithmatex">\[
f(x-h) = f(x) - h f'(x) + \frac{h^2}{2!} f''(x) - \frac{h^3}{3!} f'''(x) + \frac{h^4}{4!} f^{(4)}(x) - \cdots
\]</div>
<p>Notice the alternating signs in the backward expansion. This sign pattern is crucial for deriving different finite-difference formulas.</p>
<p><strong>Algebraic Manipulation — The Core Strategy</strong></p>
<p>By <strong>adding, subtracting, and rearranging</strong> these two expansions, we can systematically eliminate unwanted terms and isolate the derivatives we want:</p>
<ul>
<li><strong>Subtracting</strong> the backward from the forward expansion eliminates all even-derivative terms, isolating <span class="arithmatex">\(f'(x)\)</span>.</li>
<li><strong>Adding</strong> the forward and backward expansions eliminates all odd-derivative terms, isolating <span class="arithmatex">\(f''(x)\)</span>.</li>
</ul>
<p>This algebraic manipulation transforms infinite series involving derivatives into finite formulas involving only function values <span class="arithmatex">\(f(x-h)\)</span>, <span class="arithmatex">\(f(x)\)</span>, and <span class="arithmatex">\(f(x+h)\)</span>—exactly the discrete data available on our computational grid.</p>
<hr />
<h3 id="comprehension-check_1">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the "engine" or "oracle" that the chapter uses to derive <em>all</em> the finite difference formulas?</strong></p>
<ul>
<li>A. The Method of Least Squares  </li>
<li>B. The Taylor Series expansion  </li>
<li>C. The Runge-Kutta algorithm  </li>
<li>D. The "Sweet Spot" V-plot</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(The Taylor series provides the analytical foundation for deriving all finite-difference approximations of derivatives.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. The Taylor series allows us to predict <span class="arithmatex">\(f(x+h)\)</span> based on information at <span class="arithmatex">\(f(x)\)</span> by using:</strong></p>
<ul>
<li>A. Integration and area under the curve.  </li>
<li>B. The function's values and its derivatives (<span class="arithmatex">\(f'\)</span>, <span class="arithmatex">\(f''\)</span>, ...) at <span class="arithmatex">\(x\)</span>.  </li>
<li>C. The Mean Value Theorem.  </li>
<li>D. The sign-change bracket.</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(The Taylor series expresses <span class="arithmatex">\(f(x+h)\)</span> as a sum involving <span class="arithmatex">\(f(x)\)</span> and all its derivatives at point <span class="arithmatex">\(x\)</span>.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. When deriving finite-difference formulas, what happens to the even-derivative terms (<span class="arithmatex">\(f''(x)\)</span>, <span class="arithmatex">\(f^{(4)}(x)\)</span>, etc.) when you subtract the backward Taylor expansion from the forward Taylor expansion?</strong></p>
<ul>
<li>A. They are amplified and become the dominant error.  </li>
<li>B. They cancel out completely due to equal coefficients with the same sign.  </li>
<li>C. They become twice as large.  </li>
<li>D. They are unchanged.</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(In the forward expansion, even derivatives have positive coefficients; in the backward expansion, they also have positive coefficients. When subtracting, these terms cancel, leaving only odd derivatives.)</em></p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> If you are using a Taylor series to approximate <span class="arithmatex">\(f(x+h)\)</span> and you only include terms up to the first derivative, <span class="arithmatex">\(f'(x)\)</span>, what type of geometrical approximation are you making for the function's behavior? What happens when you include the second-order term?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests understanding of the geometric interpretation of Taylor series truncation.</p>
<ol>
<li>
<p><strong>First-Order (Linear) Approximation:</strong><br />
   By stopping at the <span class="arithmatex">\(f'(x)\)</span> term, you are approximating:
   $<span class="arithmatex">\(f(x+h) \approx f(x) + h f'(x)\)</span>$
   This is a <strong>linear approximation</strong>—you are treating the function as a straight line (the tangent line) over the interval from <span class="arithmatex">\(x\)</span> to <span class="arithmatex">\(x+h\)</span>. You explicitly ignore the function's curvature and all higher-order shape characteristics.</p>
</li>
<li>
<p><strong>Geometric Interpretation:</strong><br />
   The tangent line has the correct value and slope at <span class="arithmatex">\(x\)</span>, but assumes the function continues in a straight line. For curved functions, this creates increasing error as you move farther from <span class="arithmatex">\(x\)</span>.</p>
</li>
<li>
<p><strong>Second-Order (Quadratic) Approximation:</strong><br />
   When you include the second derivative term:
   $<span class="arithmatex">\(f(x+h) \approx f(x) + h f'(x) + \frac{h^2}{2} f''(x)\)</span>$
   You are now approximating the function as a <strong>parabola</strong> (quadratic curve). This captures not just the value and slope, but also the <strong>curvature</strong> at <span class="arithmatex">\(x\)</span>.</p>
</li>
<li>
<p><strong>Impact on Accuracy:</strong><br />
   The quadratic approximation is far more accurate for most functions because it accounts for how the slope itself is changing. The error drops from <span class="arithmatex">\(O(h^2)\)</span> to <span class="arithmatex">\(O(h^3)\)</span>, a dramatic improvement for small <span class="arithmatex">\(h\)</span>.</p>
</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_1"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-verifying-taylor-series-convergence"><strong>Project:</strong> Verifying Taylor Series Convergence</h4>
<hr />
<h4 id="project-blueprint_1"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>To empirically verify that the Taylor series approximation becomes increasingly accurate as more terms are included, and to demonstrate the dramatic improvement from including the second-order (curvature) term.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>The Taylor series truncation error decreases rapidly with each additional term. For a well-behaved function, the <span class="arithmatex">\(n\)</span>-th order approximation has error <span class="arithmatex">\(O(h^{n+1})\)</span>, meaning each additional term reduces error by approximately a factor of <span class="arithmatex">\(h\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Use the exponential function <span class="arithmatex">\(f(x) = e^x\)</span> at <span class="arithmatex">\(x=1\)</span>, and approximate <span class="arithmatex">\(f(1+h)\)</span> for <span class="arithmatex">\(h=0.1\)</span> using successive Taylor series orders: <br>• Zero-order: <span class="arithmatex">\(f(1)\)</span> <br>• First-order: <span class="arithmatex">\(f(1) + h f'(1)\)</span> <br>• Second-order: <span class="arithmatex">\(f(1) + h f'(1) + \frac{h^2}{2} f''(1)\)</span> <br>• Compare with the exact value <span class="arithmatex">\(e^{1.1}\)</span></td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define <span class="arithmatex">\(x=1\)</span>, <span class="arithmatex">\(h=0.1\)</span>, and the exact value <span class="arithmatex">\(f(1+h) = e^{1.1}\)</span>. <br>2. Compute zero, first, and second-order Taylor approximations. <br>3. Calculate the absolute error for each approximation. <br>4. Observe how error decreases with each additional term. <br>5. Display results in a table.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>The error should decrease dramatically at each order: zero-order has <span class="arithmatex">\(O(h)\)</span> error, first-order has <span class="arithmatex">\(O(h^2)\)</span> error, and second-order has <span class="arithmatex">\(O(h^3)\)</span> error. For <span class="arithmatex">\(h=0.1\)</span>, each step should reduce error by roughly a factor of 10.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>x</code>, <code>h</code>: expansion point and step size <br> - <code>true_value</code>: exact <span class="arithmatex">\(e^{1.1}\)</span> <br> - <code>approx_0</code>, <code>approx_1</code>, <code>approx_2</code>: Taylor approximations of increasing order <br> - <code>error_0</code>, <code>error_1</code>, <code>error_2</code>: absolute errors at each order</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm that including the second-order term reduces error by approximately two orders of magnitude compared to the first-order approximation.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>A formatted table showing the order of approximation, computed value, absolute error, and relative error for each Taylor series truncation.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_1"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>BEGIN
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>  // 1. Setup
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  SET x = 1.0
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  SET h = 0.1
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>  SET x_eval = x + h
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>  // For f(x) = e^x, all derivatives equal e^x
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>  SET f_at_x = exp(x)
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>  SET f_prime_at_x = exp(x)
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>  SET f_double_prime_at_x = exp(x)
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>  SET true_value = exp(x_eval)
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>  PRINT &quot;Evaluating e^x at x =&quot;, x_eval
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>  PRINT &quot;Step size h =&quot;, h
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>  PRINT &quot;True value:&quot;, true_value
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>  PRINT &quot;------------------------------&quot;
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>  // 2. Zero-order approximation (constant)
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>  SET approx_0 = f_at_x
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>  SET error_0 = ABS(true_value - approx_0)
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>  SET rel_error_0 = error_0 / true_value
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>  // 3. First-order approximation (linear)
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>  SET approx_1 = f_at_x + h * f_prime_at_x
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>  SET error_1 = ABS(true_value - approx_1)
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>  SET rel_error_1 = error_1 / true_value
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>  // 4. Second-order approximation (quadratic)
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>  SET approx_2 = f_at_x + h * f_prime_at_x + (h^2 / 2) * f_double_prime_at_x
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>  SET error_2 = ABS(true_value - approx_2)
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>  SET rel_error_2 = error_2 / true_value
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>  // 5. Display results
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>  PRINT &quot;Order | Approximation | Absolute Error | Relative Error&quot;
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>  PRINT &quot;------|---------------|----------------|---------------&quot;
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>  PRINT &quot;0     |&quot;, approx_0, &quot;|&quot;, error_0, &quot;|&quot;, rel_error_0
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>  PRINT &quot;1     |&quot;, approx_1, &quot;|&quot;, error_1, &quot;|&quot;, rel_error_1
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>  PRINT &quot;2     |&quot;, approx_2, &quot;|&quot;, error_2, &quot;|&quot;, rel_error_2
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>  // 6. Analysis
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>  PRINT &quot;------------------------------&quot;
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>  PRINT &quot;Error reduction (0→1):&quot;, error_0 / error_1, &quot;×&quot;
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>  PRINT &quot;Error reduction (1→2):&quot;, error_1 / error_2, &quot;×&quot;
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_1"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li>
<p><strong>Zero-Order Approximation:</strong><br />
  Simply using <span class="arithmatex">\(f(1) \approx 2.718\)</span> to approximate <span class="arithmatex">\(e^{1.1} \approx 3.004\)</span> gives a large error (~0.286), as we completely ignore the function's change over the interval.</p>
</li>
<li>
<p><strong>First-Order Improvement:</strong><br />
  Including the linear term <span class="arithmatex">\(f(1) + 0.1 \cdot f'(1) \approx 2.990\)</span> reduces the error by roughly a factor of 10 to ~0.014. This captures the function's slope but not its curvature.</p>
</li>
<li>
<p><strong>Second-Order Improvement:</strong><br />
  Adding the quadratic term <span class="arithmatex">\(f(1) + 0.1 \cdot f'(1) + \frac{(0.1)^2}{2} \cdot f''(1) \approx 3.004\)</span> reduces the error by another factor of 10 to ~0.0005. This captures both slope and curvature.</p>
</li>
<li>
<p><strong>Key Insight:</strong><br />
  Each additional Taylor series term typically reduces error by a factor of <span class="arithmatex">\(h\)</span> (here, <span class="arithmatex">\(h=0.1\)</span>), demonstrating the power of higher-order approximations. This motivates using central differences (second-order accurate) over forward differences (first-order accurate) in numerical differentiation.</p>
</li>
</ul>
<p>The Taylor series is not just a theoretical tool—it's the foundation for designing numerical algorithms with controlled, predictable accuracy.</p>
<div class="section-divider"></div>

<h2 class="heading-with-pill" id="53-the-forward-difference-first-order-approximation">5.3 The Forward Difference — First-Order Approximation</h2>
<blockquote>
<p><strong>Concept:</strong> Single-Sided Slope Estimation • <strong>Difficulty:</strong> ★★☆☆☆</p>
<p><strong>Summary:</strong> The Forward Difference formula uses <span class="arithmatex">\(f(x)\)</span> and <span class="arithmatex">\(f(x+h)\)</span> to approximate <span class="arithmatex">\(f'(x)\)</span>. It is a first-order (<span class="arithmatex">\(O(h)\)</span>) accurate method because the <span class="arithmatex">\(O(h^2)\)</span> truncation error is divided by <span class="arithmatex">\(h\)</span>.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_2">Theoretical Background</h3>
<p>The Forward Difference is the most intuitive approach to approximating a derivative—it directly mimics the definition of the derivative but stops short of taking the limit.</p>
<p><strong>The Intuitive Concept</strong></p>
<p>In calculus, the derivative is defined as:</p>
<div class="arithmatex">\[
f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}
\]</div>
<p>The Forward Difference method simply <strong>freezes</strong> this limit at some finite value of <span class="arithmatex">\(h\)</span> and uses the resulting finite-difference quotient as the approximation:</p>
<div class="arithmatex">\[
f'(x) \approx \frac{f(x+h) - f(x)}{h}
\]</div>
<p>Geometrically, this computes the slope of the <strong>secant line</strong> connecting the point <span class="arithmatex">\((x, f(x))\)</span> to the point <span class="arithmatex">\((x+h, f(x+h))\)</span>. For small <span class="arithmatex">\(h\)</span>, this secant line approximates the tangent line (the true derivative).</p>
<p><strong>Derivation from Taylor Series</strong></p>
<p>To understand the accuracy of this approximation, we start with the forward Taylor expansion of <span class="arithmatex">\(f(x+h)\)</span> around point <span class="arithmatex">\(x\)</span>:</p>
<div class="arithmatex">\[
f(x+h) = f(x) + h f'(x) + \frac{h^2}{2!} f''(x) + \frac{h^3}{3!} f'''(x) + O(h^4)
\]</div>
<p>Rearranging to solve for <span class="arithmatex">\(f'(x)\)</span>:</p>
<div class="arithmatex">\[
f'(x) = \frac{f(x+h) - f(x)}{h} - \frac{h}{2} f''(x) - \frac{h^2}{6} f'''(x) - O(h^3)
\]</div>
<p>If we <strong>truncate</strong> (ignore) all terms of order <span class="arithmatex">\(h\)</span> and higher, we obtain the <strong>Forward Difference Formula</strong>:</p>
<div class="arithmatex">\[
f'(x) \approx \frac{f(x+h) - f(x)}{h}
\]</div>
<p><strong>Understanding the Error</strong></p>
<p>The truncated terms represent the <strong>truncation error</strong>:</p>
<div class="arithmatex">\[
\text{Truncation Error} = \frac{h}{2} f''(x) + \frac{h^2}{6} f'''(x) + O(h^3)
\]</div>
<p>For small <span class="arithmatex">\(h\)</span>, the dominant error term is <span class="arithmatex">\(\frac{h}{2} f''(x)\)</span>, which is proportional to <span class="arithmatex">\(h\)</span>. We express this as:</p>
<div class="arithmatex">\[
\text{Truncation Error} = O(h)
\]</div>
<p>This makes the Forward Difference a <strong>first-order accurate</strong> method.</p>
<p><strong>The Practical Consequence</strong></p>
<p>First-order accuracy has a critical computational implication:</p>
<ul>
<li>To reduce error by a factor of 10, you must reduce <span class="arithmatex">\(h\)</span> by a factor of 10, which means using <strong>10 times more grid points</strong>.</li>
<li>To achieve double precision accuracy (<span class="arithmatex">\(\sim 10^{-16}\)</span>), you would theoretically need grid spacing on the order of <span class="arithmatex">\(10^{-16}\)</span>, which is completely impractical and would be dominated by round-off errors.</li>
</ul>
<p>This inefficiency is why the Forward Difference, despite its simplicity, is rarely used in production numerical codes except at boundaries where centered methods cannot be applied.</p>
<hr />
<h3 id="comprehension-check_2">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the Forward Difference formula for the first derivative, <span class="arithmatex">\(f'(x)\)</span>?</strong></p>
<ul>
<li>A. <span class="arithmatex">\(\frac{f(x+h) - f(x-h)}{2h}\)</span>  </li>
<li>B. <span class="arithmatex">\(\frac{f(x+h) - f(x)}{h}\)</span>  </li>
<li>C. <span class="arithmatex">\(\frac{f(x) - f(x-h)}{h}\)</span>  </li>
<li>D. <span class="arithmatex">\(\frac{f(x+h) - 2f(x) + f(x-h)}{h^2}\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(The Forward Difference uses the function values at <span class="arithmatex">\(x\)</span> and one point forward at <span class="arithmatex">\(x+h\)</span> to estimate the slope.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. What is the order of the truncation error for the Forward Difference formula?</strong></p>
<ul>
<li>A. <span class="arithmatex">\(O(h)\)</span> (first-order accurate)  </li>
<li>B. <span class="arithmatex">\(O(h^2)\)</span> (second-order accurate)  </li>
<li>C. <span class="arithmatex">\(O(h^4)\)</span> (fourth-order accurate)  </li>
<li>D. <span class="arithmatex">\(O(\epsilon_m/h)\)</span> (round-off error)</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: A</strong></p>
<p><em>(The leading truncation error term is <span class="arithmatex">\(\frac{h}{2}f''(x)\)</span>, making the method first-order accurate in <span class="arithmatex">\(h\)</span>.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. If you halve the grid spacing <span class="arithmatex">\(h\)</span> in the Forward Difference method, by what factor does the truncation error decrease?</strong></p>
<ul>
<li>A. Factor of 2  </li>
<li>B. Factor of 4  </li>
<li>C. Factor of 8  </li>
<li>D. It increases</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: A</strong></p>
<p><em>(Since the method is <span class="arithmatex">\(O(h)\)</span> accurate, halving <span class="arithmatex">\(h\)</span> halves the error. This is less efficient than second-order methods where halving <span class="arithmatex">\(h\)</span> reduces error by a factor of 4.)</em></p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> If you are using the Forward Difference method and cut your grid spacing <span class="arithmatex">\(h\)</span> in half, by what factor do you expect your truncation error to decrease, and why? How does this compare to a hypothetical second-order method?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests understanding of convergence rates and computational efficiency.</p>
<ol>
<li>
<p><strong>First-Order Convergence:</strong><br />
   The truncation error will decrease by a factor of <strong>two</strong> (it will be cut in half). This is because the Forward Difference formula is <strong>first-order accurate</strong> (<span class="arithmatex">\(O(h)\)</span>).</p>
</li>
<li>
<p><strong>Mathematical Justification:</strong><br />
   The truncation error is dominated by the term <span class="arithmatex">\(\frac{h}{2} f''(x)\)</span>. If <span class="arithmatex">\(h \to h/2\)</span>, then:
   $<span class="arithmatex">\(\text{Error}_{\text{new}} = \frac{h/2}{2} f''(x) = \frac{1}{2} \cdot \frac{h}{2} f''(x) = \frac{1}{2} \text{Error}_{\text{old}}\)</span>$</p>
</li>
<li>
<p><strong>Comparison to Second-Order Methods:</strong><br />
   A second-order method (<span class="arithmatex">\(O(h^2)\)</span>) has error proportional to <span class="arithmatex">\(h^2\)</span>. Halving <span class="arithmatex">\(h\)</span> reduces error by a factor of <strong>four</strong>:
   $<span class="arithmatex">\(\text{Error}_{\text{new}} = \left(\frac{h}{2}\right)^2 = \frac{1}{4} h^2 = \frac{1}{4} \text{Error}_{\text{old}}\)</span>$</p>
</li>
<li>
<p><strong>Computational Efficiency:</strong><br />
   To achieve the same target accuracy:</p>
</li>
<li><strong>First-order:</strong> Requires <span class="arithmatex">\(N\)</span> grid points (where <span class="arithmatex">\(h \sim 1/N\)</span>)</li>
<li><strong>Second-order:</strong> Requires <span class="arithmatex">\(\sqrt{N}\)</span> grid points (where <span class="arithmatex">\(h^2 \sim 1/N\)</span>)</li>
</ol>
<p>The second-order method achieves the same accuracy with far fewer points, making it vastly more efficient.</p>
<ol>
<li><strong>Practical Implication:</strong><br />
   This is why the Central Difference (second-order) is the "workhorse" of numerical differentiation, while the Forward Difference is used primarily at boundaries where centered formulas cannot be applied.</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_2"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-convergence-analysis-of-forward-difference"><strong>Project:</strong> Convergence Analysis of Forward Difference</h4>
<hr />
<h4 id="project-blueprint_2"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>To empirically verify the <span class="arithmatex">\(O(h)\)</span> convergence rate of the Forward Difference method and prepare convergence data for comparison with higher-order methods.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>The Forward Difference truncation error is <span class="arithmatex">\(O(h)\)</span>, meaning error decreases linearly with grid spacing. On a log-log plot of error vs. <span class="arithmatex">\(h\)</span>, a first-order method produces a line with slope <span class="arithmatex">\(+1\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Test function: <span class="arithmatex">\(f(x) = \cos(x)\)</span> at <span class="arithmatex">\(x = 0.5\)</span>. The exact derivative is <span class="arithmatex">\(f'(0.5) = -\sin(0.5) \approx -0.479425538604203\)</span>. Compute the Forward Difference approximation for a wide range of <span class="arithmatex">\(h\)</span> values from <span class="arithmatex">\(10^{-1}\)</span> to <span class="arithmatex">\(10^{-10}\)</span> and measure the absolute error.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define the test function and its analytical derivative. <br>2. Create logarithmically spaced <span class="arithmatex">\(h\)</span> values. <br>3. For each <span class="arithmatex">\(h\)</span>, compute the Forward Difference approximation. <br>4. Calculate the absolute error compared to the exact derivative. <br>5. Store data for later visualization and analysis.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>For moderate <span class="arithmatex">\(h\)</span> values (<span class="arithmatex">\(10^{-2}\)</span> to <span class="arithmatex">\(10^{-6}\)</span>), error decreases linearly with <span class="arithmatex">\(h\)</span> (slope = 1 on log-log plot). For very small <span class="arithmatex">\(h\)</span> (below <span class="arithmatex">\(\sim 10^{-8}\)</span>), round-off errors dominate and the error increases, creating the characteristic "V-curve."</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>h_values</code>: array of step sizes <br> - <code>f_prime_exact</code>: analytical derivative value <br> - <code>f_prime_forward</code>: Forward Difference approximation <br> - <code>errors_forward</code>: absolute errors at each <span class="arithmatex">\(h\)</span> <br> - <code>optimal_h</code>: step size where total error is minimized</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm that in the truncation-dominated region, a log-log plot of error vs. <span class="arithmatex">\(h\)</span> has slope approximately <span class="arithmatex">\(+1\)</span>, validating the <span class="arithmatex">\(O(h)\)</span> convergence rate. Identify the optimal <span class="arithmatex">\(h\)</span> where truncation and round-off errors balance.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Store error data for later plotting. Print the range of <span class="arithmatex">\(h\)</span> values tested and the approximate optimal <span class="arithmatex">\(h\)</span> (typically around <span class="arithmatex">\(\sqrt{\epsilon_m} \approx 10^{-8}\)</span> for double precision).</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_2"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>BEGIN
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  // 1. Define test function and exact derivative
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>  DEFINE function f(x):
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>      RETURN cos(x)
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>  DEFINE function f_prime_exact(x):
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>      RETURN -sin(x)
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>  SET x_eval = 0.5
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>  SET true_derivative = f_prime_exact(x_eval)
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>  PRINT &quot;Test function: f(x) = cos(x)&quot;
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>  PRINT &quot;Evaluation point: x =&quot;, x_eval
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>  PRINT &quot;Exact derivative: f&#39;(&quot;, x_eval, &quot;) =&quot;, true_derivative
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>  PRINT &quot;------------------------------&quot;
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>  // 2. Generate range of step sizes
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>  SET h_values = logspace(-10, -1, 100)
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>  INITIALIZE empty array errors_forward
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>  // 3. Compute Forward Difference for each h
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>  FOR each h IN h_values DO
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>      // Forward Difference: [f(x+h) - f(x)] / h
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>      f_prime_approx = (f(x_eval + h) - f(x_eval)) / h
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>      absolute_error = ABS(f_prime_approx - true_derivative)
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>      APPEND absolute_error TO errors_forward
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>  END FOR
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>  // 4. Find optimal h (minimum error)
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>  SET min_error_index = INDEX_OF_MIN(errors_forward)
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>  SET optimal_h = h_values[min_error_index]
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>  SET min_error = errors_forward[min_error_index]
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>  PRINT &quot;Optimal step size h =&quot;, optimal_h
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>  PRINT &quot;Minimum error =&quot;, min_error
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>  PRINT &quot;Square root of machine epsilon =&quot;, sqrt(machine_epsilon)
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>  // 5. Store data for visualization
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>  SAVE h_values, errors_forward
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>  PRINT &quot;------------------------------&quot;
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>  PRINT &quot;Data prepared for log-log convergence plot&quot;
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>  PRINT &quot;Expected slope in truncation region: +1 (first-order)&quot;
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_2"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Truncation-Dominated Region (<span class="arithmatex">\(h &gt; 10^{-8}\)</span>):</strong><br />
  In this region, the error decreases linearly with <span class="arithmatex">\(h\)</span>. A log-log plot shows a straight line with slope <span class="arithmatex">\(+1\)</span>, confirming the <span class="arithmatex">\(O(h)\)</span> convergence rate. For example:</li>
<li>At <span class="arithmatex">\(h = 10^{-2}\)</span>: error <span class="arithmatex">\(\approx 10^{-4}\)</span></li>
<li>At <span class="arithmatex">\(h = 10^{-4}\)</span>: error <span class="arithmatex">\(\approx 10^{-6}\)</span></li>
<li>
<p>Error scales as <span class="arithmatex">\(\sim h^1\)</span></p>
</li>
<li>
<p><strong>Round-off-Dominated Region (<span class="arithmatex">\(h &lt; 10^{-8}\)</span>):</strong><br />
  When <span class="arithmatex">\(h\)</span> becomes very small, catastrophic cancellation between <span class="arithmatex">\(f(x+h)\)</span> and <span class="arithmatex">\(f(x)\)</span> amplifies round-off errors. The error increases as <span class="arithmatex">\(h\)</span> decreases, creating the upward slope of the "V-curve."</p>
</li>
<li>
<p><strong>Optimal Balance (<span class="arithmatex">\(h \approx \sqrt{\epsilon_m} \approx 10^{-8}\)</span>):</strong><br />
  The minimum total error occurs around <span class="arithmatex">\(h \approx 10^{-8}\)</span> for double precision. This is the optimal balance between truncation error (decreases with smaller <span class="arithmatex">\(h\)</span>) and round-off error (increases with smaller <span class="arithmatex">\(h\)</span>).</p>
</li>
<li>
<p><strong>Convergence Rate Validation:</strong><br />
  The slope of <span class="arithmatex">\(+1\)</span> on the log-log plot empirically confirms the theoretical prediction of <span class="arithmatex">\(O(h)\)</span> accuracy, distinguishing this first-order method from higher-order methods (which would show steeper slopes).</p>
</li>
<li>
<p><strong>Computational Insight:</strong><br />
  This experiment reveals the fundamental trade-off in numerical differentiation and explains why blindly reducing <span class="arithmatex">\(h\)</span> can be counterproductive. It sets the stage for comparing with the Central Difference method, which achieves <span class="arithmatex">\(O(h^2)\)</span> accuracy.</p>
</li>
</ul>
<div class="section-divider"></div>

<h2 class="heading-with-pill" id="54-the-central-difference-the-workhorse-method">5.4 The Central Difference — The Workhorse Method</h2>
<blockquote>
<p><strong>Concept:</strong> Symmetric Slope Estimation • <strong>Difficulty:</strong> ★★★☆☆</p>
<p><strong>Summary:</strong> The Central Difference formula is <span class="arithmatex">\(O(h^2)\)</span> accurate because subtracting the forward and backward Taylor expansions cancels the <span class="arithmatex">\(O(h^2)\)</span> term, making the error proportional to <span class="arithmatex">\(h^2\)</span>.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_3">Theoretical Background</h3>
<p>The <span class="arithmatex">\(O(h)\)</span> error of the Forward Difference is computationally inefficient. The <strong>Central Difference</strong> method achieves a dramatic improvement in accuracy through a simple but elegant shift in perspective.</p>
<p><strong>The Strategic Concept</strong></p>
<p>Instead of looking only forward from point <span class="arithmatex">\(x\)</span> to <span class="arithmatex">\(x+h\)</span>, the Central Difference method <strong>"centers"</strong> the measurement at <span class="arithmatex">\(x\)</span> by looking both backward to <span class="arithmatex">\(x-h\)</span> and forward to <span class="arithmatex">\(x+h\)</span>. The derivative is approximated by the slope of the secant line connecting these two symmetric outer points.</p>
<p>Geometrically, this produces a more balanced approximation because it averages information from both sides of the point, reducing bias and capturing the local symmetry of the function.</p>
<p><strong>The Mathematical "Magic" — Term Cancellation</strong></p>
<p>The derivation reveals why this method is so powerful. We start with both Taylor expansions:</p>
<p><strong>Forward expansion:</strong></p>
<div class="arithmatex">\[
f(x+h) = f(x) + h f'(x) + \frac{h^2}{2!} f''(x) + \frac{h^3}{3!} f'''(x) + \frac{h^4}{4!} f^{(4)}(x) + O(h^5)
\]</div>
<p><strong>Backward expansion:</strong></p>
<div class="arithmatex">\[
f(x-h) = f(x) - h f'(x) + \frac{h^2}{2!} f''(x) - \frac{h^3}{3!} f'''(x) + \frac{h^4}{4!} f^{(4)}(x) - O(h^5)
\]</div>
<p>Now, <strong>subtract</strong> the backward expansion from the forward expansion:</p>
<div class="arithmatex">\[
f(x+h) - f(x-h) = 2h f'(x) + \frac{2h^3}{3!} f'''(x) + O(h^5)
\]</div>
<p><strong>Notice the cancellation:</strong>
- The <span class="arithmatex">\(f(x)\)</span> terms cancel
- The <span class="arithmatex">\(f''(x)\)</span> terms cancel (both have <span class="arithmatex">\(+\)</span> signs)
- All even-derivative terms cancel
- Only odd-derivative terms remain</p>
<p>Rearranging for <span class="arithmatex">\(f'(x)\)</span>:</p>
<div class="arithmatex">\[
f'(x) = \frac{f(x+h) - f(x-h)}{2h} - \frac{h^2}{6} f'''(x) - O(h^4)
\]</div>
<p>Truncating the higher-order terms gives the <strong>Central Difference Formula</strong>:</p>
<div class="arithmatex">\[
f'(x) \approx \frac{f(x+h) - f(x-h)}{2h}
\]</div>
<p><strong>Understanding the Error</strong></p>
<p>The truncation error is:</p>
<div class="arithmatex">\[
\text{Truncation Error} = \frac{h^2}{6} f'''(x) + O(h^4)
\]</div>
<p>The dominant error term is proportional to <span class="arithmatex">\(h^2\)</span>, making this a <strong>second-order accurate</strong> method:</p>
<div class="arithmatex">\[
\text{Error} = O(h^2)
\]</div>
<p><strong>The Computational Advantage</strong></p>
<p>Second-order accuracy has profound implications:</p>
<ul>
<li><strong>Halving <span class="arithmatex">\(h\)</span> reduces error by a factor of 4</strong> (compared to factor of 2 for first-order)</li>
<li><strong>To achieve accuracy <span class="arithmatex">\(\epsilon\)</span>, you need <span class="arithmatex">\(h \sim \sqrt{\epsilon}\)</span> (compared to <span class="arithmatex">\(h \sim \epsilon\)</span> for first-order)</strong></li>
<li><strong>For the same target accuracy, second-order methods require far fewer grid points</strong></li>
</ul>
<p>For example, to achieve error <span class="arithmatex">\(\sim 10^{-6}\)</span>:
- <strong>Forward Difference (first-order):</strong> requires <span class="arithmatex">\(h \sim 10^{-6}\)</span> (1 million points per unit length)
- <strong>Central Difference (second-order):</strong> requires <span class="arithmatex">\(h \sim 10^{-3}\)</span> (1 thousand points per unit length)</p>
<p>This 1000× reduction in grid points makes second-order methods vastly more practical.</p>
<p><strong>The Practical Mantra</strong></p>
<p>Unless you are at a boundary where only forward or backward differences are available, <strong>always use the Central Difference method</strong>.</p>
<hr />
<h3 id="comprehension-check_3">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the Central Difference formula for the first derivative, <span class="arithmatex">\(f'(x)\)</span>?</strong></p>
<ul>
<li>A. <span class="arithmatex">\(\frac{f(x+h) - f(x-h)}{2h}\)</span>  </li>
<li>B. <span class="arithmatex">\(\frac{f(x+h) - f(x)}{h}\)</span>  </li>
<li>C. <span class="arithmatex">\(\frac{f(x) - f(x-h)}{h}\)</span>  </li>
<li>D. <span class="arithmatex">\(\frac{f(x+h) - 2f(x) + f(x-h)}{h^2}\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: A</strong></p>
<p><em>(The Central Difference uses symmetric points at <span class="arithmatex">\(x-h\)</span> and <span class="arithmatex">\(x+h\)</span>, divided by <span class="arithmatex">\(2h\)</span> for the slope.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. If you halve the step size <span class="arithmatex">\(h\)</span> when using the Central Difference formula, by what factor does the truncation error decrease?</strong></p>
<ul>
<li>A. Two  </li>
<li>B. Four  </li>
<li>C. Eight  </li>
<li>D. It remains the same</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(The Central Difference is <span class="arithmatex">\(O(h^2)\)</span> accurate. Halving <span class="arithmatex">\(h\)</span> means error scales as <span class="arithmatex">\((h/2)^2 = h^2/4\)</span>, a reduction by factor of 4.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. Which terms in the Taylor series cancel when you subtract the backward expansion from the forward expansion?</strong></p>
<ul>
<li>A. All odd-derivative terms (<span class="arithmatex">\(f'\)</span>, <span class="arithmatex">\(f'''\)</span>, <span class="arithmatex">\(f^{(5)}\)</span>, ...)  </li>
<li>B. All even-derivative terms (<span class="arithmatex">\(f\)</span>, <span class="arithmatex">\(f''\)</span>, <span class="arithmatex">\(f^{(4)}\)</span>, ...)  </li>
<li>C. Only the constant term <span class="arithmatex">\(f(x)\)</span>  </li>
<li>D. Only the first-derivative term <span class="arithmatex">\(f'(x)\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(Even-derivative terms have the same sign in both expansions, so they cancel when subtracted. Odd-derivative terms have opposite signs and add up.)</em></p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Walk through the logic of why the Central Difference formula is so much more accurate than the Forward Difference. Specifically, what mathematical property of the Taylor series causes the <span class="arithmatex">\(O(h^2)\)</span> error term to vanish?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests deep understanding of the Taylor series manipulation and error analysis.</p>
<ol>
<li>
<p><strong>The Key Insight — Symmetry:</strong><br />
   The Central Difference uses both the forward (<span class="arithmatex">\(x+h\)</span>) and backward (<span class="arithmatex">\(x-h\)</span>) Taylor series expansions. The backward expansion has the same form as the forward, but with alternating signs on odd-power terms.</p>
</li>
<li>
<p><strong>The Cancellation Mechanism:</strong><br />
   When we subtract <span class="arithmatex">\(f(x-h)\)</span> from <span class="arithmatex">\(f(x+h)\)</span>, we get:
   $<span class="arithmatex">\(f(x+h) - f(x-h) = 2hf'(x) + \frac{2h^3}{6}f'''(x) + O(h^5)\)</span>$</p>
</li>
</ol>
<p>The <span class="arithmatex">\(f(x)\)</span> terms cancel completely. The <span class="arithmatex">\(f''(x)\)</span> terms also cancel because:
   $<span class="arithmatex">\(+\frac{h^2}{2}f''(x) - (+\frac{h^2}{2}f''(x)) = 0\)</span>$</p>
<p>Both have positive signs in their respective expansions.</p>
<ol>
<li>
<p><strong>Why This Matters:</strong><br />
   In the Forward Difference, the leading error term is <span class="arithmatex">\(\frac{h}{2}f''(x)\)</span>, which is <span class="arithmatex">\(O(h)\)</span>.<br />
   In the Central Difference, this <span class="arithmatex">\(f''(x)\)</span> term is completely eliminated, and the leading error term becomes <span class="arithmatex">\(\frac{h^2}{6}f'''(x)\)</span>, which is <span class="arithmatex">\(O(h^2)\)</span>.</p>
</li>
<li>
<p><strong>The Computational Consequence:</strong><br />
   By eliminating the <span class="arithmatex">\(O(h^2)\)</span> term, we jump from first-order to second-order accuracy. This means that for the same grid resolution, the Central Difference is dramatically more accurate, or equivalently, we can use a coarser grid to achieve the same accuracy.</p>
</li>
<li>
<p><strong>General Principle:</strong><br />
   This demonstrates a fundamental strategy in numerical analysis: <strong>symmetric formulas often have superior accuracy</strong> because they exploit cancellation of even-order error terms. This principle extends to higher-order methods and multi-dimensional problems.</p>
</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_3"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-comparing-first-order-vs-second-order-convergence"><strong>Project:</strong> Comparing First-Order vs. Second-Order Convergence</h4>
<hr />
<h4 id="project-blueprint_3"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>To empirically demonstrate the superior convergence rate of the Central Difference method (<span class="arithmatex">\(O(h^2)\)</span>) compared to the Forward Difference method (<span class="arithmatex">\(O(h)\)</span>) by plotting both on the same log-log error vs. step size graph.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>On a log-log plot, the slope of the error curve reveals the convergence order: slope = 1 for <span class="arithmatex">\(O(h)\)</span>, slope = 2 for <span class="arithmatex">\(O(h^2)\)</span>. This visual comparison dramatically illustrates the advantage of second-order methods.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Test function: <span class="arithmatex">\(f(x) = \cos(x)\)</span> at <span class="arithmatex">\(x = 0.5\)</span>. Exact derivative: <span class="arithmatex">\(f'(0.5) = -\sin(0.5)\)</span>. Compute both Forward and Central Difference approximations for <span class="arithmatex">\(h\)</span> values ranging from <span class="arithmatex">\(10^{-1}\)</span> to <span class="arithmatex">\(10^{-12}\)</span>. Plot both error curves on the same axes.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define test function and exact derivative. <br>2. Generate logarithmic range of <span class="arithmatex">\(h\)</span> values. <br>3. For each <span class="arithmatex">\(h\)</span>, compute both Forward and Central Difference approximations. <br>4. Calculate absolute errors for both methods. <br>5. Create log-log plot with both error curves. <br>6. Annotate with reference slope lines.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>In the truncation-dominated region: <br>• Forward Difference: slope ≈ +1 <br>• Central Difference: slope ≈ +2 <br>Both curves show the characteristic "V" shape, but the Central Difference optimal <span class="arithmatex">\(h\)</span> is larger and achieves lower minimum error.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>h_values</code>: array of step sizes <br> - <code>errors_forward</code>: Forward Difference errors <br> - <code>errors_central</code>: Central Difference errors <br> - <code>optimal_h_forward</code>, <code>optimal_h_central</code>: optimal step sizes for each method <br> - <code>min_error_forward</code>, <code>min_error_central</code>: minimum achievable errors</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Visually confirm that the Central Difference line has approximately twice the slope of the Forward Difference line in the truncation-dominated region, validating the theoretical <span class="arithmatex">\(O(h)\)</span> vs. <span class="arithmatex">\(O(h^2)\)</span> predictions.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>A publication-quality log-log plot showing both error curves with: <br>• Different colors/markers for each method <br>• Reference lines showing slope = 1 and slope = 2 <br>• Vertical lines marking optimal <span class="arithmatex">\(h\)</span> for each method <br>• Legend and axis labels <br>• Annotation of the V-curve regions (truncation vs. round-off dominated)</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_3"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>BEGIN
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>  // 1. Define test function and exact derivative
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  DEFINE function f(x):
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>      RETURN cos(x)
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>  DEFINE function f_prime_exact(x):
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>      RETURN -sin(x)
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>  SET x_eval = 0.5
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>  SET true_derivative = f_prime_exact(x_eval)
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>  PRINT &quot;Convergence Comparison: Forward vs. Central Difference&quot;
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>  PRINT &quot;Test function: f(x) = cos(x) at x =&quot;, x_eval
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>  PRINT &quot;Exact derivative:&quot;, true_derivative
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>  PRINT &quot;========================================&quot;
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>  // 2. Generate range of step sizes
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>  SET h_values = logspace(-12, -1, 100)
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>  INITIALIZE empty arrays: errors_forward, errors_central
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>  // 3. Compute both methods for each h
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>  FOR each h IN h_values DO
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>      // Forward Difference
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>      f_prime_forward = (f(x_eval + h) - f(x_eval)) / h
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>      error_forward = ABS(f_prime_forward - true_derivative)
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>      APPEND error_forward TO errors_forward
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>      // Central Difference
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>      f_prime_central = (f(x_eval + h) - f(x_eval - h)) / (2 * h)
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>      error_central = ABS(f_prime_central - true_derivative)
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>      APPEND error_central TO errors_central
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>  END FOR
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>  // 4. Find optimal h for each method
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>  SET idx_forward = INDEX_OF_MIN(errors_forward)
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>  SET optimal_h_forward = h_values[idx_forward]
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a>  SET min_error_forward = errors_forward[idx_forward]
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>  SET idx_central = INDEX_OF_MIN(errors_central)
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a>  SET optimal_h_central = h_values[idx_central]
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a>  SET min_error_central = errors_central[idx_central]
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a>  PRINT &quot;Forward Difference:&quot;
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a>  PRINT &quot;  Optimal h =&quot;, optimal_h_forward
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a>  PRINT &quot;  Minimum error =&quot;, min_error_forward
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a>  PRINT &quot;&quot;
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a>  PRINT &quot;Central Difference:&quot;
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a>  PRINT &quot;  Optimal h =&quot;, optimal_h_central
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a>  PRINT &quot;  Minimum error =&quot;, min_error_central
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a>  PRINT &quot;========================================&quot;
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a>  // 5. Create log-log comparison plot
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a>  CREATE figure with size (10, 6)
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a>
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a>  PLOT loglog(h_values, errors_forward, &#39;o-&#39;, color=&#39;red&#39;, label=&#39;Forward (O(h))&#39;)
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a>  PLOT loglog(h_values, errors_central, &#39;s-&#39;, color=&#39;blue&#39;, label=&#39;Central (O(h²))&#39;)
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a>
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a>  // Add reference slope lines
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a>  SET h_ref = 1e-4
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a>  SET ref_slope_1 = h_ref * (h_values / h_ref)^1  // Slope = 1
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a>  SET ref_slope_2 = h_ref * (h_values / h_ref)^2  // Slope = 2
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a>
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a>  PLOT loglog(h_values, ref_slope_1, &#39;--&#39;, color=&#39;gray&#39;, label=&#39;Slope = 1 (reference)&#39;)
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a>  PLOT loglog(h_values, ref_slope_2, &#39;:&#39;, color=&#39;gray&#39;, label=&#39;Slope = 2 (reference)&#39;)
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a>
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a>  // Mark optimal h values
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a>  PLOT axvline(optimal_h_forward, color=&#39;red&#39;, linestyle=&#39;:&#39;, alpha=0.5)
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a>  PLOT axvline(optimal_h_central, color=&#39;blue&#39;, linestyle=&#39;:&#39;, alpha=0.5)
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a>
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a>  SET xlabel(&quot;Step Size h&quot;)
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a>  SET ylabel(&quot;Absolute Error&quot;)
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a>  SET title(&quot;Convergence Comparison: Forward vs. Central Difference&quot;)
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a>  ADD grid
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a>  ADD legend
</span><span id="__span-3-76"><a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a>
</span><span id="__span-3-77"><a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a>  ANNOTATE &quot;Truncation-dominated&quot; at appropriate region
</span><span id="__span-3-78"><a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a>  ANNOTATE &quot;Round-off-dominated&quot; at appropriate region
</span><span id="__span-3-79"><a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a>
</span><span id="__span-3-80"><a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a>  DISPLAY plot
</span><span id="__span-3-81"><a id="__codelineno-3-81" name="__codelineno-3-81" href="#__codelineno-3-81"></a>
</span><span id="__span-3-82"><a id="__codelineno-3-82" name="__codelineno-3-82" href="#__codelineno-3-82"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_3"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Truncation-Dominated Region (Large <span class="arithmatex">\(h\)</span>):</strong>  </li>
<li><strong>Forward Difference:</strong> Error decreases with slope ≈ +1 on log-log plot, confirming <span class="arithmatex">\(O(h)\)</span> convergence</li>
<li><strong>Central Difference:</strong> Error decreases with slope ≈ +2 on log-log plot, confirming <span class="arithmatex">\(O(h^2)\)</span> convergence</li>
<li>
<p>The Central Difference line is systematically below the Forward Difference line, showing superior accuracy at every grid resolution</p>
</li>
<li>
<p><strong>Optimal Step Sizes:</strong>  </p>
</li>
<li><strong>Forward Difference:</strong> Optimal <span class="arithmatex">\(h \approx 10^{-8} \approx \sqrt{\epsilon_m}\)</span> with minimum error <span class="arithmatex">\(\sim 10^{-8}\)</span></li>
<li><strong>Central Difference:</strong> Optimal <span class="arithmatex">\(h \approx 10^{-5} \approx \epsilon_m^{1/3}\)</span> with minimum error <span class="arithmatex">\(\sim 10^{-11}\)</span></li>
<li>
<p>The Central Difference achieves <strong>1000× better accuracy</strong> and can use <strong>1000× larger step size</strong></p>
</li>
<li>
<p><strong>Round-off-Dominated Region (Very Small <span class="arithmatex">\(h\)</span>):</strong><br />
  Both methods eventually suffer from catastrophic cancellation, but the Central Difference degrades more slowly because it involves subtraction of <span class="arithmatex">\(f(x+h)\)</span> and <span class="arithmatex">\(f(x-h)\)</span> which are closer in magnitude to each other than <span class="arithmatex">\(f(x+h)\)</span> and <span class="arithmatex">\(f(x)\)</span>.</p>
</li>
<li>
<p><strong>The V-Curve Visualization:</strong><br />
  The characteristic "V" shape appears for both methods:</p>
</li>
<li>Left side (large <span class="arithmatex">\(h\)</span>): truncation error dominates, decreasing as <span class="arithmatex">\(h\)</span> shrinks</li>
<li>Bottom (optimal <span class="arithmatex">\(h\)</span>): balance point between truncation and round-off</li>
<li>
<p>Right side (tiny <span class="arithmatex">\(h\)</span>): round-off error dominates, increasing as <span class="arithmatex">\(h\)</span> shrinks</p>
</li>
<li>
<p><strong>Practical Implications:</strong><br />
  This experiment visually demonstrates why the Central Difference is the "workhorse" of numerical differentiation: it achieves far better accuracy with coarser grids, making it the default choice for computational physics applications.</p>
</li>
<li>
<p><strong>Higher-Order Insight:</strong><br />
  The pattern continues: fourth-order methods would show slope ≈ +4, sixth-order slope ≈ +6, etc. However, the complexity and round-off sensitivity increase with order, so second-order methods represent an optimal balance for most applications.</p>
</li>
</ul>
<div class="section-divider"></div>

<h2 class="heading-with-pill" id="55-the-second-derivative-computing-curvature">5.5 The Second Derivative — Computing Curvature</h2>
<blockquote>
<p><strong>Concept:</strong> Numerical Laplacian Operator • <strong>Difficulty:</strong> ★★★☆☆</p>
<p><strong>Summary:</strong> The 2<sup>nd</sup> Derivative Central Difference formula is derived by adding the forward and backward Taylor expansions, canceling the odd terms, and yielding the crucial <span class="arithmatex">\(O(h^2)\)</span> accurate <strong>1D Numerical Laplacian</strong>.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_4">Theoretical Background</h3>
<p>The <strong>second derivative</strong> (<span class="arithmatex">\(f''(x)\)</span>) measures how the rate of change itself is changing—the curvature of a function. In physics, second derivatives appear everywhere: acceleration is the second derivative of position, the Laplacian operator appears in the Schrödinger equation, heat equation, and wave equation. The ability to compute <span class="arithmatex">\(f''(x)\)</span> numerically is essential for solving the fundamental PDEs of physics.</p>
<p><strong>The Physical Significance</strong></p>
<p>Second derivatives encode critical physical information:</p>
<ul>
<li><strong>Mechanics:</strong> Acceleration is <span class="arithmatex">\(a(t) = \frac{d^2x}{dt^2}\)</span>, the second derivative of position</li>
<li><strong>Quantum Mechanics:</strong> The Schrödinger equation contains <span class="arithmatex">\(\frac{d^2\psi}{dx^2}\)</span>, governing wave function evolution</li>
<li><strong>Diffusion:</strong> The heat equation <span class="arithmatex">\(\frac{\partial T}{\partial t} = \alpha \frac{\partial^2 T}{\partial x^2}\)</span> describes temperature evolution</li>
<li><strong>Wave Propagation:</strong> The wave equation <span class="arithmatex">\(\frac{\partial^2 u}{\partial t^2} = c^2 \frac{\partial^2 u}{\partial x^2}\)</span> governs oscillations and vibrations</li>
</ul>
<p><strong>Derivation Using Taylor Series</strong></p>
<p>We employ the same Taylor series strategy, but with a different algebraic manipulation. This time, we <strong>add</strong> the forward and backward expansions instead of subtracting them.</p>
<p><strong>Forward expansion:</strong></p>
<div class="arithmatex">\[
f(x+h) = f(x) + h f'(x) + \frac{h^2}{2!} f''(x) + \frac{h^3}{3!} f'''(x) + \frac{h^4}{4!} f^{(4)}(x) + O(h^5)
\]</div>
<p><strong>Backward expansion:</strong></p>
<div class="arithmatex">\[
f(x-h) = f(x) - h f'(x) + \frac{h^2}{2!} f''(x) - \frac{h^3}{3!} f'''(x) + \frac{h^4}{4!} f^{(4)}(x) - O(h^5)
\]</div>
<p><strong>Adding these expansions:</strong></p>
<div class="arithmatex">\[
f(x+h) + f(x-h) = 2f(x) + h^2 f''(x) + \frac{h^4}{12} f^{(4)}(x) + O(h^6)
\]</div>
<p><strong>Notice the cancellation:</strong>
- The first-derivative terms cancel: <span class="arithmatex">\(+hf'(x) - hf'(x) = 0\)</span>
- The third-derivative terms cancel: <span class="arithmatex">\(+\frac{h^3}{6}f'''(x) - \frac{h^3}{6}f'''(x) = 0\)</span>
- All odd-derivative terms cancel
- Only even-derivative terms survive</p>
<p>Rearranging for <span class="arithmatex">\(f''(x)\)</span>:</p>
<div class="arithmatex">\[
f''(x) = \frac{f(x+h) + f(x-h) - 2f(x)}{h^2} - \frac{h^2}{12} f^{(4)}(x) - O(h^4)
\]</div>
<p>Truncating the higher-order terms gives the <strong>Central Difference Formula for the Second Derivative</strong>:</p>
<div class="arithmatex">\[
f''(x) \approx \frac{f(x+h) - 2f(x) + f(x-h)}{h^2}
\]</div>
<p><strong>Understanding the Error</strong></p>
<p>The truncation error is:</p>
<div class="arithmatex">\[
\text{Truncation Error} = \frac{h^2}{12} f^{(4)}(x) + O(h^4)
\]</div>
<p>The dominant error is <span class="arithmatex">\(O(h^2)\)</span>, making this a <strong>second-order accurate</strong> formula—the same order as the first derivative Central Difference.</p>
<p><strong>The Numerical "Stencil" Concept</strong></p>
<p>In computational physics, this formula is called a <strong>three-point stencil</strong> because it uses exactly three adjacent grid points:</p>
<div class="arithmatex">\[
f''(x) \approx \frac{1}{h^2}\begin{bmatrix} +1 &amp; -2 &amp; +1 \end{bmatrix} \begin{bmatrix} f(x-h) \\ f(x) \\ f(x+h) \end{bmatrix}
\]</div>
<p>The coefficients <span class="arithmatex">\([+1, -2, +1]\)</span> form the "pattern" or "stencil" that is applied at every interior grid point. This stencil is the discrete approximation of the <strong>Laplacian operator</strong> <span class="arithmatex">\(\nabla^2\)</span> in one dimension.</p>
<p><strong>Why It's Called the "Laplacian"</strong></p>
<p>In higher dimensions, the Laplacian operator is:</p>
<div class="arithmatex">\[
\nabla^2 f = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} + \frac{\partial^2 f}{\partial z^2}
\]</div>
<p>The one-dimensional case is simply <span class="arithmatex">\(\nabla^2 f = \frac{d^2f}{dx^2}\)</span>. Our stencil is the <strong>discrete numerical implementation</strong> of this fundamental differential operator, which appears in virtually every PDE in physics.</p>
<hr />
<h3 id="comprehension-check_4">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the Central Difference formula for the second derivative, <span class="arithmatex">\(f''(x)\)</span>?</strong></p>
<ul>
<li>A. <span class="arithmatex">\(\frac{f(x+h) - f(x-h)}{2h}\)</span>  </li>
<li>B. <span class="arithmatex">\(\frac{f(x+h) - 2f(x) + f(x-h)}{h^2}\)</span>  </li>
<li>C. <span class="arithmatex">\(\frac{f(x+h) - 2f(x) + f(x-h)}{2h}\)</span>  </li>
<li>D. <span class="arithmatex">\(\frac{f(x+h) + 2f(x) - f(x-h)}{h^2}\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(The second derivative stencil uses the pattern [+1, -2, +1] divided by <span class="arithmatex">\(h^2\)</span>, forming the numerical Laplacian.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. The formula <span class="arithmatex">\(\frac{f(x+h) - 2f(x) + f(x-h)}{h^2}\)</span> is the numerical equivalent of which fundamental operator, essential for solving the Schrödinger and heat equations?</strong></p>
<ul>
<li>A. The gradient operator <span class="arithmatex">\(\nabla\)</span>  </li>
<li>B. The divergence operator <span class="arithmatex">\(\nabla \cdot\)</span>  </li>
<li>C. The Laplacian operator <span class="arithmatex">\(\nabla^2\)</span>  </li>
<li>D. The curl operator <span class="arithmatex">\(\nabla \times\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p><em>(This stencil is the discrete approximation of the Laplacian <span class="arithmatex">\(\nabla^2\)</span>, which measures local curvature and appears in diffusion and wave equations.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. When deriving the second derivative formula, which terms from the Taylor series cancel when you add the forward and backward expansions?</strong></p>
<ul>
<li>A. All even-derivative terms (<span class="arithmatex">\(f''\)</span>, <span class="arithmatex">\(f^{(4)}\)</span>, ...)  </li>
<li>B. All odd-derivative terms (<span class="arithmatex">\(f'\)</span>, <span class="arithmatex">\(f'''\)</span>, <span class="arithmatex">\(f^{(5)}\)</span>, ...)  </li>
<li>C. Only the constant term <span class="arithmatex">\(f(x)\)</span>  </li>
<li>D. No terms cancel</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(When adding the expansions, odd-derivative terms have opposite signs and cancel: <span class="arithmatex">\(+hf'(x) - hf'(x) = 0\)</span>, etc.)</em></p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> In the context of solving a differential equation on a discrete grid, why is the second derivative formula <span class="arithmatex">\(\frac{f(x+h) - 2f(x) + f(x-h)}{h^2}\)</span> referred to as a "stencil"? How does this concept extend to multi-dimensional problems?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests understanding of computational grid operations and their extension to higher dimensions.</p>
<ol>
<li><strong>The Stencil Concept:</strong><br />
   A "stencil" is the geometric pattern of grid points and their associated weights used to compute a value at a central location. The second derivative formula is a <strong>three-point stencil</strong> because it requires exactly three specific, adjacent grid points:</li>
<li><span class="arithmatex">\(f(x-h)\)</span> with weight <span class="arithmatex">\(+1\)</span></li>
<li><span class="arithmatex">\(f(x)\)</span> with weight <span class="arithmatex">\(-2\)</span></li>
<li>
<p><span class="arithmatex">\(f(x+h)\)</span> with weight <span class="arithmatex">\(+1\)</span></p>
</li>
<li>
<p><strong>Computational Implementation:</strong><br />
   This algebraic pattern (the stencil) is applied repeatedly at every interior grid point, transforming the differential operator into a matrix operation:
   $<span class="arithmatex">\(f''(x_i) \approx \frac{f_{i+1} - 2f_i + f_{i-1}}{h^2}\)</span>$</p>
</li>
<li>
<p><strong>Physical Interpretation:</strong><br />
   The stencil measures how much the function at point <span class="arithmatex">\(x\)</span> deviates from the average of its neighbors. If <span class="arithmatex">\(f(x)\)</span> equals the average, the second derivative is zero (linear function). If <span class="arithmatex">\(f(x)\)</span> is below/above the average, the curvature is positive/negative.</p>
</li>
<li>
<p><strong>Extension to 2D (e.g., Heat Equation on a Plate):</strong><br />
   The Laplacian in 2D becomes:
   $<span class="arithmatex">\(\nabla^2 f = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2}\)</span>$</p>
</li>
</ol>
<p>The numerical stencil expands to a <strong>five-point stencil</strong> (plus-shaped pattern):
   <div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>      f(x, y+h)
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>          |
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>f(x-h, y) - f(x,y) - f(x+h, y)
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>          |
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>      f(x, y-h)
</span></code></pre></div>
   $<span class="arithmatex">\(\nabla^2 f \approx \frac{f(x+h,y) + f(x-h,y) + f(x,y+h) + f(x,y-h) - 4f(x,y)}{h^2}\)</span>$</p>
<ol>
<li>
<p><strong>Extension to 3D (e.g., Quantum Mechanics):</strong><br />
   The pattern extends to a <strong>seven-point stencil</strong> with neighbors along all three axes.</p>
</li>
<li>
<p><strong>Computational Importance:</strong><br />
   Understanding stencils is crucial because:</p>
</li>
<li>They reveal the <strong>locality</strong> of differential operators (only nearby points matter)</li>
<li>They determine the <strong>sparsity pattern</strong> of the resulting matrix equations</li>
<li>They guide implementation in parallel computing and GPU programming</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_4"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-verifying-second-order-convergence-of-the-laplacian"><strong>Project:</strong> Verifying Second-Order Convergence of the Laplacian</h4>
<hr />
<h4 id="project-blueprint_4"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>To empirically verify that the second derivative Central Difference formula converges with <span class="arithmatex">\(O(h^2)\)</span> accuracy by testing on a function with known analytical second derivative.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>The second derivative approximation error should scale as <span class="arithmatex">\(h^2\)</span>, producing a slope of +2 on a log-log plot of error vs. step size.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Test function: <span class="arithmatex">\(f(x) = x^4\)</span> at <span class="arithmatex">\(x = 1\)</span>. The exact second derivative is <span class="arithmatex">\(f''(1) = 12\)</span>. Compute the numerical second derivative using the three-point stencil for step sizes ranging from <span class="arithmatex">\(10^{-1}\)</span> to <span class="arithmatex">\(10^{-8}\)</span> and measure absolute error.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define <span class="arithmatex">\(f(x) = x^4\)</span> and its exact second derivative <span class="arithmatex">\(f''(x) = 12x^2\)</span>. <br>2. Generate logarithmic range of <span class="arithmatex">\(h\)</span> values. <br>3. For each <span class="arithmatex">\(h\)</span>, compute the numerical second derivative. <br>4. Calculate absolute error. <br>5. Plot error vs. <span class="arithmatex">\(h\)</span> on log-log scale.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>The error should decrease with slope ≈ +2 in the truncation-dominated region, confirming <span class="arithmatex">\(O(h^2)\)</span> accuracy. For very small <span class="arithmatex">\(h\)</span> (below <span class="arithmatex">\(\sim 10^{-5}\)</span>), round-off errors create the V-curve behavior.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>h_values</code>: step sizes <br> - <code>f_double_prime_exact</code>: true value (12) <br> - <code>f_double_prime_numerical</code>: stencil approximation <br> - <code>errors</code>: absolute errors <br> - <code>optimal_h</code>: step size with minimum error</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm slope ≈ +2 on log-log plot, validate the <span class="arithmatex">\(O(h^2)\)</span> theoretical prediction, and identify the optimal balance between truncation and round-off errors.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Log-log plot showing error vs. <span class="arithmatex">\(h\)</span> with reference line of slope +2, annotations for truncation/round-off regions, and printed optimal <span class="arithmatex">\(h\)</span> value (typically around <span class="arithmatex">\(10^{-5}\)</span> for second derivatives).</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_4"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>BEGIN
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>  // 1. Define test function and exact second derivative
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>  DEFINE function f(x):
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>      RETURN x^4
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>  DEFINE function f_double_prime_exact(x):
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>      RETURN 12 * x^2
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>  SET x_eval = 1.0
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>  SET true_second_derivative = f_double_prime_exact(x_eval)
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>  PRINT &quot;Test function: f(x) = x^4&quot;
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>  PRINT &quot;Evaluation point: x =&quot;, x_eval
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>  PRINT &quot;Exact second derivative: f&#39;&#39;(&quot;, x_eval, &quot;) =&quot;, true_second_derivative
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>  PRINT &quot;=========================================&quot;
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>  // 2. Generate range of step sizes
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>  SET h_values = logspace(-8, -1, 100)
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>  INITIALIZE empty array errors
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>  // 3. Compute second derivative for each h
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>  FOR each h IN h_values DO
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>      // Three-point stencil: [f(x+h) - 2f(x) + f(x-h)] / h^2
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>      numerator = f(x_eval + h) - 2 * f(x_eval) + f(x_eval - h)
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>      f_double_prime_approx = numerator / (h^2)
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>      absolute_error = ABS(f_double_prime_approx - true_second_derivative)
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>      APPEND absolute_error TO errors
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>  END FOR
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>  // 4. Find optimal h
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>  SET min_error_index = INDEX_OF_MIN(errors)
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>  SET optimal_h = h_values[min_error_index]
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>  SET min_error = errors[min_error_index]
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>  PRINT &quot;Optimal step size: h =&quot;, optimal_h
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>  PRINT &quot;Minimum error =&quot;, min_error
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>  PRINT &quot;=========================================&quot;
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>  // 5. Create log-log plot
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a>  CREATE figure
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>  PLOT loglog(h_values, errors, &#39;o-&#39;, label=&#39;Second Derivative Error&#39;)
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>  // Add reference line with slope +2
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>  SET h_ref = 1e-3
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>  SET ref_line = (h_ref)^2 * (h_values / h_ref)^2
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>  PLOT loglog(h_values, ref_line, &#39;--&#39;, color=&#39;gray&#39;, label=&#39;O(h²) reference&#39;)
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a>
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a>  // Mark optimal h
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a>  PLOT axvline(optimal_h, linestyle=&#39;:&#39;, color=&#39;red&#39;, alpha=0.6, label=&#39;Optimal h&#39;)
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a>  SET xlabel(&quot;Step Size h&quot;)
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a>  SET ylabel(&quot;Absolute Error&quot;)
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a>  SET title(&quot;Convergence of Second Derivative Approximation&quot;)
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a>  ADD grid
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a>  ADD legend
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a>
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a>  DISPLAY plot
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a>
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_4"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Second-Order Convergence:</strong><br />
  The log-log plot shows a straight line with slope ≈ +2 in the truncation-dominated region, confirming the theoretical <span class="arithmatex">\(O(h^2)\)</span> accuracy. For example:</li>
<li>At <span class="arithmatex">\(h = 10^{-2}\)</span>: error <span class="arithmatex">\(\approx 10^{-4}\)</span></li>
<li>At <span class="arithmatex">\(h = 10^{-3}\)</span>: error <span class="arithmatex">\(\approx 10^{-6}\)</span></li>
<li>
<p>Halving <span class="arithmatex">\(h\)</span> reduces error by factor of 4</p>
</li>
<li>
<p><strong>Optimal Step Size:</strong><br />
  The minimum error occurs around <span class="arithmatex">\(h \approx 10^{-5}\)</span> to <span class="arithmatex">\(10^{-6}\)</span> for double precision, slightly different from the first derivative optimal <span class="arithmatex">\(h\)</span> because the stencil involves division by <span class="arithmatex">\(h^2\)</span> instead of <span class="arithmatex">\(h\)</span>, affecting the round-off amplification.</p>
</li>
<li>
<p><strong>Round-off Sensitivity:</strong><br />
  The second derivative is more sensitive to round-off errors than the first derivative because:</p>
</li>
<li>It involves two subtractions instead of one</li>
<li>Division by <span class="arithmatex">\(h^2\)</span> amplifies errors more than division by <span class="arithmatex">\(h\)</span></li>
<li>
<p>This shifts the optimal <span class="arithmatex">\(h\)</span> to slightly larger values</p>
</li>
<li>
<p><strong>Physical Applications:</strong><br />
  This stencil forms the foundation for solving PDEs in computational physics. In molecular dynamics, it computes forces from potentials. In quantum mechanics, it discretizes the kinetic energy operator. In diffusion problems, it models heat flow.</p>
</li>
<li>
<p><strong>Computational Insight:</strong><br />
  The three-point stencil <span class="arithmatex">\([+1, -2, +1]/h^2\)</span> is remarkably universal—the same pattern appears in solving Schrödinger's equation for electron orbitals, modeling heat diffusion in materials, and simulating wave propagation in media.</p>
</li>
</ul>
<div class="section-divider"></div>

<h2 class="heading-with-pill" id="56-the-war-between-errors-finding-the-sweet-spot">5.6 The War Between Errors — Finding the Sweet Spot</h2>
<blockquote>
<p><strong>Concept:</strong> Truncation vs. Round-off Trade-off • <strong>Difficulty:</strong> ★★★★☆</p>
<p><strong>Summary:</strong> The <strong>Total Error</strong> is the sum of <strong>Truncation Error</strong> (<span class="arithmatex">\(E_{\text{trunc}} \propto h^2\)</span>) and <strong>Round-off Error</strong> (<span class="arithmatex">\(E_{\text{round}} \propto \epsilon_m/h\)</span>). The optimal derivative is found at the <strong>"sweet spot"</strong> where these two errors are balanced, visualized as the bottom of the characteristic "V-plot."</p>
</blockquote>
<hr />
<h3 id="theoretical-background_5">Theoretical Background</h3>
<p>We have established that the Central Difference method is <span class="arithmatex">\(O(h^2)\)</span> accurate, which suggests that making <span class="arithmatex">\(h\)</span> as small as possible should minimize error. However, the laws of floating-point arithmetic from Chapter 2 reveal that this intuition is <strong>catastrophically wrong</strong>.</p>
<p><strong>The Competing Error Sources</strong></p>
<p>The Central Difference formula <span class="arithmatex">\(f'(x) \approx \frac{f(x+h) - f(x-h)}{2h}\)</span> is vulnerable to two fundamentally different types of error:</p>
<ol>
<li><strong>Truncation Error</strong> (<span class="arithmatex">\(E_{\text{trunc}}\)</span>): Arises from cutting off the Taylor series</li>
<li>Proportional to <span class="arithmatex">\(h^2\)</span>: <span class="arithmatex">\(E_{\text{trunc}} \sim C h^2\)</span></li>
<li>Decreases as <span class="arithmatex">\(h\)</span> gets smaller</li>
<li>
<p>Wants <span class="arithmatex">\(h \to 0\)</span></p>
</li>
<li>
<p><strong>Round-off Error</strong> (<span class="arithmatex">\(E_{\text{round}}\)</span>): Arises from finite precision arithmetic</p>
</li>
<li>Proportional to <span class="arithmatex">\(\epsilon_m/h\)</span>: <span class="arithmatex">\(E_{\text{round}} \sim D \frac{\epsilon_m}{h}\)</span></li>
<li>Increases as <span class="arithmatex">\(h\)</span> gets smaller (catastrophic cancellation)</li>
<li>Wants <span class="arithmatex">\(h\)</span> to be large</li>
</ol>
<p><strong>The Catastrophic Cancellation Problem</strong></p>
<p>When <span class="arithmatex">\(h\)</span> becomes very small:
- <span class="arithmatex">\(f(x+h)\)</span> and <span class="arithmatex">\(f(x-h)\)</span> become nearly identical
- Their subtraction loses significant digits (catastrophic cancellation from Chapter 2)
- The difference is dominated by the last few bits (noise)
- Dividing by small <span class="arithmatex">\(2h\)</span> amplifies this noise</p>
<p>For example, if <span class="arithmatex">\(f(x) = \sin(x)\)</span> and <span class="arithmatex">\(h = 10^{-15}\)</span>:
- <span class="arithmatex">\(f(x+h) \approx 0.841470984807896999...\)</span>
- <span class="arithmatex">\(f(x-h) \approx 0.841470984807897001...\)</span>
- The difference in the 15<sup>th</sup> decimal place is pure round-off noise
- Dividing by <span class="arithmatex">\(2h = 2 \times 10^{-15}\)</span> amplifies this noise by <span class="arithmatex">\(10^{15}\)</span>!</p>
<p><strong>The Total Error Model</strong></p>
<p>The total error is approximately:</p>
<div class="arithmatex">\[
E_{\text{total}}(h) \approx C h^2 + D \frac{\epsilon_m}{h}
\]</div>
<p>where:
- <span class="arithmatex">\(C\)</span> depends on the third derivative of <span class="arithmatex">\(f\)</span> (truncation error coefficient)
- <span class="arithmatex">\(D\)</span> depends on the function values (round-off error coefficient)
- <span class="arithmatex">\(\epsilon_m \approx 2.22 \times 10^{-16}\)</span> for double precision</p>
<p><strong>Finding the Optimal <span class="arithmatex">\(h\)</span></strong></p>
<p>To minimize total error, we take the derivative with respect to <span class="arithmatex">\(h\)</span> and set it to zero:</p>
<div class="arithmatex">\[
\frac{dE_{\text{total}}}{dh} = 2Ch - D\frac{\epsilon_m}{h^2} = 0
\]</div>
<p>Solving for <span class="arithmatex">\(h\)</span>:</p>
<div class="arithmatex">\[
h_{\text{optimal}} = \left(\frac{D \epsilon_m}{2C}\right)^{1/3} \sim \epsilon_m^{1/3}
\]</div>
<p>For double precision, <span class="arithmatex">\(\epsilon_m^{1/3} \approx (2.22 \times 10^{-16})^{1/3} \approx 6 \times 10^{-6}\)</span>.</p>
<p>This explains why the optimal <span class="arithmatex">\(h\)</span> is typically around <span class="arithmatex">\(10^{-5}\)</span> to <span class="arithmatex">\(10^{-6}\)</span>, not <span class="arithmatex">\(10^{-15}\)</span>!</p>
<p><strong>The V-Plot Visualization</strong></p>
<p>On a log-log plot of error vs. <span class="arithmatex">\(h\)</span>:</p>
<ul>
<li><strong>Right side (large <span class="arithmatex">\(h\)</span>):</strong> Dominated by truncation error</li>
<li>Error decreases with slope <span class="arithmatex">\(+2\)</span> as <span class="arithmatex">\(h\)</span> decreases</li>
<li>
<p>Line: <span class="arithmatex">\(E \propto h^2\)</span></p>
</li>
<li>
<p><strong>Left side (small <span class="arithmatex">\(h\)</span>):</strong> Dominated by round-off error</p>
</li>
<li>Error increases with slope <span class="arithmatex">\(-1\)</span> as <span class="arithmatex">\(h\)</span> decreases</li>
<li>
<p>Line: <span class="arithmatex">\(E \propto h^{-1}\)</span></p>
</li>
<li>
<p><strong>Bottom (sweet spot):</strong> Optimal balance</p>
</li>
<li>Minimum achievable error</li>
<li>Location: <span class="arithmatex">\(h \sim \epsilon_m^{1/3} \approx 10^{-5}\)</span></li>
<li>Minimum error: <span class="arithmatex">\(E_{\text{min}} \sim \epsilon_m^{2/3} \approx 10^{-11}\)</span></li>
</ul>
<p>The characteristic "V" shape gives the plot its name and provides immediate visual feedback about the error regimes.</p>
<p><strong>The Critical Lesson</strong></p>
<p>The mantra <strong>"smaller <span class="arithmatex">\(h\)</span> is always better"</strong> is fundamentally wrong in finite-precision arithmetic. The optimal strategy is to:</p>
<ol>
<li>Understand both error sources</li>
<li>Balance them at the sweet spot</li>
<li>Never use <span class="arithmatex">\(h\)</span> smaller than the optimal value</li>
<li>Recognize that there is a <strong>fundamental limit</strong> to achievable accuracy (<span class="arithmatex">\(\sim 10^{-11}\)</span> for first derivatives with double precision)</li>
</ol>
<hr />
<h3 id="comprehension-check_5">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the specific "Chapter 2 bug" that causes the error to explode when <span class="arithmatex">\(h\)</span> becomes too small in the Central Difference formula?</strong></p>
<ul>
<li>A. Integer overflow  </li>
<li>B. Runge's phenomenon  </li>
<li>C. Catastrophic cancellation (from subtracting two nearly-equal numbers)  </li>
<li>D. Truncation error</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p><em>(When <span class="arithmatex">\(h\)</span> is very small, <span class="arithmatex">\(f(x+h)\)</span> and <span class="arithmatex">\(f(x-h)\)</span> are nearly identical, and their subtraction loses significant digits through catastrophic cancellation, amplifying round-off errors.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. What is the "sweet spot" in numerical differentiation?</strong></p>
<ul>
<li>A. An <span class="arithmatex">\(h\)</span> value that is as close to <span class="arithmatex">\(\epsilon_m\)</span> as possible (e.g., <span class="arithmatex">\(h=10^{-16}\)</span>)  </li>
<li>B. The optimal <span class="arithmatex">\(h\)</span> (e.g., <span class="arithmatex">\(h \sim 10^{-6}\)</span>) that balances truncation and round-off error to give minimum total error  </li>
<li>C. The use of the Central Difference formula  </li>
<li>D. The point where the truncation error is exactly zero</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(The sweet spot is where <span class="arithmatex">\(E_{\text{trunc}} \approx E_{\text{round}}\)</span>, minimizing total error. This occurs around <span class="arithmatex">\(h \sim \epsilon_m^{1/3} \approx 10^{-5}\)</span> to <span class="arithmatex">\(10^{-6}\)</span> for double precision.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. On the V-plot, what is the approximate slope of the error curve in the round-off-dominated region (left side, very small <span class="arithmatex">\(h\)</span>)?</strong></p>
<ul>
<li>A. <span class="arithmatex">\(+2\)</span> (error increases with <span class="arithmatex">\(h^2\)</span>)  </li>
<li>B. <span class="arithmatex">\(-1\)</span> (error increases as <span class="arithmatex">\(h^{-1}\)</span>)  </li>
<li>C. <span class="arithmatex">\(0\)</span> (error is constant)  </li>
<li>D. <span class="arithmatex">\(+1\)</span> (error increases with <span class="arithmatex">\(h\)</span>)</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(Round-off error scales as <span class="arithmatex">\(\epsilon_m/h\)</span>, so as <span class="arithmatex">\(h\)</span> decreases, error increases proportionally to <span class="arithmatex">\(1/h\)</span>, giving slope <span class="arithmatex">\(-1\)</span> on log-log plot.)</em></p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> A colleague tells you, "To get the most accurate derivative, just set <span class="arithmatex">\(h\)</span> to be as small as possible, like <span class="arithmatex">\(10^{-15}\)</span>." Why is this terrible advice, and what is the physical meaning of the resulting error on the V-plot?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests understanding of the interplay between algorithmic and hardware limitations.</p>
<ol>
<li>
<p><strong>Why It's Terrible Advice:</strong><br />
   Setting <span class="arithmatex">\(h \approx 10^{-15}\)</span> puts the calculation on the <strong>left side</strong> of the V-plot, deep in the round-off-dominated region. At this point, truncation error is negligible, but round-off error has exploded to dominate the result.</p>
</li>
<li>
<p><strong>The Numerical Disaster:</strong><br />
   For <span class="arithmatex">\(h = 10^{-15}\)</span>:</p>
</li>
<li>The numerator <span class="arithmatex">\(f(x+h) - f(x-h)\)</span> involves subtracting two numbers that agree to ~15 decimal places</li>
<li>Only the last 1-2 digits differ, which are entirely round-off noise</li>
<li>The division by <span class="arithmatex">\(2h = 2 \times 10^{-15}\)</span> amplifies this noise by a factor of <span class="arithmatex">\(\sim 10^{15}\)</span></li>
<li>
<p>The final answer has effectively <strong>zero significant digits</strong></p>
</li>
<li>
<p><strong>Physical Meaning on V-Plot:</strong><br />
   On the left side of the V-plot, you're measuring the slope using two points that are so close together that the computer cannot distinguish their heights due to finite precision. It's like trying to measure the slope of a mountain by looking at two points 1 millimeter apart with a ruler that has 1-meter resolution.</p>
</li>
<li>
<p><strong>The Correct Approach:</strong><br />
   Find the sweet spot (bottom of the V) where:
   $<span class="arithmatex">\(2Ch^2 \approx D\frac{\epsilon_m}{h} \implies h_{\text{opt}} \sim \epsilon_m^{1/3} \approx 10^{-5}\)</span>$</p>
</li>
</ol>
<p>At this point, truncation and round-off errors are balanced, typically giving <span class="arithmatex">\(\sim 10^{-11}\)</span> accuracy—the best achievable for first derivatives in double precision.</p>
<ol>
<li>
<p><strong>Practical Implication:</strong><br />
   There is a <strong>fundamental limit</strong> to numerical differentiation accuracy imposed by hardware, not just by algorithm. No amount of algorithmic sophistication can overcome this limit without using higher precision (e.g., quad precision) or symbolic differentiation.</p>
</li>
<li>
<p><strong>The Broader Lesson:</strong><br />
   This illustrates a key principle in computational science: <strong>more resolution is not always better</strong>. Every numerical method has an optimal operating regime determined by the balance between competing error sources.</p>
</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_5"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-visualizing-the-v-plot-for-exponential-function"><strong>Project:</strong> Visualizing the V-Plot for Exponential Function</h4>
<hr />
<h4 id="project-blueprint_5"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>To empirically demonstrate the V-plot phenomenon by computing the Central Difference derivative over a wide range of step sizes, identifying the truncation-dominated and round-off-dominated regions, and locating the optimal sweet spot.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>Total error exhibits characteristic V-shape: decreases as <span class="arithmatex">\(h^2\)</span> (slope +2) in truncation region, increases as <span class="arithmatex">\(h^{-1}\)</span> (slope -1) in round-off region, with minimum at <span class="arithmatex">\(h_{\text{opt}} \sim \epsilon_m^{1/3}\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Test function: <span class="arithmatex">\(f(x) = e^x\)</span> at <span class="arithmatex">\(x = 1\)</span>. Exact derivative: <span class="arithmatex">\(f'(1) = e \approx 2.71828...\)</span>. Compute Central Difference for <span class="arithmatex">\(h\)</span> ranging from <span class="arithmatex">\(10^{-16}\)</span> to <span class="arithmatex">\(10^{-1}\)</span> (spanning both error regimes). Plot on log-log scale to reveal V-curve structure.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define <span class="arithmatex">\(f(x) = e^x\)</span> and exact derivative. <br>2. Generate logarithmic array of <span class="arithmatex">\(h\)</span> values covering wide range. <br>3. Compute Central Difference for each <span class="arithmatex">\(h\)</span>. <br>4. Calculate absolute error. <br>5. Create log-log plot. <br>6. Annotate regions and fit reference lines. <br>7. Identify and mark optimal <span class="arithmatex">\(h\)</span> and minimum error.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>Clear V-shaped curve with: <br>• Right side: slope ≈ +2 (truncation) <br>• Left side: slope ≈ -1 (round-off) <br>• Minimum at <span class="arithmatex">\(h \approx 10^{-5}\)</span> to <span class="arithmatex">\(10^{-6}\)</span> <br>• Minimum error <span class="arithmatex">\(\approx 10^{-11}\)</span> <br>• Explosive error growth for <span class="arithmatex">\(h &lt; 10^{-8}\)</span></td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>h_values</code>: array from <span class="arithmatex">\(10^{-16}\)</span> to <span class="arithmatex">\(10^{-1}\)</span> <br> - <code>errors</code>: absolute errors <br> - <code>h_optimal</code>: step size at minimum error <br> - <code>error_min</code>: minimum achievable error <br> - <code>slope_truncation</code>, <code>slope_roundoff</code>: fitted slopes for each region</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Visually confirm V-curve structure, verify theoretical predictions (<span class="arithmatex">\(h_{\text{opt}} \sim \epsilon_m^{1/3}\)</span>, slope transitions), and demonstrate the futility of using <span class="arithmatex">\(h &lt; h_{\text{opt}}\)</span>.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Publication-quality log-log plot with annotated regions, reference slope lines, optimal <span class="arithmatex">\(h\)</span> marker, and printed summary statistics comparing theoretical vs. empirical optimal values.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_5"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>BEGIN
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>  // 1. Define function and exact derivative
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>  DEFINE function f(x):
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>      RETURN exp(x)
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>  SET x_eval = 1.0
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>  SET true_derivative = exp(x_eval)
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>  SET machine_epsilon = 2.22e-16
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>  PRINT &quot;V-Plot Analysis: The War Between Errors&quot;
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>  PRINT &quot;Test function: f(x) = e^x at x =&quot;, x_eval
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>  PRINT &quot;Exact derivative:&quot;, true_derivative
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>  PRINT &quot;Machine epsilon:&quot;, machine_epsilon
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>  PRINT &quot;Theoretical h_optimal ≈ ε_m^(1/3) =&quot;, machine_epsilon^(1/3)
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>  PRINT &quot;=============================================&quot;
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>  // 2. Generate wide range of step sizes
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>  SET h_values = logspace(-16, -1, 200)
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>  INITIALIZE empty array errors
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>  // 3. Compute Central Difference for each h
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>  FOR each h IN h_values DO
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>      // Central Difference formula
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>      f_prime_approx = (f(x_eval + h) - f(x_eval - h)) / (2 * h)
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>      absolute_error = ABS(f_prime_approx - true_derivative)
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>      APPEND absolute_error TO errors
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>  END FOR
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>  // 4. Find optimal h and minimum error
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>  SET min_idx = INDEX_OF_MIN(errors)
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>  SET h_optimal = h_values[min_idx]
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>  SET error_min = errors[min_idx]
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>  PRINT &quot;Empirical Results:&quot;
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>  PRINT &quot;  Optimal h =&quot;, h_optimal
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>  PRINT &quot;  Minimum error =&quot;, error_min
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>  PRINT &quot;  Ratio h_opt / ε_m^(1/3) =&quot;, h_optimal / (machine_epsilon^(1/3))
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>  PRINT &quot;=============================================&quot;
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>  // 5. Create V-plot visualization
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>  CREATE figure with size (12, 7)
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>  // Main error curve
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>  PLOT loglog(h_values, errors, &#39;o-&#39;, color=&#39;blue&#39;, linewidth=2, 
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>              markersize=4, label=&#39;Total Error&#39;)
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>  // Reference lines for truncation error (slope +2)
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>  SET idx_trunc = FIND_INDEX where h_values &gt; h_optimal
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>  SET h_trunc_ref = h_values[idx_trunc][0]
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>  SET err_trunc_ref = errors[idx_trunc][0]
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>  SET trunc_line = err_trunc_ref * (h_values / h_trunc_ref)^2
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>  PLOT loglog(h_values, trunc_line, &#39;--&#39;, color=&#39;green&#39;, linewidth=1.5, 
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>              label=&#39;Truncation ∝ h² (slope +2)&#39;)
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>  // Reference line for round-off error (slope -1)
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a>  SET idx_round = FIND_INDEX where h_values &lt; h_optimal
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a>  SET h_round_ref = h_values[idx_round][-1]
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a>  SET err_round_ref = errors[idx_round][-1]
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a>  SET round_line = err_round_ref * (h_values / h_round_ref)^(-1)
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a>  PLOT loglog(h_values, round_line, &#39;--&#39;, color=&#39;red&#39;, linewidth=1.5, 
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a>              label=&#39;Round-off ∝ h⁻¹ (slope -1)&#39;)
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a>
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a>  // Mark optimal point
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a>  PLOT scatter(h_optimal, error_min, s=200, color=&#39;gold&#39;, marker=&#39;*&#39;, 
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a>               edgecolors=&#39;black&#39;, linewidth=2, zorder=5, 
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a>               label=&#39;Sweet Spot&#39;)
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a>
</span><span id="__span-6-70"><a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a>  // Vertical line at optimal h
</span><span id="__span-6-71"><a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a>  PLOT axvline(h_optimal, color=&#39;gold&#39;, linestyle=&#39;:&#39;, linewidth=2, alpha=0.7)
</span><span id="__span-6-72"><a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a>
</span><span id="__span-6-73"><a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a>  // Annotations
</span><span id="__span-6-74"><a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a>  ANNOTATE &quot;Truncation-Dominated Region\n(Algorithm Error)&quot; 
</span><span id="__span-6-75"><a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a>           at position (1e-2, 1e-3) with arrow pointing to right side
</span><span id="__span-6-76"><a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a>
</span><span id="__span-6-77"><a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a>  ANNOTATE &quot;Round-off-Dominated Region\n(Hardware Error)&quot; 
</span><span id="__span-6-78"><a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a>           at position (1e-14, 1e-2) with arrow pointing to left side
</span><span id="__span-6-79"><a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a>
</span><span id="__span-6-80"><a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a>  ANNOTATE &quot;Sweet Spot\nh ≈ ε_m^(1/3)&quot; 
</span><span id="__span-6-81"><a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a>           at position (h_optimal, error_min) with arrow
</span><span id="__span-6-82"><a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a>
</span><span id="__span-6-83"><a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a>  // Formatting
</span><span id="__span-6-84"><a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a>  SET xlabel(&quot;Step Size h&quot;, fontsize=14)
</span><span id="__span-6-85"><a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a>  SET ylabel(&quot;Absolute Error&quot;, fontsize=14)
</span><span id="__span-6-86"><a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a>  SET title(&quot;The V-Plot: Balancing Truncation and Round-off Errors&quot;, fontsize=16)
</span><span id="__span-6-87"><a id="__codelineno-6-87" name="__codelineno-6-87" href="#__codelineno-6-87"></a>  SET xlim(1e-16, 1e-1)
</span><span id="__span-6-88"><a id="__codelineno-6-88" name="__codelineno-6-88" href="#__codelineno-6-88"></a>  SET ylim(1e-16, 1e0)
</span><span id="__span-6-89"><a id="__codelineno-6-89" name="__codelineno-6-89" href="#__codelineno-6-89"></a>  ADD grid with alpha=0.3
</span><span id="__span-6-90"><a id="__codelineno-6-90" name="__codelineno-6-90" href="#__codelineno-6-90"></a>  ADD legend with fontsize=11, location=&#39;best&#39;
</span><span id="__span-6-91"><a id="__codelineno-6-91" name="__codelineno-6-91" href="#__codelineno-6-91"></a>
</span><span id="__span-6-92"><a id="__codelineno-6-92" name="__codelineno-6-92" href="#__codelineno-6-92"></a>  DISPLAY plot
</span><span id="__span-6-93"><a id="__codelineno-6-93" name="__codelineno-6-93" href="#__codelineno-6-93"></a>
</span><span id="__span-6-94"><a id="__codelineno-6-94" name="__codelineno-6-94" href="#__codelineno-6-94"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_5"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li>
<p><strong>The V-Curve Structure:</strong><br />
  The plot clearly shows the characteristic V-shape, with two distinct linear regions on the log-log scale meeting at the sweet spot.</p>
</li>
<li>
<p><strong>Truncation-Dominated Region (<span class="arithmatex">\(h &gt; 10^{-5}\)</span>):</strong>  </p>
</li>
<li>Slope ≈ +2 confirms <span class="arithmatex">\(O(h^2)\)</span> truncation error</li>
<li>Error: <span class="arithmatex">\(E \approx 10^{-10}\)</span> at <span class="arithmatex">\(h=10^{-5}\)</span> to <span class="arithmatex">\(E \approx 10^{-2}\)</span> at <span class="arithmatex">\(h=10^{-1}\)</span></li>
<li>
<p>Algorithm quality determines error magnitude</p>
</li>
<li>
<p><strong>Round-off-Dominated Region (<span class="arithmatex">\(h &lt; 10^{-5}\)</span>):</strong>  </p>
</li>
<li>Slope ≈ -1 confirms <span class="arithmatex">\(\epsilon_m/h\)</span> scaling</li>
<li>Error: <span class="arithmatex">\(E \approx 10^{-11}\)</span> at <span class="arithmatex">\(h=10^{-5}\)</span> to <span class="arithmatex">\(E \approx 10^{-1}\)</span> at <span class="arithmatex">\(h=10^{-16}\)</span></li>
<li>Hardware precision determines error magnitude</li>
<li>
<p>Catastrophic cancellation dominates</p>
</li>
<li>
<p><strong>The Sweet Spot:</strong>  </p>
</li>
<li>Empirical: <span class="arithmatex">\(h_{\text{opt}} \approx 6 \times 10^{-6}\)</span></li>
<li>Theoretical: <span class="arithmatex">\(\epsilon_m^{1/3} \approx 6 \times 10^{-6}\)</span></li>
<li>Excellent agreement validates theoretical model</li>
<li>
<p>Minimum error: <span class="arithmatex">\(\approx 3 \times 10^{-11} \approx \epsilon_m^{2/3}\)</span></p>
</li>
<li>
<p><strong>Practical Implications:</strong>  </p>
</li>
<li>Using <span class="arithmatex">\(h = 10^{-15}\)</span>: error <span class="arithmatex">\(\approx 10^{-1}\)</span> (only 1 decimal place correct!)</li>
<li>Using <span class="arithmatex">\(h = 10^{-6}\)</span>: error <span class="arithmatex">\(\approx 10^{-11}\)</span> (11 decimal places correct)</li>
<li>
<p>Factor of <span class="arithmatex">\(10^{10}\)</span> improvement by choosing correctly</p>
</li>
<li>
<p><strong>The Fundamental Limit:</strong><br />
  Even with perfect algorithm choice, finite precision imposes accuracy ceiling of <span class="arithmatex">\(\sim 10^{-11}\)</span> for first derivatives. To break this barrier requires:</p>
</li>
<li>Higher precision arithmetic (quad precision: <span class="arithmatex">\(\epsilon_m \sim 10^{-34}\)</span>)</li>
<li>Symbolic differentiation (exact, but limited applicability)</li>
<li>
<p>Automatic differentiation (exact to machine precision, but requires special implementation)</p>
</li>
<li>
<p><strong>Computational Wisdom:</strong><br />
  This experiment embodies a profound lesson: <strong>more is not always better in computational science</strong>. The optimal solution requires balancing competing constraints, not blindly maximizing resolution.</p>
</li>
</ul>
<div class="section-divider"></div>

<h2 class="heading-with-pill" id="57-application-force-from-lennard-jones-potential">5.7 Application — Force from Lennard-Jones Potential</h2>
<blockquote>
<p><strong>Concept:</strong> Real-World Derivative Calculation • <strong>Difficulty:</strong> ★★★☆☆</p>
<p><strong>Summary:</strong> The force <span class="arithmatex">\(F(r) = -dV/dr\)</span> for the Lennard-Jones potential is numerically calculated using the <span class="arithmatex">\(O(h^2)\)</span> Central Difference with optimal <span class="arithmatex">\(h\)</span> to achieve machine-level accuracy, verified against the known analytical solution.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_6">Theoretical Background</h3>
<p>The <strong>Lennard-Jones (LJ) potential</strong> is one of the most important and widely used models in molecular dynamics, computational chemistry, and materials science. It describes the interaction energy between two neutral atoms or molecules as a function of their separation distance <span class="arithmatex">\(r\)</span>.</p>
<p><strong>The Lennard-Jones Potential</strong></p>
<p>The potential energy is given by:</p>
<div class="arithmatex">\[
V_{\text{LJ}}(r) = 4\epsilon \left[ \left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6 \right]
\]</div>
<p>where:
- <span class="arithmatex">\(\epsilon\)</span> is the depth of the potential well (energy parameter)
- <span class="arithmatex">\(\sigma\)</span> is the finite distance at which the potential is zero (length parameter)
- <span class="arithmatex">\(r\)</span> is the distance between particle centers</p>
<p><strong>Physical Interpretation</strong></p>
<p>The two terms have distinct physical meanings:</p>
<ul>
<li><strong>Repulsive term</strong> (<span class="arithmatex">\(r^{-12}\)</span>): Models Pauli exclusion at short range</li>
<li>Dominates when <span class="arithmatex">\(r &lt; \sigma\)</span></li>
<li>Prevents atoms from overlapping</li>
<li>
<p>Steep, short-range repulsion</p>
</li>
<li>
<p><strong>Attractive term</strong> (<span class="arithmatex">\(r^{-6}\)</span>): Models van der Waals attraction at long range</p>
</li>
<li>Dominates when <span class="arithmatex">\(r &gt; \sigma\)</span></li>
<li>Dipole-dipole and London dispersion forces</li>
<li>Weaker, longer-range attraction</li>
</ul>
<p>The potential has a minimum at <span class="arithmatex">\(r_{\text{min}} = 2^{1/6}\sigma \approx 1.122\sigma\)</span>, representing the equilibrium separation.</p>
<p><strong>From Potential to Force</strong></p>
<p>In classical mechanics, the force is the negative gradient of potential energy:</p>
<div class="arithmatex">\[
F(r) = -\frac{dV}{dr}
\]</div>
<p>For the LJ potential, we can derive this analytically:</p>
<div class="arithmatex">\[
F_{\text{LJ}}(r) = -\frac{d}{dr}\left[4\epsilon \left( \frac{\sigma^{12}}{r^{12}} - \frac{\sigma^6}{r^6} \right)\right]
\]</div>
<div class="arithmatex">\[
F_{\text{LJ}}(r) = 4\epsilon \left[ -12\frac{\sigma^{12}}{r^{13}} + 6\frac{\sigma^6}{r^7} \right]
\]</div>
<div class="arithmatex">\[
F_{\text{LJ}}(r) = \frac{24\epsilon}{r} \left[ 2\left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6 \right]
\]</div>
<p><strong>The Computational Challenge</strong></p>
<p>In many practical scenarios, we don't have an analytical expression for the potential—it might come from quantum mechanical calculations, experimental data, or complex empirical models. We need to compute forces numerically from potential energy surfaces.</p>
<p>This problem provides a perfect <strong>"ground truth" test case</strong>:
1. We have the analytical derivative (for verification)
2. We can test our numerical methods against exact results
3. We can measure accuracy down to machine precision
4. The function has realistic features (steep repulsion, long-range attraction)</p>
<p><strong>The Computational Strategy</strong></p>
<ol>
<li>
<p><strong>Tool Selection:</strong> Use the <span class="arithmatex">\(O(h^2)\)</span> Central Difference formula:
   $<span class="arithmatex">\(F_{\text{numeric}}(r) = -\frac{V(r+h) - V(r-h)}{2h}\)</span>$</p>
</li>
<li>
<p><strong>Optimal <span class="arithmatex">\(h\)</span> Choice:</strong> Based on V-plot analysis (Section 5.6), choose <span class="arithmatex">\(h \approx 10^{-6}\)</span> to <span class="arithmatex">\(10^{-5}\)</span> to balance truncation and round-off errors</p>
</li>
<li>
<p><strong>Calculation:</strong> Apply the formula at a range of <span class="arithmatex">\(r\)</span> values spanning the interesting physics (repulsive wall, equilibrium, attractive tail)</p>
</li>
<li>
<p><strong>Verification:</strong> Compare <span class="arithmatex">\(F_{\text{numeric}}(r)\)</span> with <span class="arithmatex">\(F_{\text{analytic}}(r)\)</span> to validate accuracy</p>
</li>
<li>
<p><strong>Analysis:</strong> Plot the error to confirm it reaches machine precision limits (<span class="arithmatex">\(\sim 10^{-14}\)</span> to <span class="arithmatex">\(10^{-15}\)</span>)</p>
</li>
</ol>
<hr />
<h3 id="comprehension-check_6">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. In this application, how did we calculate the force <span class="arithmatex">\(F(r)\)</span> from the Lennard-Jones potential <span class="arithmatex">\(V(r)\)</span>?</strong></p>
<ul>
<li>A. By finding the root of <span class="arithmatex">\(V(r)\)</span> using the Bisection method  </li>
<li>B. By finding the second derivative <span class="arithmatex">\(F = d^2V/dr^2\)</span>  </li>
<li>C. By applying the Central Difference formula to compute <span class="arithmatex">\(F = -dV/dr\)</span>  </li>
<li>D. By integrating <span class="arithmatex">\(V(r)\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p><em>(The force is the negative gradient of potential, <span class="arithmatex">\(F = -dV/dr\)</span>, computed numerically using the Central Difference method.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. What was the purpose of calculating the analytical force <span class="arithmatex">\(F_{\text{analytic}}(r)\)</span> in this application?</strong></p>
<ul>
<li>A. To provide the final answer that the simulation would use  </li>
<li>B. To serve as the "ground truth" against which the accuracy of the numerical method was verified  </li>
<li>C. To help select the optimal step size <span class="arithmatex">\(h\)</span>  </li>
<li>D. To check for boundary conditions</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(Having the exact analytical answer allows us to measure the numerical method's error and verify it achieves machine precision accuracy.)</em></p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. The Lennard-Jones potential has a repulsive <span class="arithmatex">\(r^{-12}\)</span> term and an attractive <span class="arithmatex">\(r^{-6}\)</span> term. At what distance does the force equal zero (equilibrium)?</strong></p>
<ul>
<li>A. <span class="arithmatex">\(r = \sigma\)</span>  </li>
<li>B. <span class="arithmatex">\(r = 2^{1/6}\sigma \approx 1.122\sigma\)</span>  </li>
<li>C. <span class="arithmatex">\(r = 0\)</span>  </li>
<li>D. <span class="arithmatex">\(r = \infty\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p><em>(At equilibrium, <span class="arithmatex">\(F=0\)</span> occurs where <span class="arithmatex">\(V(r)\)</span> has its minimum, which is at <span class="arithmatex">\(r_{\text{min}} = 2^{1/6}\sigma\)</span>.)</em></p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> In the Lennard-Jones problem, you calculated the force numerically and analytically. You plot the absolute error and find it is <span class="arithmatex">\(\sim 10^{-14}\)</span>. Is this result a failure or a success for the numerical method, and why?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests understanding of practical accuracy limits and error interpretation.</p>
<ol>
<li>
<p><strong>This is a Success:</strong><br />
   An absolute error of <span class="arithmatex">\(10^{-14}\)</span> to <span class="arithmatex">\(10^{-15}\)</span> represents achieving the <strong>limit of machine precision</strong> for double-precision arithmetic (which has about 15-16 significant decimal digits).</p>
</li>
<li>
<p><strong>Why This is the Best Possible:</strong>  </p>
</li>
<li>Machine epsilon: <span class="arithmatex">\(\epsilon_m \approx 2.22 \times 10^{-16}\)</span></li>
<li>Relative error: <span class="arithmatex">\(10^{-14} / 2.7 \approx 4 \times 10^{-15}\)</span></li>
<li>This means we've captured all but the last 1-2 bits of precision</li>
<li>
<p>No numerical method using standard double precision can do better</p>
</li>
<li>
<p><strong>What It Confirms:</strong>  </p>
</li>
<li>The Central Difference formula is working correctly</li>
<li>The optimal <span class="arithmatex">\(h\)</span> was chosen properly (around <span class="arithmatex">\(10^{-6}\)</span>)</li>
<li>The implementation has no bugs</li>
<li>
<p>Truncation error has been minimized to the point where only unavoidable round-off remains</p>
</li>
<li>
<p><strong>The Remaining Error Source:</strong><br />
   The <span class="arithmatex">\(\sim 10^{-14}\)</span> error is <strong>not</strong> from the algorithm—it's from the fundamental limitation of storing real numbers in 64 bits. This is irreducible hardware error.</p>
</li>
<li>
<p><strong>How to Improve (if needed):</strong><br />
   To achieve better accuracy would require:</p>
</li>
<li>Quad precision (128-bit floats): <span class="arithmatex">\(\epsilon_m \sim 10^{-34}\)</span></li>
<li>Symbolic differentiation: exact analytical formula</li>
<li>Automatic differentiation: machine precision for complex functions</li>
</ol>
<p>But for molecular dynamics simulations, <span class="arithmatex">\(10^{-14}\)</span> relative error in forces is vastly better than needed.</p>
<ol>
<li><strong>Practical Perspective:</strong><br />
   Physical measurements rarely exceed 6-8 significant digits. Achieving 14-15 digits numerically is extraordinary and demonstrates the power of well-designed numerical methods.</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_6"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-computing-force-from-morse-potential"><strong>Project:</strong> Computing Force from Morse Potential</h4>
<hr />
<h4 id="project-blueprint_6"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>To compute the interatomic force from the Morse potential energy function using numerical differentiation, verify against analytical results, and identify the equilibrium bond length where force equals zero.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>The Morse potential <span class="arithmatex">\(V(r) = D_e(1 - e^{-a(r-r_e)})^2\)</span> is a more realistic model for molecular bonds than the harmonic oscillator. The force is <span class="arithmatex">\(F(r) = -dV/dr\)</span>, and equilibrium occurs at <span class="arithmatex">\(F(r) = 0\)</span> which should coincide with the minimum of <span class="arithmatex">\(V(r)\)</span> at <span class="arithmatex">\(r = r_e\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Use realistic parameters: <span class="arithmatex">\(D_e = 1.0\)</span> eV (dissociation energy), <span class="arithmatex">\(a = 1.5\)</span> Å<span class="arithmatex">\(^{-1}\)</span> (width parameter), <span class="arithmatex">\(r_e = 1.5\)</span> Å (equilibrium bond length). Compute both potential and force over range <span class="arithmatex">\(r \in [1.0, 4.0]\)</span> Å using Central Difference with optimal <span class="arithmatex">\(h\)</span>.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define Morse potential function and analytical force. <br>2. Choose optimal <span class="arithmatex">\(h \approx 10^{-6}\)</span>. <br>3. Compute numerical force using Central Difference. <br>4. Create dual-axis plot showing <span class="arithmatex">\(V(r)\)</span> and <span class="arithmatex">\(F(r)\)</span>. <br>5. Find zero-crossing of force numerically. <br>6. Verify it matches <span class="arithmatex">\(V(r)\)</span> minimum at <span class="arithmatex">\(r_e\)</span>.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>Force curve crosses zero at <span class="arithmatex">\(r = r_e = 1.5\)</span> Å, coinciding with minimum of potential curve. Numerical and analytical forces should be visually indistinguishable with error <span class="arithmatex">\(\sim 10^{-14}\)</span>.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>r_values</code>: separation distances <br> - <code>V_morse</code>: potential energies <br> - <code>F_numerical</code>: numerically computed forces <br> - <code>F_analytical</code>: exact forces <br> - <code>r_equilibrium</code>: zero-force position <br> - <code>error</code>: difference between numerical and analytical forces</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm that: (1) numerical force matches analytical force to machine precision, (2) force zero-crossing occurs at potential minimum, (3) method works for realistic molecular potential with exponential terms.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Dual-axis plot showing potential (left axis) and force (right axis) vs. distance, with equilibrium position marked. Error plot showing <span class="arithmatex">\(\sim 10^{-14}\)</span> accuracy. Printed equilibrium position from force zero-crossing.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_6"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>BEGIN
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>  // 1. Define Morse potential and parameters
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>  DEFINE function morse_potential(r, D_e, a, r_e):
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>      RETURN D_e * (1 - exp(-a * (r - r_e)))^2
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>  DEFINE function morse_force_analytical(r, D_e, a, r_e):
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>      // F = -dV/dr for Morse potential
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>      exp_term = exp(-a * (r - r_e))
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>      RETURN -2 * D_e * a * (1 - exp_term) * exp_term
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>  // Parameters (typical for diatomic molecule)
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>  SET D_e = 1.0    // eV (dissociation energy)
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>  SET a = 1.5      // Å^-1 (width parameter)
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>  SET r_e = 1.5    // Å (equilibrium bond length)
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>  SET h_optimal = 1.0e-6
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>  PRINT &quot;Morse Potential Parameters:&quot;
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>  PRINT &quot;  Dissociation energy D_e =&quot;, D_e, &quot;eV&quot;
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>  PRINT &quot;  Width parameter a =&quot;, a, &quot;Å^-1&quot;
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>  PRINT &quot;  Equilibrium distance r_e =&quot;, r_e, &quot;Å&quot;
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>  PRINT &quot;  Numerical step size h =&quot;, h_optimal
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>  PRINT &quot;==========================================&quot;
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>  // 2. Generate distance array
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>  SET r_values = linspace(1.0, 4.0, 300)
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>  INITIALIZE arrays: V_morse, F_numerical, F_analytical, errors
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>  // 3. Compute potential, forces, and errors
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>  FOR each r IN r_values DO
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>      // Potential energy
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>      V = morse_potential(r, D_e, a, r_e)
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>      APPEND V TO V_morse
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>      // Numerical force: -dV/dr using Central Difference
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>      V_plus = morse_potential(r + h_optimal, D_e, a, r_e)
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>      V_minus = morse_potential(r - h_optimal, D_e, a, r_e)
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a>      F_num = -(V_plus - V_minus) / (2 * h_optimal)
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>      APPEND F_num TO F_numerical
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a>      // Analytical force
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>      F_ana = morse_force_analytical(r, D_e, a, r_e)
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>      APPEND F_ana TO F_analytical
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>
</span><span id="__span-7-46"><a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>      // Error
</span><span id="__span-7-47"><a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>      error = ABS(F_num - F_ana)
</span><span id="__span-7-48"><a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>      APPEND error TO errors
</span><span id="__span-7-49"><a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>  END FOR
</span><span id="__span-7-50"><a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a>
</span><span id="__span-7-51"><a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a>  // 4. Find equilibrium (where F = 0)
</span><span id="__span-7-52"><a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a>  // Find zero-crossing by interpolation
</span><span id="__span-7-53"><a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a>  SET zero_crossing_indices = FIND_SIGN_CHANGES(F_numerical)
</span><span id="__span-7-54"><a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a>  IF zero_crossing_indices is not empty THEN
</span><span id="__span-7-55"><a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a>      SET idx = zero_crossing_indices[0]
</span><span id="__span-7-56"><a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a>      // Linear interpolation for precise zero location
</span><span id="__span-7-57"><a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a>      SET r_equilibrium = INTERPOLATE_ZERO(r_values[idx], r_values[idx+1],
</span><span id="__span-7-58"><a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a>                                           F_numerical[idx], F_numerical[idx+1])
</span><span id="__span-7-59"><a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a>  END IF
</span><span id="__span-7-60"><a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a>
</span><span id="__span-7-61"><a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a>  // Find potential minimum
</span><span id="__span-7-62"><a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a>  SET V_min_idx = INDEX_OF_MIN(V_morse)
</span><span id="__span-7-63"><a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a>  SET r_V_min = r_values[V_min_idx]
</span><span id="__span-7-64"><a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a>
</span><span id="__span-7-65"><a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a>  PRINT &quot;Results:&quot;
</span><span id="__span-7-66"><a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a>  PRINT &quot;  Equilibrium from F=0:&quot;, r_equilibrium, &quot;Å&quot;
</span><span id="__span-7-67"><a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a>  PRINT &quot;  Potential minimum at:&quot;, r_V_min, &quot;Å&quot;
</span><span id="__span-7-68"><a id="__codelineno-7-68" name="__codelineno-7-68" href="#__codelineno-7-68"></a>  PRINT &quot;  Theoretical r_e:&quot;, r_e, &quot;Å&quot;
</span><span id="__span-7-69"><a id="__codelineno-7-69" name="__codelineno-7-69" href="#__codelineno-7-69"></a>  PRINT &quot;  Maximum force error:&quot;, MAX(errors)
</span><span id="__span-7-70"><a id="__codelineno-7-70" name="__codelineno-7-70" href="#__codelineno-7-70"></a>  PRINT &quot;==========================================&quot;
</span><span id="__span-7-71"><a id="__codelineno-7-71" name="__codelineno-7-71" href="#__codelineno-7-71"></a>
</span><span id="__span-7-72"><a id="__codelineno-7-72" name="__codelineno-7-72" href="#__codelineno-7-72"></a>  // 5. Visualization
</span><span id="__span-7-73"><a id="__codelineno-7-73" name="__codelineno-7-73" href="#__codelineno-7-73"></a>  CREATE figure with 2 subplots
</span><span id="__span-7-74"><a id="__codelineno-7-74" name="__codelineno-7-74" href="#__codelineno-7-74"></a>
</span><span id="__span-7-75"><a id="__codelineno-7-75" name="__codelineno-7-75" href="#__codelineno-7-75"></a>  // Subplot 1: Potential and Force
</span><span id="__span-7-76"><a id="__codelineno-7-76" name="__codelineno-7-76" href="#__codelineno-7-76"></a>  CREATE subplot with dual y-axes
</span><span id="__span-7-77"><a id="__codelineno-7-77" name="__codelineno-7-77" href="#__codelineno-7-77"></a>
</span><span id="__span-7-78"><a id="__codelineno-7-78" name="__codelineno-7-78" href="#__codelineno-7-78"></a>  // Left axis: Potential
</span><span id="__span-7-79"><a id="__codelineno-7-79" name="__codelineno-7-79" href="#__codelineno-7-79"></a>  PLOT r_values vs V_morse (blue line, left axis)
</span><span id="__span-7-80"><a id="__codelineno-7-80" name="__codelineno-7-80" href="#__codelineno-7-80"></a>  SET left ylabel &quot;Potential Energy V(r) [eV]&quot;
</span><span id="__span-7-81"><a id="__codelineno-7-81" name="__codelineno-7-81" href="#__codelineno-7-81"></a>  SET left y-axis color blue
</span><span id="__span-7-82"><a id="__codelineno-7-82" name="__codelineno-7-82" href="#__codelineno-7-82"></a>
</span><span id="__span-7-83"><a id="__codelineno-7-83" name="__codelineno-7-83" href="#__codelineno-7-83"></a>  // Right axis: Force
</span><span id="__span-7-84"><a id="__codelineno-7-84" name="__codelineno-7-84" href="#__codelineno-7-84"></a>  PLOT r_values vs F_numerical (red line, right axis)
</span><span id="__span-7-85"><a id="__codelineno-7-85" name="__codelineno-7-85" href="#__codelineno-7-85"></a>  PLOT r_values vs F_analytical (red dashed, right axis, for comparison)
</span><span id="__span-7-86"><a id="__codelineno-7-86" name="__codelineno-7-86" href="#__codelineno-7-86"></a>  SET right ylabel &quot;Force F(r) [eV/Å]&quot;
</span><span id="__span-7-87"><a id="__codelineno-7-87" name="__codelineno-7-87" href="#__codelineno-7-87"></a>  SET right y-axis color red
</span><span id="__span-7-88"><a id="__codelineno-7-88" name="__codelineno-7-88" href="#__codelineno-7-88"></a>
</span><span id="__span-7-89"><a id="__codelineno-7-89" name="__codelineno-7-89" href="#__codelineno-7-89"></a>  // Mark equilibrium
</span><span id="__span-7-90"><a id="__codelineno-7-90" name="__codelineno-7-90" href="#__codelineno-7-90"></a>  PLOT axvline(r_equilibrium, linestyle=&#39;:&#39;, color=&#39;green&#39;, label=&#39;Equilibrium&#39;)
</span><span id="__span-7-91"><a id="__codelineno-7-91" name="__codelineno-7-91" href="#__codelineno-7-91"></a>  PLOT axhline(0, linestyle=&#39;-&#39;, color=&#39;gray&#39;, linewidth=0.5)
</span><span id="__span-7-92"><a id="__codelineno-7-92" name="__codelineno-7-92" href="#__codelineno-7-92"></a>
</span><span id="__span-7-93"><a id="__codelineno-7-93" name="__codelineno-7-93" href="#__codelineno-7-93"></a>  SET xlabel &quot;Separation Distance r [Å]&quot;
</span><span id="__span-7-94"><a id="__codelineno-7-94" name="__codelineno-7-94" href="#__codelineno-7-94"></a>  SET title &quot;Morse Potential and Force&quot;
</span><span id="__span-7-95"><a id="__codelineno-7-95" name="__codelineno-7-95" href="#__codelineno-7-95"></a>  ADD legend
</span><span id="__span-7-96"><a id="__codelineno-7-96" name="__codelineno-7-96" href="#__codelineno-7-96"></a>  ADD grid
</span><span id="__span-7-97"><a id="__codelineno-7-97" name="__codelineno-7-97" href="#__codelineno-7-97"></a>
</span><span id="__span-7-98"><a id="__codelineno-7-98" name="__codelineno-7-98" href="#__codelineno-7-98"></a>  // Subplot 2: Error
</span><span id="__span-7-99"><a id="__codelineno-7-99" name="__codelineno-7-99" href="#__codelineno-7-99"></a>  CREATE subplot for error
</span><span id="__span-7-100"><a id="__codelineno-7-100" name="__codelineno-7-100" href="#__codelineno-7-100"></a>  PLOT semilogy(r_values, errors, &#39;o-&#39;, markersize=3)
</span><span id="__span-7-101"><a id="__codelineno-7-101" name="__codelineno-7-101" href="#__codelineno-7-101"></a>  SET xlabel &quot;Separation Distance r [Å]&quot;
</span><span id="__span-7-102"><a id="__codelineno-7-102" name="__codelineno-7-102" href="#__codelineno-7-102"></a>  SET ylabel &quot;Absolute Error |F_numerical - F_analytical|&quot;
</span><span id="__span-7-103"><a id="__codelineno-7-103" name="__codelineno-7-103" href="#__codelineno-7-103"></a>  SET title &quot;Numerical Force Error (Machine Precision Limit)&quot;
</span><span id="__span-7-104"><a id="__codelineno-7-104" name="__codelineno-7-104" href="#__codelineno-7-104"></a>  ADD grid
</span><span id="__span-7-105"><a id="__codelineno-7-105" name="__codelineno-7-105" href="#__codelineno-7-105"></a>
</span><span id="__span-7-106"><a id="__codelineno-7-106" name="__codelineno-7-106" href="#__codelineno-7-106"></a>  DISPLAY figure
</span><span id="__span-7-107"><a id="__codelineno-7-107" name="__codelineno-7-107" href="#__codelineno-7-107"></a>
</span><span id="__span-7-108"><a id="__codelineno-7-108" name="__codelineno-7-108" href="#__codelineno-7-108"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_6"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li>
<p><strong>Force Computation Accuracy:</strong><br />
  The numerical force matches the analytical force to machine precision (<span class="arithmatex">\(\sim 10^{-14}\)</span> error), demonstrating that the Central Difference method with optimal <span class="arithmatex">\(h\)</span> achieves the theoretical accuracy limit.</p>
</li>
<li>
<p><strong>Equilibrium Verification:</strong><br />
  The force zero-crossing occurs at <span class="arithmatex">\(r = 1.500\)</span> Å, exactly matching the parameter <span class="arithmatex">\(r_e\)</span> and the minimum of the potential curve. This validates both the numerical method and the physical consistency (force = -∇V).</p>
</li>
<li>
<p><strong>Physical Features Captured:</strong>  </p>
</li>
<li><strong>Repulsive wall</strong> (<span class="arithmatex">\(r &lt; r_e\)</span>): Strong positive force pushing atoms apart</li>
<li><strong>Equilibrium</strong> (<span class="arithmatex">\(r = r_e\)</span>): Zero force, stable bond length</li>
<li><strong>Attractive tail</strong> (<span class="arithmatex">\(r &gt; r_e\)</span>): Negative force pulling atoms together</li>
<li>
<p><strong>Asymptotic behavior</strong> (<span class="arithmatex">\(r \gg r_e\)</span>): Force approaches zero as <span class="arithmatex">\(V\)</span> flattens</p>
</li>
<li>
<p><strong>Morse vs. Lennard-Jones Comparison:</strong><br />
  The Morse potential provides a more realistic description of molecular bonds:</p>
</li>
<li>Exponential (not power-law) behavior is chemically accurate</li>
<li>Asymmetric well (different steepness on each side)</li>
<li>
<p>Correct dissociation limit (<span class="arithmatex">\(V \to D_e\)</span> as <span class="arithmatex">\(r \to \infty\)</span>)</p>
</li>
<li>
<p><strong>Error Behavior:</strong><br />
  The error plot shows constant <span class="arithmatex">\(\sim 10^{-14}\)</span> across all <span class="arithmatex">\(r\)</span> values, confirming that:</p>
</li>
<li>The chosen <span class="arithmatex">\(h\)</span> is optimal everywhere</li>
<li>No special numerical issues arise from exponentials</li>
<li>
<p>Machine precision is the only error source</p>
</li>
<li>
<p><strong>Practical Application:</strong><br />
  This technique is used in molecular dynamics simulations where forces must be computed from complex, non-analytical potential energy surfaces derived from quantum calculations or experimental fits.</p>
</li>
</ul>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../chapter-4/Chapter-4-WorkBook/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 4. Interpolation &amp; Fitting">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                4. Interpolation & Fitting
              </div>
            </div>
          </a>
        
        
          
          <a href="../../chapter-6/Chapter-6-WorkBook/" class="md-footer__link md-footer__link--next" aria-label="Next: 6. Numerical Integration">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                6. Numerical Integration
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://bigbookofcomputing.github.io" target="_blank" rel="noopener" title="bigbookofcomputing.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bigbookofcomputing" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@big-book-of-computing" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../static/mathjax-config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>