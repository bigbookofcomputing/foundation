
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive guide to the foundations of computational science">
      
      
        <meta name="author" content="Big Book of Computing">
      
      
        <link rel="canonical" href="https://bigbookofcomputing.github.io/chapters/chapter-6/Chapter-6-WorkBook/">
      
      
        <link rel="prev" href="../../chapter-5/Chapter-5-WorkBook/">
      
      
        <link rel="next" href="../../chapter-7/Chapter-7-WorkBook/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/book-icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>6. Numerical Integration - Big Book of Computing | Foundation of Computational Science</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
      <link rel="stylesheet" href="../../../static/styles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ECS7B3X8JM"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ECS7B3X8JM",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ECS7B3X8JM",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-6-numerical-integration-quadrature" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Big Book of Computing | Foundation of Computational Science" class="md-header__button md-logo" aria-label="Big Book of Computing | Foundation of Computational Science" data-md-component="logo">
      
  <img src="../../../assets/book-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Big Book of Computing | Foundation of Computational Science
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6. Numerical Integration
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bigbookofcomputing/foundation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contents/" class="md-tabs__link">
        
  
  
    
  
  Contents

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../introduction/" class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-Essay/" class="md-tabs__link">
          
  
  
    
  
  Chapters

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../chapter-1/Chapter-1-WorkBook/" class="md-tabs__link">
          
  
  
    
  
  WorkBooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-CodeBook/" class="md-tabs__link">
          
  
  
    
  
  CodeBooks

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Big Book of Computing | Foundation of Computational Science" class="md-nav__button md-logo" aria-label="Big Book of Computing | Foundation of Computational Science" data-md-component="logo">
      
  <img src="../../../assets/book-icon.png" alt="logo">

    </a>
    Big Book of Computing | Foundation of Computational Science
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bigbookofcomputing/foundation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contents
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Chapters
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chapters
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Digital Lab Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Computational Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Root Finding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Interpolation & Fitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Numerical Differentiation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-6-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Numerical Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Initial Value Problems I
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Initial Value Problems II
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Boundary Value Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Elliptic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Parabolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Hyperbolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Systems of Linear Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Eigenvalue Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Fourier Analysis & The FFT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Data-Driven Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Randomness in Physics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    WorkBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    WorkBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Digital Lab Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Computational Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Root Finding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Interpolation & Fitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Numerical Differentiation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    6. Numerical Integration
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Numerical Integration
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-6-numerical-integration-quadrature" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 6: Numerical Integration (Quadrature)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#61-the-physics-of-accumulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 The Physics of "Accumulation"
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1 The Physics of &#34;Accumulation&#34;">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-physical-significance-of-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Physical Significance of Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-computational-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Computational Challenge
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-strategy-numerical-quadrature" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Strategy: Numerical Quadrature
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-center-of-mass-of-a-non-uniform-rod" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Center of Mass of a Non-Uniform Rod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-the-simple-tile-the-trapezoidal-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 The "Simple" Tile: The Trapezoidal Rule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2 The &#34;Simple&#34; Tile: The Trapezoidal Rule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-geometric-intuition" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Geometric Intuition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-extended-trapezoidal-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Extended Trapezoidal Rule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-analysis-second-order-accuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Analysis: Second-Order Accuracy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-cutting-corners-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why "Cutting Corners" Matters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-verifying-second-order-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Verifying Second-Order Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-the-better-tile-simpsons-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.3 The "Better" Tile: Simpson's Rule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3 The &#34;Better&#34; Tile: Simpson&#39;s Rule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-lines-to-parabolas" class="md-nav__link">
    <span class="md-ellipsis">
      
        From Lines to Parabolas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#derivation-of-the-simpsons-formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        Derivation of the Simpson's Formula
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-extended-simpsons-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Extended Simpson's Rule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-analysis-fourth-order-accuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Analysis: Fourth-Order Accuracy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-fourth-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Fourth-Order?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-gotcha-even-intervals-required" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Gotcha: Even Intervals Required
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-oh2-vs-oh4-convergence-showdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: \(O(h^2)\) vs. \(O(h^4)\) Convergence Showdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#64-the-optimal-tile-gaussian-quadrature" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.4 The "Optimal" Tile: Gaussian Quadrature
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4 The &#34;Optimal&#34; Tile: Gaussian Quadrature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-fundamental-idea" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Fundamental Idea
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-mathematical-foundation-legendre-polynomials" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Mathematical Foundation: Legendre Polynomials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transforming-to-arbitrary-intervals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transforming to Arbitrary Intervals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-professional-tool-scipyintegratequad" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Professional Tool: scipy.integrate.quad
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-quantum-mechanicsnormalizing-a-wavefunction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Quantum Mechanicsâ€”Normalizing a Wavefunction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#65-handling-the-hard-stuff-tricky-integrals" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.5 Handling the "Hard Stuff": Tricky Integrals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.5 Handling the &#34;Hard Stuff&#34;: Tricky Integrals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-1-infinite-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem 1: Infinite Limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-2-singularities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem 2: Singularities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-professional-approach" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Professional Approach
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-taming-the-gaussian-integral" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Taming the Gaussian Integral
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#66-core-application-period-of-a-nonlinear-pendulum" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.6 Core Application: Period of a Nonlinear Pendulum
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.6 Core Application: Period of a Nonlinear Pendulum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-physics-conservation-of-energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Physics: Conservation of Energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriving-the-period-integral" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deriving the Period Integral
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-computational-challenge-endpoint-singularity" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Computational Challenge: Endpoint Singularity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-professional-solution-scipyintegratequad" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Professional Solution: scipy.integrate.quad
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#small-angle-approximation-for-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Small-Angle Approximation for Comparison
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-exact-vs-approximate-pendulum-period" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Exact vs. Approximate Pendulum Period
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#67-teaser-for-volume-ii-monte-carlo-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.7 Teaser for Volume II: Monte Carlo Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.7 Teaser for Volume II: Monte Carlo Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-curse-of-dimensionality" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Curse of Dimensionality
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-monte-carlo-solution-random-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Monte Carlo Solution: Random Sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-analysis-the-central-limit-theorem" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Analysis: The Central Limit Theorem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-verdict-when-to-use-monte-carlo" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Verdict: When to Use Monte Carlo
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variance-reduction-the-secret-to-practical-monte-carlo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Variance Reduction: The Secret to Practical Monte Carlo
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-1d-monte-carlo-vs-simpsons-convergence-battle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: 1D Monte Carlo vs. Simpson's Convergence Battle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Initial Value Problems I
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Initial Value Problems II
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Boundary Value Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Elliptic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Parabolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Hyperbolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Systems of Linear Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Eigenvalue Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Fourier Analysis & The FFT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Data-Driven Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Randomness in Physics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CodeBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    CodeBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Digital Lab Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Computational Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Root Finding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Interpolation & Fitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Numerical Differentiation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-6-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Numerical Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Initial Value Problems I
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Initial Value Problems II
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Boundary Value Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Elliptic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Parabolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Hyperbolic PDEs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Systems of Linear Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Eigenvalue Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Fourier Analysis & The FFT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-16/Chapter-16-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Data-Driven Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-17/Chapter-17-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Randomness in Physics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-6-numerical-integration-quadrature" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 6: Numerical Integration (Quadrature)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#61-the-physics-of-accumulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 The Physics of "Accumulation"
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1 The Physics of &#34;Accumulation&#34;">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-physical-significance-of-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Physical Significance of Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-computational-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Computational Challenge
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-strategy-numerical-quadrature" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Strategy: Numerical Quadrature
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-center-of-mass-of-a-non-uniform-rod" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Center of Mass of a Non-Uniform Rod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-the-simple-tile-the-trapezoidal-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 The "Simple" Tile: The Trapezoidal Rule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2 The &#34;Simple&#34; Tile: The Trapezoidal Rule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-geometric-intuition" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Geometric Intuition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-extended-trapezoidal-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Extended Trapezoidal Rule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-analysis-second-order-accuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Analysis: Second-Order Accuracy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-cutting-corners-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why "Cutting Corners" Matters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-verifying-second-order-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Verifying Second-Order Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-the-better-tile-simpsons-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.3 The "Better" Tile: Simpson's Rule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3 The &#34;Better&#34; Tile: Simpson&#39;s Rule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-lines-to-parabolas" class="md-nav__link">
    <span class="md-ellipsis">
      
        From Lines to Parabolas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#derivation-of-the-simpsons-formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        Derivation of the Simpson's Formula
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-extended-simpsons-rule" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Extended Simpson's Rule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-analysis-fourth-order-accuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Analysis: Fourth-Order Accuracy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-fourth-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Fourth-Order?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-gotcha-even-intervals-required" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Gotcha: Even Intervals Required
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-oh2-vs-oh4-convergence-showdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: \(O(h^2)\) vs. \(O(h^4)\) Convergence Showdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#64-the-optimal-tile-gaussian-quadrature" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.4 The "Optimal" Tile: Gaussian Quadrature
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4 The &#34;Optimal&#34; Tile: Gaussian Quadrature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-fundamental-idea" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Fundamental Idea
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-mathematical-foundation-legendre-polynomials" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Mathematical Foundation: Legendre Polynomials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transforming-to-arbitrary-intervals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transforming to Arbitrary Intervals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-professional-tool-scipyintegratequad" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Professional Tool: scipy.integrate.quad
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-quantum-mechanicsnormalizing-a-wavefunction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Quantum Mechanicsâ€”Normalizing a Wavefunction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#65-handling-the-hard-stuff-tricky-integrals" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.5 Handling the "Hard Stuff": Tricky Integrals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.5 Handling the &#34;Hard Stuff&#34;: Tricky Integrals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-1-infinite-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem 1: Infinite Limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-2-singularities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem 2: Singularities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-professional-approach" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Professional Approach
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-taming-the-gaussian-integral" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Taming the Gaussian Integral
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#66-core-application-period-of-a-nonlinear-pendulum" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.6 Core Application: Period of a Nonlinear Pendulum
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.6 Core Application: Period of a Nonlinear Pendulum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-physics-conservation-of-energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Physics: Conservation of Energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriving-the-period-integral" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deriving the Period Integral
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-computational-challenge-endpoint-singularity" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Computational Challenge: Endpoint Singularity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-professional-solution-scipyintegratequad" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Professional Solution: scipy.integrate.quad
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#small-angle-approximation-for-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Small-Angle Approximation for Comparison
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-exact-vs-approximate-pendulum-period" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: Exact vs. Approximate Pendulum Period
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#67-teaser-for-volume-ii-monte-carlo-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.7 Teaser for Volume II: Monte Carlo Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.7 Teaser for Volume II: Monte Carlo Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theoretical-background_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theoretical Background
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theoretical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-curse-of-dimensionality" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Curse of Dimensionality
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-monte-carlo-solution-random-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Monte Carlo Solution: Random Sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-analysis-the-central-limit-theorem" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Analysis: The Central Limit Theorem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-verdict-when-to-use-monte-carlo" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Verdict: When to Use Monte Carlo
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variance-reduction-the-secret-to-practical-monte-carlo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Variance Reduction: The Secret to Practical Monte Carlo
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehension-check_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comprehension Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hands-on-project_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hands-On Project
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hands-On Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-1d-monte-carlo-vs-simpsons-convergence-battle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project: 1D Monte Carlo vs. Simpson's Convergence Battle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-blueprint_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Blueprint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pseudocode-implementation_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pseudocode Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outcome-and-interpretation_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outcome and Interpretation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/bigbookofcomputing/foundation/edit/master/docs/chapters/chapter-6/Chapter-6-WorkBook.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/bigbookofcomputing/foundation/raw/master/docs/chapters/chapter-6/Chapter-6-WorkBook.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>6. Numerical Integration</h1>

<h2 id="chapter-6-numerical-integration-quadrature">Chapter 6: Numerical Integration (Quadrature)</h2>
<hr />
<h2 class="heading-with-pill" id="61-the-physics-of-accumulation">6.1 The Physics of "Accumulation"</h2>
<blockquote>
<p><strong>Concept:</strong> Integration as Total Accumulation â€¢ <strong>Difficulty:</strong> â˜…â˜…â˜†â˜†â˜†</p>
<p><strong>Summary:</strong> The integral, <span class="arithmatex">\(I = \int f(x) dx\)</span>, is the language of <strong>total accumulation</strong> in physics. While differentiation reveals instantaneous change, integration computes global propertiesâ€”work, probability, energyâ€”by summing continuous distributions over a domain.</p>
</blockquote>
<hr />
<h3 id="theoretical-background">Theoretical Background</h3>
<p>In Chapter 5, we mastered the derivative (<span class="arithmatex">\(\frac{d}{dx}\)</span>), the language of <strong>instantaneous change</strong>. Now, we tackle its inverse operation: the <strong>integral</strong> (<span class="arithmatex">\(I = \int f(x) dx\)</span>), the language of <strong>total accumulation</strong>. This is how we "sum up" a quantity that is continuously changing across space or time.</p>
<h4 id="the-physical-significance-of-integration">The Physical Significance of Integration</h4>
<p>Integration is the mathematical engine behind the <strong>global properties</strong> of physical systems:</p>
<ul>
<li>
<p><strong>Work:</strong> The total work done by a force along a path is the accumulation of infinitesimal contributions:
  $<span class="arithmatex">\(W = \int \mathbf{F} \cdot d\mathbf{x}\)</span>$</p>
</li>
<li>
<p><strong>Probability:</strong> In quantum mechanics, the wavefunction <span class="arithmatex">\(\psi(x)\)</span> must satisfy the normalization condition:
  $<span class="arithmatex">\(\int_{-\infty}^{\infty} |\psi(x)|^2 dx = 1\)</span>$
  This ensures the total probability of finding the particle <em>somewhere</em> equals 1.</p>
</li>
<li>
<p><strong>Statistical Mechanics:</strong> The partition function, which encodes all thermodynamic information, is an integral over all energy states:
  $<span class="arithmatex">\(Z = \int e^{-\beta E} \, dE\)</span>$
  where <span class="arithmatex">\(\beta = 1/(k_B T)\)</span>.</p>
</li>
<li>
<p><strong>Center of Mass:</strong> For a continuous mass distribution <span class="arithmatex">\(\rho(x)\)</span>, the center of mass is:
  $<span class="arithmatex">\(\bar{x} = \frac{\int x \rho(x) dx}{\int \rho(x) dx}\)</span>$</p>
</li>
</ul>
<h4 id="the-computational-challenge">The Computational Challenge</h4>
<p>In pure mathematics, we can often evaluate integrals analytically using techniques from calculus (integration by parts, substitution, etc.). However, in computational physics, we face two fundamental obstacles:</p>
<ol>
<li>
<p><strong>No Closed-Form Solution:</strong> Many physically important functions (e.g., <span class="arithmatex">\(e^{-x^2}\)</span>, <span class="arithmatex">\(\sin(x)/x\)</span>) have no elementary antiderivative.</p>
</li>
<li>
<p><strong>Discrete Data:</strong> Experimental measurements or numerical simulations produce <strong>discrete data points</strong> <span class="arithmatex">\((x_i, y_i)\)</span> on a grid, not continuous functions. We cannot apply analytical calculus to a table of numbers.</p>
</li>
</ol>
<h4 id="the-strategy-numerical-quadrature">The Strategy: Numerical Quadrature</h4>
<p>The solution is <strong>numerical quadrature</strong> (from the Latin <em>quadratura</em>, meaning "to make square"). The core idea is elegant:</p>
<ol>
<li>
<p><strong>Tile the Area:</strong> Divide the region under the curve into simple geometric shapes (rectangles, trapezoids, parabolas) whose areas we can calculate exactly.</p>
</li>
<li>
<p><strong>Sum the Tiles:</strong> Add up the areas of all tiles to approximate the total integral:
   $<span class="arithmatex">\(I \approx \sum_{i=1}^{N} A_i\)</span>$
   where <span class="arithmatex">\(A_i\)</span> is the area of the <span class="arithmatex">\(i\)</span>-th tile.</p>
</li>
<li>
<p><strong>Refine the Grid:</strong> As we increase the number of tiles (decrease the spacing <span class="arithmatex">\(h\)</span>), the approximation converges to the true value.</p>
</li>
</ol>
<p>The quality of this approximation depends on:
- <strong>The shape of the tile</strong> (linear, quadratic, cubic interpolation)
- <strong>The grid spacing</strong> <span class="arithmatex">\(h\)</span> (finer grids reduce truncation error)
- <strong>The smoothness of the function</strong> (rough or singular functions are harder to integrate)</p>
<div class="section-divider"></div>

<h3 id="comprehension-check">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the fundamental physical concept that integration computes?</strong></p>
<ul>
<li>A. The rate of instantaneous change</li>
<li>B. The total accumulation of a quantity over a domain</li>
<li>C. The "sweet spot" between competing errors</li>
<li>D. The slope of a function on a discrete grid</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>Integration is the process of <strong>accumulating</strong> infinitesimal contributions across a continuous domain. While differentiation asks "how fast is this changing right now?", integration asks "how much total quantity has accumulated?". This is why work (accumulated force), probability (accumulated wavefunction density), and energy (accumulated contributions from all states) are all defined as integrals.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. The process of approximating integrals by summing areas of simple geometric shapes is called:</strong></p>
<ul>
<li>A. Numerical differentiation</li>
<li>B. Root finding</li>
<li>C. Numerical quadrature</li>
<li>D. The Monte Carlo method</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p><strong>Numerical quadrature</strong> is the systematic approach of tiling the area under a curve with simple shapes (trapezoids, parabolas, etc.) and summing their areas. The term comes from the Latin <em>quadratura</em>, reflecting the geometric origin of the method.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. Why can't we always use analytical calculus techniques to evaluate integrals in computational physics?</strong></p>
<ul>
<li>A. Computers cannot handle symbolic mathematics</li>
<li>B. Many functions have no closed-form antiderivative, and experimental data is discrete</li>
<li>C. Numerical methods are always more accurate</li>
<li>D. Integration is undefined for discrete data</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>Two fundamental barriers exist: (1) Many physically important functions (like the Gaussian <span class="arithmatex">\(e^{-x^2}\)</span> or the sinc function <span class="arithmatex">\(\sin(x)/x\)</span>) have no elementary antiderivative expressible in terms of standard functions. (2) Experimental measurements and simulations produce <strong>discrete data points</strong>, not continuous functions, making analytical techniques inapplicable. This is why numerical quadrature is essential.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Chapter 5 was about <span class="arithmatex">\(\frac{d}{dx}\)</span> (change). Why is <span class="arithmatex">\(\int dx\)</span> (accumulation) arguably even more fundamental to the practice of physics?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests your understanding of the relationship between local and global descriptions in physics.</p>
<ol>
<li>
<p><strong>Local vs. Global:</strong><br />
   The derivative describes <strong>local, instantaneous</strong> behaviorâ€”the velocity at this moment, the electric field at this point. The integral computes <strong>global, cumulative</strong> propertiesâ€”the total distance traveled, the total energy stored in a field.</p>
</li>
<li>
<p><strong>Observables are Global:</strong><br />
   Most measurable quantities in physics are accumulated totals: the work done on an object, the total probability of detection, the center of mass of a system, the partition function that determines temperature and pressure. These are all integrals.</p>
</li>
<li>
<p><strong>From Rules to Reality:</strong><br />
   Differential equations (like Newton's laws, Maxwell's equations, SchrÃ¶dinger's equation) give us the <strong>rules</strong> governing how systems evolve. But to extract <strong>predictions</strong>â€”trajectories, energies, probabilitiesâ€”we must <em>integrate</em> these equations. Integration translates the microscopic physics into macroscopic observables.</p>
</li>
<li>
<p><strong>The Hierarchy:</strong><br />
   You could argue that physics <em>happens</em> at the differential level (forces cause accelerations), but physics is <em>measured</em> at the integral level (we observe cumulative effects). This makes integration the bridge from theory to experiment.</p>
</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-center-of-mass-of-a-non-uniform-rod"><strong>Project:</strong> Center of Mass of a Non-Uniform Rod</h4>
<hr />
<h4 id="project-blueprint"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Compute the center of mass <span class="arithmatex">\(\bar{x}\)</span> of a one-dimensional rod with non-uniform linear mass density <span class="arithmatex">\(\lambda(x)\)</span>, demonstrating integration as the tool for calculating <strong>global average properties</strong> from continuous distributions.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>The center of mass is defined as the mass-weighted average position: <br> $<span class="arithmatex">\(\bar{x} = \frac{\int_0^L x \cdot \lambda(x) dx}{\int_0^L \lambda(x) dx}\)</span>$ <br> The numerator accumulates position weighted by mass; the denominator is the total mass <span class="arithmatex">\(M\)</span>.</td>
</tr>
<tr>
<td><strong>Physical Setup</strong></td>
<td>Consider a rod of length <span class="arithmatex">\(L = 1.0\)</span> m with a linearly varying mass density: <br> $<span class="arithmatex">\(\lambda(x) = \lambda_0 (1 + \alpha x)\)</span>$ <br> where <span class="arithmatex">\(\lambda_0 = 2.0\)</span> kg/m is the density at <span class="arithmatex">\(x=0\)</span>, and <span class="arithmatex">\(\alpha = 3.0\)</span> m<span class="arithmatex">\(^{-1}\)</span> controls the rate of increase. The rod is denser at the right end.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Evaluate both integrals numerically using a simple quadrature method (e.g., trapezoidal rule or <code>scipy.integrate.quad</code>). <br> - <strong>Numerator:</strong> <span class="arithmatex">\(I_{\text{num}} = \int_0^L x \cdot \lambda(x) dx\)</span> <br> - <strong>Denominator:</strong> <span class="arithmatex">\(I_{\text{den}} = \int_0^L \lambda(x) dx\)</span> <br> The center of mass is then <span class="arithmatex">\(\bar{x} = I_{\text{num}} / I_{\text{den}}\)</span>.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define the mass density function <span class="arithmatex">\(\lambda(x)\)</span>. <br> 2. Define the two integrands: <span class="arithmatex">\(f_{\text{num}}(x) = x \cdot \lambda(x)\)</span> and <span class="arithmatex">\(f_{\text{den}}(x) = \lambda(x)\)</span>. <br> 3. Integrate both functions from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(L\)</span>. <br> 4. Compute the center of mass <span class="arithmatex">\(\bar{x}\)</span>.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>Because the rod is denser toward <span class="arithmatex">\(x = L\)</span>, the center of mass should be <strong>shifted to the right</strong> of the geometric center (<span class="arithmatex">\(L/2 = 0.5\)</span> m). The exact value can be verified analytically by hand if desired.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>lambda_0</code>: baseline density (kg/m) <br> - <code>alpha</code>: density gradient (m<span class="arithmatex">\(^{-1}\)</span>) <br> - <code>L</code>: length of rod (m) <br> - <code>I_num</code>: numerator integral <br> - <code>I_den</code>: total mass <br> - <code>x_cm</code>: center of mass position</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Compare the numerical result to the analytical solution (if computed) or check physical intuition: <span class="arithmatex">\(\bar{x} &gt; L/2\)</span> since mass is concentrated toward the right.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Print the total mass <span class="arithmatex">\(M\)</span>, the center of mass <span class="arithmatex">\(\bar{x}\)</span>, and verify that it lies to the right of the geometric midpoint.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>BEGIN
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>  // 1. Physical Parameters
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>  SET lambda_0 = 2.0    // kg/m (baseline density)
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>  SET alpha = 3.0       // m^(-1) (density gradient)
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>  SET L = 1.0           // m (rod length)
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>  // 2. Define Mass Density Function
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>  FUNCTION lambda(x):
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>      RETURN lambda_0 * (1 + alpha * x)
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>  END FUNCTION
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>  // 3. Define Integrands
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>  FUNCTION f_numerator(x):
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>      RETURN x * lambda(x)
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>  END FUNCTION
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>  FUNCTION f_denominator(x):
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>      RETURN lambda(x)
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>  END FUNCTION
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>  // 4. Numerical Integration (using library or manual method)
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>  // Using scipy.integrate.quad as the &quot;professional&quot; approach:
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>  I_num = INTEGRATE(f_numerator, from=0, to=L)
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>  I_den = INTEGRATE(f_denominator, from=0, to=L)
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>  // 5. Compute Center of Mass
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>  SET x_cm = I_num / I_den
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>  // 6. Output Results
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>  PRINT &quot;===== Non-Uniform Rod: Center of Mass =====&quot;
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>  PRINT &quot;Rod length L:&quot;, L, &quot;m&quot;
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>  PRINT &quot;Density function: Î»(x) = Î»â‚€(1 + Î±x)&quot;
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>  PRINT &quot;  Î»â‚€ =&quot;, lambda_0, &quot;kg/m&quot;
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>  PRINT &quot;  Î± =&quot;, alpha, &quot;mâ»Â¹&quot;
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>  PRINT &quot;----------------------------------------------&quot;
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>  PRINT &quot;Total mass M =&quot;, I_den, &quot;kg&quot;
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>  PRINT &quot;Center of mass xÌ„ =&quot;, x_cm, &quot;m&quot;
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>  PRINT &quot;Geometric center L/2 =&quot;, L/2, &quot;m&quot;
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>  PRINT &quot;----------------------------------------------&quot;
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>  IF x_cm &gt; L/2 THEN
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>      PRINT &quot;âœ“ Center of mass is shifted RIGHT (denser at right end)&quot;
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>  ELSE
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>      PRINT &quot;âœ— Unexpected: center of mass is at or left of geometric center&quot;
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>  END IF
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li>
<p><strong>Physical Insight:</strong> The center of mass is <strong>not</strong> at the geometric center (<span class="arithmatex">\(L/2\)</span>) because the rod has non-uniform density. Since <span class="arithmatex">\(\lambda(x)\)</span> increases with <span class="arithmatex">\(x\)</span> (the rod is denser toward the right), the center of mass shifts to the right.</p>
</li>
<li>
<p><strong>Verification:</strong> For the given parameters, the analytical solution is:
  $<span class="arithmatex">\(\bar{x} = \frac{\int_0^L x \lambda_0(1 + \alpha x) dx}{\int_0^L \lambda_0(1 + \alpha x) dx}\)</span>$</p>
</li>
</ul>
<p>Evaluating by hand:
  - Numerator: <span class="arithmatex">\(\lambda_0 \left[\frac{x^2}{2} + \alpha \frac{x^3}{3}\right]_0^L = \lambda_0 \left(\frac{L^2}{2} + \alpha \frac{L^3}{3}\right)\)</span>
  - Denominator: <span class="arithmatex">\(\lambda_0 \left[x + \alpha \frac{x^2}{2}\right]_0^L = \lambda_0 \left(L + \alpha \frac{L^2}{2}\right)\)</span>
  - Result: <span class="arithmatex">\(\bar{x} = \frac{L^2/2 + \alpha L^3/3}{L + \alpha L^2/2}\)</span></p>
<p>For <span class="arithmatex">\(L=1\)</span>, <span class="arithmatex">\(\alpha=3\)</span>: <span class="arithmatex">\(\bar{x} = \frac{0.5 + 1.0}{1.0 + 1.5} = \frac{1.5}{2.5} = 0.6\)</span> m</p>
<ul>
<li>
<p><strong>Numerical Accuracy:</strong> The numerical integration should produce <span class="arithmatex">\(\bar{x} \approx 0.6\)</span> m, confirming that the rod's balance point is shifted 20% to the right of its geometric center.</p>
</li>
<li>
<p><strong>Broader Lesson:</strong> This project demonstrates that integration is the mathematical tool for computing <strong>weighted averages</strong>â€”a concept that appears throughout physics (expectation values in quantum mechanics, moments of inertia, electric dipole moments, etc.).</p>
</li>
</ul>
<h2 class="heading-with-pill" id="62-the-simple-tile-the-trapezoidal-rule">6.2 The "Simple" Tile: The Trapezoidal Rule</h2>
<blockquote>
<p><strong>Concept:</strong> Linear Interpolation for Quadrature â€¢ <strong>Difficulty:</strong> â˜…â˜…â˜†â˜†â˜†</p>
<p><strong>Summary:</strong> The Trapezoidal Rule approximates the integral by tiling the area with trapezoids formed by linear interpolation between adjacent grid points. It achieves second-order accuracy (<span class="arithmatex">\(O(h^2)\)</span>) and is robust, simple, and universally applicable to discrete data.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_1">Theoretical Background</h3>
<p>The <strong>Trapezoidal Rule</strong> is the simplest and most intuitive numerical quadrature method. It answers the question: "How do we estimate the area under a curve when we only have discrete data points?"</p>
<h4 id="the-geometric-intuition">The Geometric Intuition</h4>
<p>Given two adjacent data points <span class="arithmatex">\((x_i, y_i)\)</span> and <span class="arithmatex">\((x_{i+1}, y_{i+1})\)</span>, we draw a <strong>straight line</strong> connecting them. This line forms the "roof" of a trapezoid whose base rests on the <span class="arithmatex">\(x\)</span>-axis. The area of this trapezoid is:</p>
<div class="arithmatex">\[A_i = h \cdot \frac{y_i + y_{i+1}}{2}\]</div>
<p>where <span class="arithmatex">\(h = x_{i+1} - x_i\)</span> is the width of the interval.</p>
<p>This formula comes directly from geometry: the area of a trapezoid is the width times the average of the two parallel sides.</p>
<h4 id="the-extended-trapezoidal-rule">The Extended Trapezoidal Rule</h4>
<p>For a complete integral from <span class="arithmatex">\(x_0\)</span> to <span class="arithmatex">\(x_N\)</span> with <span class="arithmatex">\(N\)</span> intervals of uniform width <span class="arithmatex">\(h\)</span>, we sum all trapezoidal areas:</p>
<div class="arithmatex">\[I = \sum_{i=0}^{N-1} A_i = \sum_{i=0}^{N-1} h \cdot \frac{y_i + y_{i+1}}{2}\]</div>
<p>Expanding this sum carefully, we notice that every <strong>interior point</strong> appears twice:
- <span class="arithmatex">\(y_1\)</span> appears in the trapezoid from <span class="arithmatex">\(x_0\)</span> to <span class="arithmatex">\(x_1\)</span> (as <span class="arithmatex">\(y_{i+1}\)</span>) and in the trapezoid from <span class="arithmatex">\(x_1\)</span> to <span class="arithmatex">\(x_2\)</span> (as <span class="arithmatex">\(y_i\)</span>).
- Each interior point contributes <span class="arithmatex">\(\frac{h}{2} + \frac{h}{2} = h\)</span> to the total.</p>
<p>The <strong>endpoints</strong> <span class="arithmatex">\(y_0\)</span> and <span class="arithmatex">\(y_N\)</span> appear only once, contributing <span class="arithmatex">\(\frac{h}{2}\)</span> each.</p>
<p>Factoring out <span class="arithmatex">\(h\)</span>, we obtain the <strong>Extended Trapezoidal Rule</strong>:</p>
<div class="arithmatex">\[I \approx h \left[ \frac{1}{2}y_0 + y_1 + y_2 + \cdots + y_{N-1} + \frac{1}{2}y_N \right]\]</div>
<p>This is the working formula for practical implementation.</p>
<h4 id="error-analysis-second-order-accuracy">Error Analysis: Second-Order Accuracy</h4>
<p>The truncation error of the Trapezoidal Rule can be derived using Taylor series expansion. For a single interval <span class="arithmatex">\([x_i, x_{i+1}]\)</span>:</p>
<div class="arithmatex">\[\text{Error}_{\text{local}} = -\frac{h^3}{12} f''(\xi)\]</div>
<p>where <span class="arithmatex">\(\xi\)</span> is some point in the interval.</p>
<p>When summing over all <span class="arithmatex">\(N\)</span> intervals, the <strong>global truncation error</strong> is:</p>
<div class="arithmatex">\[\text{Error}_{\text{total}} = O(h^2)\]</div>
<p>This means:
- If we <strong>halve</strong> <span class="arithmatex">\(h\)</span> (double the number of points), the error decreases by a factor of <strong>four</strong> (<span class="arithmatex">\(2^2 = 4\)</span>).
- The method is <strong>second-order accurate</strong>.</p>
<h4 id="why-cutting-corners-matters">Why "Cutting Corners" Matters</h4>
<p>The straight-line approximation is crude when the true function is curved. Consider integrating <span class="arithmatex">\(\sin(x)\)</span> from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(\pi\)</span>:
- The trapezoid systematically <strong>underestimates</strong> the area because the straight line cuts below the curve.
- This systematic bias is the price we pay for simplicity.</p>
<p>However, this error decreases rapidly as <span class="arithmatex">\(h \to 0\)</span>, making the method both robust and practical.</p>
<div class="section-divider"></div>

<h3 id="comprehension-check_1">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the geometric shape used to approximate each slice of the integral in the Trapezoidal Rule?</strong></p>
<ul>
<li>A. A rectangle</li>
<li>B. A trapezoid formed by linear interpolation</li>
<li>C. A parabola</li>
<li>D. A triangle</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>The Trapezoidal Rule connects adjacent data points with a <strong>straight line</strong>, forming a trapezoid. The area of this trapezoid is <span class="arithmatex">\(h \cdot (y_i + y_{i+1})/2\)</span>, which is the average height times the width.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. In the Extended Trapezoidal Rule, why do interior points receive a weight of 1 while endpoints receive a weight of &frac12;?</strong></p>
<ul>
<li>A. It's an arbitrary convention for symmetry</li>
<li>B. Interior points are counted twice (once by each adjacent trapezoid), while endpoints appear only once</li>
<li>C. The formula requires normalization</li>
<li>D. Endpoints are less accurate than interior points</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>Each interior point <span class="arithmatex">\(y_i\)</span> serves as the <strong>right edge</strong> of the trapezoid to its left and the <strong>left edge</strong> of the trapezoid to its right. Each contribution adds <span class="arithmatex">\(h/2\)</span>, so <span class="arithmatex">\(y_i\)</span> receives a total weight of <span class="arithmatex">\(h/2 + h/2 = h\)</span> (which factors out as 1 when <span class="arithmatex">\(h\)</span> is pulled outside). The endpoints <span class="arithmatex">\(y_0\)</span> and <span class="arithmatex">\(y_N\)</span> appear in only one trapezoid each, receiving a weight of <span class="arithmatex">\(h/2\)</span>.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. If you double the number of grid points <span class="arithmatex">\(N\)</span> (halving <span class="arithmatex">\(h\)</span>) in the Trapezoidal Rule, the truncation error decreases by a factor of:</strong></p>
<ul>
<li>A. 2</li>
<li>B. 4</li>
<li>C. 8</li>
<li>D. <span class="arithmatex">\(\sqrt{2}\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>The Trapezoidal Rule has <strong>second-order accuracy</strong> (<span class="arithmatex">\(O(h^2)\)</span>). Halving <span class="arithmatex">\(h\)</span> means the error scales as <span class="arithmatex">\((h/2)^2 = h^2/4\)</span>, which is <strong>four times smaller</strong> than the original error. This quadratic convergence is a defining characteristic of the method.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Walk me through the conceptual derivation of the Extended Trapezoidal Rule. Why do the interior points have a weight of 1, while the endpoints have a weight of &frac12;?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests your understanding of how the formula arises from summing individual trapezoidal contributions.</p>
<ol>
<li>
<p><strong>Single Trapezoid:</strong><br />
   The area of one trapezoid from <span class="arithmatex">\(x_i\)</span> to <span class="arithmatex">\(x_{i+1}\)</span> is:
   $<span class="arithmatex">\(A_i = h \cdot \frac{y_i + y_{i+1}}{2}\)</span>$</p>
</li>
<li>
<p><strong>Summing All Trapezoids:</strong><br />
   The total integral is the sum of all trapezoidal areas:
   $<span class="arithmatex">\(I = \sum_{i=0}^{N-1} h \cdot \frac{y_i + y_{i+1}}{2}\)</span>$</p>
</li>
<li>
<p><strong>Expanding the Sum:</strong><br />
   Writing out the first few terms:
   $<span class="arithmatex">\(I = \frac{h}{2}(y_0 + y_1) + \frac{h}{2}(y_1 + y_2) + \frac{h}{2}(y_2 + y_3) + \cdots + \frac{h}{2}(y_{N-1} + y_N)\)</span>$</p>
</li>
<li>
<p><strong>Collecting Terms:</strong><br />
   Notice that:</p>
</li>
<li><span class="arithmatex">\(y_0\)</span> appears <strong>once</strong> (coefficient <span class="arithmatex">\(h/2\)</span>)</li>
<li><span class="arithmatex">\(y_1\)</span> appears <strong>twice</strong>: once as the right edge of the first trapezoid, once as the left edge of the second (total coefficient <span class="arithmatex">\(h\)</span>)</li>
<li><span class="arithmatex">\(y_2, y_3, \ldots, y_{N-1}\)</span> all appear <strong>twice</strong> (coefficient <span class="arithmatex">\(h\)</span> each)</li>
<li>
<p><span class="arithmatex">\(y_N\)</span> appears <strong>once</strong> (coefficient <span class="arithmatex">\(h/2\)</span>)</p>
</li>
<li>
<p><strong>Factoring Out <span class="arithmatex">\(h\)</span>:</strong><br />
   Pulling out the common factor <span class="arithmatex">\(h\)</span> gives:
   $<span class="arithmatex">\(I = h \left[\frac{1}{2}y_0 + y_1 + y_2 + \cdots + y_{N-1} + \frac{1}{2}y_N\right]\)</span>$</p>
</li>
</ol>
<p>This is the Extended Trapezoidal Rule. The interior weights of 1 and endpoint weights of &frac12; arise naturally from the overlapping trapezoidal contributions.</p>
</details>
</div>
<hr />
<h3 id="hands-on-project_1"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-verifying-second-order-convergence"><strong>Project:</strong> Verifying Second-Order Convergence</h4>
<hr />
<h4 id="project-blueprint_1"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Implement the Trapezoidal Rule from scratch and verify its <strong>second-order convergence</strong> (<span class="arithmatex">\(O(h^2)\)</span>) by measuring how the error decreases as the number of grid points increases.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>For a function with known analytical integral, the truncation error should decrease as <span class="arithmatex">\(h^2\)</span>. Doubling the number of points (halving <span class="arithmatex">\(h\)</span>) should reduce the error by a factor of 4.</td>
</tr>
<tr>
<td><strong>Test Function</strong></td>
<td>Use <span class="arithmatex">\(f(x) = \sin(x)\)</span> on the interval <span class="arithmatex">\([0, \pi]\)</span>. The exact integral is: <br> $<span class="arithmatex">\(I_{\text{exact}} = \int_0^{\pi} \sin(x) dx = 2\)</span>$</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Run the Trapezoidal Rule for several grid sizes: <span class="arithmatex">\(N = 10, 20, 40, 80, 160\)</span>. For each <span class="arithmatex">\(N\)</span>, compute: <br> - The numerical approximation <span class="arithmatex">\(I_{\text{trap}}\)</span> <br> - The absolute error <span class="arithmatex">\(E = \lvert I_{\text{exact}} - I_{\text{trap}} \rvert\)</span> <br> - The error ratio between consecutive grid sizes</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Implement the Extended Trapezoidal Rule formula. <br> 2. Loop over increasing values of <span class="arithmatex">\(N\)</span>. <br> 3. Compute the integral and error for each <span class="arithmatex">\(N\)</span>. <br> 4. Calculate the ratio of consecutive errors to verify the factor-of-4 reduction.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>Each doubling of <span class="arithmatex">\(N\)</span> should reduce the error by a factor <strong>close to 4</strong>, confirming <span class="arithmatex">\(O(h^2)\)</span> convergence. Minor deviations occur due to round-off error at very small <span class="arithmatex">\(h\)</span>.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>N</code>: number of grid points <br> - <code>h</code>: grid spacing (<span class="arithmatex">\(\pi / N\)</span>) <br> - <code>I_trap</code>: computed integral <br> - <code>error</code>: absolute error <br> - <code>error_ratio</code>: ratio of consecutive errors</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm that <code>error_ratio</code> <span class="arithmatex">\(\approx 4\)</span> for each doubling of <span class="arithmatex">\(N\)</span>, validating the theoretical prediction of second-order accuracy.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Print a table showing <span class="arithmatex">\(N\)</span>, <span class="arithmatex">\(h\)</span>, <span class="arithmatex">\(I_{\text{trap}}\)</span>, error, and error ratio for each grid size.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_1"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>BEGIN
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>  // 1. Setup
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  FUNCTION f(x):
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>      RETURN sin(x)
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>  END FUNCTION
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>  SET I_exact = 2.0  // Known analytical result
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>  SET a = 0.0        // Lower limit
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>  SET b = Ï€          // Upper limit
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>  PRINT &quot;===== Trapezoidal Rule: Convergence Test =====&quot;
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>  PRINT &quot;Function: f(x) = sin(x), Interval: [0, Ï€]&quot;
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>  PRINT &quot;Exact integral: I = 2.0&quot;
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>  PRINT &quot;-----------------------------------------------&quot;
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>  PRINT &quot;  N      h       I_trap      Error      Ratio&quot;
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>  PRINT &quot;-----------------------------------------------&quot;
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>  // 2. Test Multiple Grid Sizes
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>  SET N_values = [10, 20, 40, 80, 160]
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>  SET previous_error = NULL
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>  FOR each N in N_values DO:
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>      // 2a. Compute grid spacing
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>      SET h = (b - a) / N
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>      // 2b. Generate grid points
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>      SET x[i] = a + i * h  for i = 0 to N
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>      // 2c. Apply Extended Trapezoidal Rule
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>      SET I_trap = h * (0.5 * f(x[0]) + 0.5 * f(x[N]))
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>      FOR i FROM 1 TO N-1 DO:
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>          I_trap = I_trap + h * f(x[i])
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>      END FOR
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>      // 2d. Compute error
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>      SET error = ABS(I_exact - I_trap)
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>      // 2e. Compute error ratio (if not first iteration)
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>      IF previous_error IS NOT NULL THEN:
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>          SET error_ratio = previous_error / error
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>      ELSE:
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>          SET error_ratio = &quot;N/A&quot;
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>      END IF
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>      // 2f. Output results
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>      PRINT N, h, I_trap, error, error_ratio
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>      // 2g. Store error for next iteration
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>      SET previous_error = error
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>  END FOR
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>  PRINT &quot;-----------------------------------------------&quot;
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>  PRINT &quot;Expected: Error ratio â‰ˆ 4 (second-order convergence)&quot;
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_1"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Expected Results:</strong> For <span class="arithmatex">\(N = 10, 20, 40, 80, 160\)</span>, you should see:</li>
</ul>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(N\)</span></th>
<th><span class="arithmatex">\(h\)</span></th>
<th><span class="arithmatex">\(I_{\text{trap}}\)</span></th>
<th>Error</th>
<th>Ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>0.3142</td>
<td>1.9835</td>
<td>0.0165</td>
<td>N/A</td>
</tr>
<tr>
<td>20</td>
<td>0.1571</td>
<td>1.9959</td>
<td>0.0041</td>
<td>~4.0</td>
</tr>
<tr>
<td>40</td>
<td>0.0785</td>
<td>1.9990</td>
<td>0.0010</td>
<td>~4.0</td>
</tr>
<tr>
<td>80</td>
<td>0.0393</td>
<td>1.9997</td>
<td>0.00025</td>
<td>~4.0</td>
</tr>
<tr>
<td>160</td>
<td>0.0196</td>
<td>1.9999</td>
<td>0.000063</td>
<td>~4.0</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><strong>Verification:</strong> The error ratio of approximately <strong>4</strong> confirms that the Trapezoidal Rule is <strong>second-order accurate</strong> (<span class="arithmatex">\(O(h^2)\)</span>). Each halving of <span class="arithmatex">\(h\)</span> reduces the error by a factor of 4.</p>
</li>
<li>
<p><strong>Deviations:</strong> At very large <span class="arithmatex">\(N\)</span> (e.g., <span class="arithmatex">\(N &gt; 10^6\)</span>), you may observe deviations from the ideal factor of 4 due to <strong>round-off error</strong> dominating over truncation error. This is the same "V-plot" phenomenon from Chapter 5.</p>
</li>
<li>
<p><strong>Broader Lesson:</strong> This project demonstrates the empirical verification of <strong>convergence order</strong>, a critical concept in numerical analysis. By systematically refining the grid and measuring error reduction, we validate the theoretical predictions derived from Taylor series analysis.</p>
</li>
</ul>
<h2 class="heading-with-pill" id="63-the-better-tile-simpsons-rule">6.3 The "Better" Tile: Simpson's Rule</h2>
<blockquote>
<p><strong>Concept:</strong> Parabolic Interpolation for Superior Accuracy â€¢ <strong>Difficulty:</strong> â˜…â˜…â˜…â˜†â˜†</p>
<p><strong>Summary:</strong> Simpson's Rule uses parabolic (quadratic polynomial) tiles spanning two grid intervals, achieving fourth-order accuracy (<span class="arithmatex">\(O(h^4)\)</span>). This dramatic improvement over the Trapezoidal Rule makes it the preferred method for smooth functions on uniform grids.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_2">Theoretical Background</h3>
<p>The Trapezoidal Rule is robust but crudeâ€”its straight-line approximation systematically "cuts corners" when the function curves. <strong>Simpson's Rule</strong> addresses this limitation by using a <strong>smarter tile</strong>: a parabola (quadratic polynomial) that can bend to match the function's curvature.</p>
<h4 id="from-lines-to-parabolas">From Lines to Parabolas</h4>
<p><strong>Key Insight:</strong> A straight line is determined by <strong>two points</strong>, but a parabola requires <strong>three points</strong>. Therefore, a single Simpson's "tile" must span <strong>two grid intervals</strong>, using three consecutive data points: <span class="arithmatex">\((x_i, y_i)\)</span>, <span class="arithmatex">\((x_{i+1}, y_{i+1})\)</span>, and <span class="arithmatex">\((x_{i+2}, y_{i+2})\)</span>.</p>
<h4 id="derivation-of-the-simpsons-formula">Derivation of the Simpson's Formula</h4>
<p>Consider three equally-spaced points with spacing <span class="arithmatex">\(h\)</span>:
- Left point: <span class="arithmatex">\((x_0, y_0)\)</span>
- Middle point: <span class="arithmatex">\((x_1, y_1)\)</span> where <span class="arithmatex">\(x_1 = x_0 + h\)</span>
- Right point: <span class="arithmatex">\((x_2, y_2)\)</span> where <span class="arithmatex">\(x_2 = x_0 + 2h\)</span></p>
<p>The <strong>unique parabola</strong> <span class="arithmatex">\(P(x)\)</span> passing through these three points is a quadratic polynomial. The exact area under this parabola from <span class="arithmatex">\(x_0\)</span> to <span class="arithmatex">\(x_2\)</span> can be computed analytically:</p>
<div class="arithmatex">\[A = \int_{x_0}^{x_2} P(x) dx = \frac{h}{3}(y_0 + 4y_1 + y_2)\]</div>
<p>This is <strong>Simpson's &#8531; Rule</strong> for a single tile. The name comes from the <span class="arithmatex">\(h/3\)</span> factor.</p>
<p>Notice the <strong>1-4-2 weighting pattern</strong>:
- The two endpoints receive weight 1
- The middle point receives weight <strong>4</strong></p>
<p>This pattern arises from the exact integration of the parabolic interpolant.</p>
<h4 id="the-extended-simpsons-rule">The Extended Simpson's Rule</h4>
<p>To integrate over the entire domain <span class="arithmatex">\([x_0, x_N]\)</span>, we tile the region with overlapping parabolic segments. For this to work, we need an <strong>even number of intervals</strong> (i.e., <span class="arithmatex">\(N\)</span> must be even, giving us an <strong>odd number of data points</strong>).</p>
<p>The <strong>Extended Simpson's Rule</strong> is:</p>
<div class="arithmatex">\[I \approx \frac{h}{3} \left[ y_0 + 4y_1 + 2y_2 + 4y_3 + 2y_4 + \cdots + 2y_{N-2} + 4y_{N-1} + y_N \right]\]</div>
<p>The weighting pattern is <strong>1, 4, 2, 4, 2, ..., 4, 1</strong>:
- First and last points: weight 1
- Odd-indexed interior points: weight 4
- Even-indexed interior points (except endpoints): weight 2</p>
<h4 id="error-analysis-fourth-order-accuracy">Error Analysis: Fourth-Order Accuracy</h4>
<p>The power of Simpson's Rule comes from its <strong>fourth-order accuracy</strong>. Using Taylor series expansion, one can show that the local truncation error for a single tile is:</p>
<div class="arithmatex">\[\text{Error}_{\text{local}} = -\frac{h^5}{90} f^{(4)}(\xi)\]</div>
<p>When summed over all tiles, the <strong>global truncation error</strong> is:</p>
<div class="arithmatex">\[\text{Error}_{\text{total}} = O(h^4)\]</div>
<p><strong>This means:</strong>
- If we <strong>halve</strong> <span class="arithmatex">\(h\)</span> (double the number of points), the error decreases by a factor of <strong>sixteen</strong> (<span class="arithmatex">\(2^4 = 16\)</span>).
- Simpson's Rule is dramatically more accurate than the Trapezoidal Rule (<span class="arithmatex">\(O(h^2)\)</span>) for the same grid spacing.</p>
<h4 id="why-fourth-order">Why Fourth-Order?</h4>
<p>The magic comes from Taylor series cancellation. When we fit a parabola through three points and integrate, we automatically match the function's value, first derivative, <em>and</em> second derivative at the midpoint. This causes the <span class="arithmatex">\(O(h^3)\)</span> error term to vanish, leaving only <span class="arithmatex">\(O(h^4)\)</span> and higher terms.</p>
<h4 id="the-gotcha-even-intervals-required">The Gotcha: Even Intervals Required</h4>
<p><strong>Critical Limitation:</strong> Simpson's Rule requires an <strong>even number of intervals</strong> (odd number of points). If your data has an odd number of intervals, you must:
- Use Simpson's Rule for all but the last interval
- Handle the final interval with the Trapezoidal Rule
- Or, adjust your grid to have an even number of intervals</p>
<div class="section-divider"></div>

<h3 id="comprehension-check_2">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What geometric shape does Simpson's Rule use to approximate each "tile" of the integral?</strong></p>
<ul>
<li>A. A straight line (trapezoid)</li>
<li>B. A parabola (quadratic polynomial)</li>
<li>C. A cubic spline</li>
<li>D. A circle segment</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>Simpson's Rule fits a <strong>parabola</strong> (2<sup>nd</sup>-degree polynomial) through three consecutive data points. This parabolic interpolant can curve to match the function's shape, providing much better accuracy than the straight-line approximation of the Trapezoidal Rule.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. What is the characteristic weighting pattern for the Extended Simpson's Rule?</strong></p>
<ul>
<li>A. <span class="arithmatex">\(\frac{h}{2} [1, 2, 2, 2, \ldots, 2, 1]\)</span></li>
<li>B. <span class="arithmatex">\(h [1/2, 1, 1, 1, \ldots, 1, 1/2]\)</span></li>
<li>C. <span class="arithmatex">\(\frac{h}{3} [1, 4, 2, 4, 2, \ldots, 4, 1]\)</span></li>
<li>D. <span class="arithmatex">\(\frac{h}{3} [1, 4, 1, 4, 1, \ldots, 4, 1]\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p>The Extended Simpson's Rule has the signature <strong>1-4-2-4-2-...-4-1</strong> weighting pattern. The endpoints have weight 1, odd-indexed interior points have weight 4, and even-indexed interior points have weight 2. This pattern emerges from overlapping parabolic tiles and is preceded by the factor <span class="arithmatex">\(h/3\)</span>.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. If you double the number of grid points <span class="arithmatex">\(N\)</span> (halving <span class="arithmatex">\(h\)</span>) in Simpson's Rule, the truncation error decreases by a factor of:</strong></p>
<ul>
<li>A. 2</li>
<li>B. 4</li>
<li>C. 8</li>
<li>D. 16</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: D</strong></p>
<p>Simpson's Rule has <strong>fourth-order accuracy</strong> (<span class="arithmatex">\(O(h^4)\)</span>). Halving <span class="arithmatex">\(h\)</span> means the error scales as <span class="arithmatex">\((h/2)^4 = h^4/16\)</span>, which is <strong>sixteen times smaller</strong> than the original error. This is why Simpson's Rule is so powerful for smooth functionsâ€”it converges much faster than the Trapezoidal Rule's <span class="arithmatex">\(O(h^2)\)</span> convergence.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> Why would anyone ever use the Trapezoidal Rule if Simpson's Rule is so much more accurate (<span class="arithmatex">\(O(h^4)\)</span> vs <span class="arithmatex">\(O(h^2)\)</span>)? Hint: Think about the "gotcha" or simplicity of implementation.</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests your understanding of the trade-offs between accuracy and robustness in numerical methods.</p>
<ol>
<li>
<p><strong>The Even-Interval Requirement:</strong><br />
   Simpson's Rule has a structural constraint: it <strong>requires an even number of intervals</strong> (odd number of data points). If your experimental data happens to have 100 points, you cannot directly apply Simpson's Rule without modification. The Trapezoidal Rule has no such restrictionâ€”it works for any number of points.</p>
</li>
<li>
<p><strong>Simplicity and Robustness:</strong><br />
   The Trapezoidal Rule is conceptually simpler, easier to implement, and more robust to edge cases. For quick exploratory work or when implementing from scratch, the Trapezoidal Rule is often the first choice.</p>
</li>
<li>
<p><strong>Noisy Data:</strong><br />
   For extremely <strong>noisy</strong> or <strong>irregular</strong> data (common in experimental physics), the parabolic fits of Simpson's Rule can actually be counterproductive. Parabolas can "wiggle" to fit high-frequency noise, whereas the straight-line smoothing of the Trapezoidal Rule can be more stable.</p>
</li>
<li>
<p><strong>Non-Uniform Grids:</strong><br />
   The standard Simpson's Rule formula assumes <strong>uniform spacing</strong> <span class="arithmatex">\(h\)</span>. For non-uniform grids, the derivation becomes more complex, whereas the Trapezoidal Rule generalizes trivially: <span class="arithmatex">\(A_i = \frac{1}{2}(x_{i+1} - x_i)(y_i + y_{i+1})\)</span>.</p>
</li>
<li>
<p><strong>The Takeaway:</strong><br />
   Simpson's Rule is superior for <strong>smooth, well-behaved functions on uniform grids</strong> with the right number of points. But the Trapezoidal Rule remains the <strong>workhorse</strong> for many practical applications due to its universal applicability and simplicity.</p>
</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_2"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-oh2-vs-oh4-convergence-showdown"><strong>Project:</strong> <span class="arithmatex">\(O(h^2)\)</span> vs. <span class="arithmatex">\(O(h^4)\)</span> Convergence Showdown</h4>
<hr />
<h4 id="project-blueprint_2"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Implement both the Trapezoidal Rule and Simpson's Rule from scratch and visually compare their <strong>convergence rates</strong> using a log-log plot. This demonstrates the dramatic difference between second-order and fourth-order accuracy.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>The error of the Trapezoidal Rule scales as <span class="arithmatex">\(O(h^2)\)</span>, while Simpson's Rule scales as <span class="arithmatex">\(O(h^4)\)</span>. On a log-log plot of Error vs. <span class="arithmatex">\(N\)</span> (number of intervals), these should appear as straight lines with slopes of <span class="arithmatex">\(-2\)</span> and <span class="arithmatex">\(-4\)</span>, respectively.</td>
</tr>
<tr>
<td><strong>Test Function</strong></td>
<td>Use <span class="arithmatex">\(f(x) = \sin(x)\)</span> on the interval <span class="arithmatex">\([0, \pi]\)</span>. The exact integral is: <br> $<span class="arithmatex">\(I_{\text{exact}} = \int_0^{\pi} \sin(x) dx = 2\)</span>$</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Run both methods for a range of grid sizes: <span class="arithmatex">\(N = 10, 20, 40, 80, 160, 320, 640\)</span>. For each <span class="arithmatex">\(N\)</span>: <br> - Compute <span class="arithmatex">\(I_{\text{trap}}\)</span> and <span class="arithmatex">\(I_{\text{simp}}\)</span> <br> - Calculate absolute errors <br> - Plot <span class="arithmatex">\(\log(\text{Error})\)</span> vs. <span class="arithmatex">\(\log(N)\)</span> <br> Note: <span class="arithmatex">\(N\)</span> must be even for Simpson's Rule.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Implement the Extended Trapezoidal Rule. <br> 2. Implement the Extended Simpson's Rule. <br> 3. Loop over increasing (even) values of <span class="arithmatex">\(N\)</span>. <br> 4. Store errors for both methods. <br> 5. Create a log-log plot with reference lines showing slopes of <span class="arithmatex">\(-2\)</span> and <span class="arithmatex">\(-4\)</span>.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>The Trapezoidal error line should have slope <span class="arithmatex">\(-2\)</span> (error <span class="arithmatex">\(\propto N^{-2}\)</span>). The Simpson's error line should have slope <span class="arithmatex">\(-4\)</span> (error <span class="arithmatex">\(\propto N^{-4}\)</span>). Simpson's line will drop much more steeply, demonstrating the power of higher-order methods.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>N_values</code>: array of grid sizes (all even) <br> - <code>errors_trap</code>: array of Trapezoidal errors <br> - <code>errors_simp</code>: array of Simpson's errors <br> - <code>slopes</code>: fitted slopes from log-log data</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Visually confirm that Simpson's Rule achieves dramatically lower error for the same <span class="arithmatex">\(N\)</span>, and that the slopes match theoretical predictions (<span class="arithmatex">\(-2\)</span> and <span class="arithmatex">\(-4\)</span>).</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>A log-log plot with: <br> - Blue line: Trapezoidal Rule errors (slope <span class="arithmatex">\(\approx -2\)</span>) <br> - Red line: Simpson's Rule errors (slope <span class="arithmatex">\(\approx -4\)</span>) <br> - Reference lines showing theoretical slopes <br> - Legend and axis labels</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_2"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>BEGIN
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  // 1. Setup
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>  IMPORT numpy as np
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>  IMPORT matplotlib.pyplot as plt
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>  FUNCTION f(x):
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>      RETURN sin(x)
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>  END FUNCTION
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>  SET I_exact = 2.0
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>  SET a = 0.0
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>  SET b = Ï€
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>  // 2. Define Grid Sizes (must be even for Simpson&#39;s)
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>  SET N_values = [10, 20, 40, 80, 160, 320, 640]
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>  SET errors_trap = []
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>  SET errors_simp = []
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>  // 3. Compute Errors for Both Methods
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>  FOR each N in N_values DO:
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>      SET h = (b - a) / N
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>      SET x = [a + i*h for i in 0 to N]
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>      SET y = [f(xi) for xi in x]
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>      // 3a. Trapezoidal Rule
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>      SET I_trap = h * (0.5 * y[0] + sum(y[1:N]) + 0.5 * y[N])
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>      SET error_trap = ABS(I_exact - I_trap)
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>      APPEND error_trap to errors_trap
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>      // 3b. Simpson&#39;s Rule
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>      SET I_simp = (h / 3) * (y[0] + y[N])
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>      FOR i FROM 1 TO N-1 DO:
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>          IF i is odd THEN:
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>              I_simp = I_simp + (h / 3) * 4 * y[i]
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>          ELSE:
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>              I_simp = I_simp + (h / 3) * 2 * y[i]
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>          END IF
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>      END FOR
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>      SET error_simp = ABS(I_exact - I_simp)
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>      APPEND error_simp to errors_simp
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>  END FOR
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>  // 4. Create Log-Log Plot
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>  FIGURE
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>  PLOT log(N_values), log(errors_trap), label=&quot;Trapezoidal (O(hÂ²))&quot;, color=blue, marker=circle
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>  PLOT log(N_values), log(errors_simp), label=&quot;Simpson&#39;s (O(hâ´))&quot;, color=red, marker=square
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>  // 4a. Add Reference Lines
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>  SET N_ref = N_values[0]
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a>  SET E_ref_trap = errors_trap[0]
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>  SET E_ref_simp = errors_simp[0]
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a>
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a>  PLOT log(N_values), log(E_ref_trap * (N_ref / N_values)^2), 
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a>       linestyle=dashed, color=blue, label=&quot;Slope = -2&quot;
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a>  PLOT log(N_values), log(E_ref_simp * (N_ref / N_values)^4), 
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a>       linestyle=dashed, color=red, label=&quot;Slope = -4&quot;
</span><span id="__span-2-58"><a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a>
</span><span id="__span-2-59"><a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a>  // 4b. Labels and Formatting
</span><span id="__span-2-60"><a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a>  XLABEL &quot;log(N)&quot;
</span><span id="__span-2-61"><a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a>  YLABEL &quot;log(Error)&quot;
</span><span id="__span-2-62"><a id="__codelineno-2-62" name="__codelineno-2-62" href="#__codelineno-2-62"></a>  TITLE &quot;Convergence: Trapezoidal vs. Simpson&#39;s Rule&quot;
</span><span id="__span-2-63"><a id="__codelineno-2-63" name="__codelineno-2-63" href="#__codelineno-2-63"></a>  LEGEND
</span><span id="__span-2-64"><a id="__codelineno-2-64" name="__codelineno-2-64" href="#__codelineno-2-64"></a>  GRID ON
</span><span id="__span-2-65"><a id="__codelineno-2-65" name="__codelineno-2-65" href="#__codelineno-2-65"></a>  SHOW
</span><span id="__span-2-66"><a id="__codelineno-2-66" name="__codelineno-2-66" href="#__codelineno-2-66"></a>
</span><span id="__span-2-67"><a id="__codelineno-2-67" name="__codelineno-2-67" href="#__codelineno-2-67"></a>  // 5. Print Summary
</span><span id="__span-2-68"><a id="__codelineno-2-68" name="__codelineno-2-68" href="#__codelineno-2-68"></a>  PRINT &quot;===== Convergence Analysis =====&quot;
</span><span id="__span-2-69"><a id="__codelineno-2-69" name="__codelineno-2-69" href="#__codelineno-2-69"></a>  PRINT &quot;Function: sin(x), Interval: [0, Ï€]&quot;
</span><span id="__span-2-70"><a id="__codelineno-2-70" name="__codelineno-2-70" href="#__codelineno-2-70"></a>  PRINT &quot;Exact integral: 2.0&quot;
</span><span id="__span-2-71"><a id="__codelineno-2-71" name="__codelineno-2-71" href="#__codelineno-2-71"></a>  PRINT &quot;--------------------------------&quot;
</span><span id="__span-2-72"><a id="__codelineno-2-72" name="__codelineno-2-72" href="#__codelineno-2-72"></a>  PRINT &quot;At N = 640:&quot;
</span><span id="__span-2-73"><a id="__codelineno-2-73" name="__codelineno-2-73" href="#__codelineno-2-73"></a>  PRINT &quot;  Trapezoidal error:&quot;, errors_trap[-1]
</span><span id="__span-2-74"><a id="__codelineno-2-74" name="__codelineno-2-74" href="#__codelineno-2-74"></a>  PRINT &quot;  Simpson&#39;s error:  &quot;, errors_simp[-1]
</span><span id="__span-2-75"><a id="__codelineno-2-75" name="__codelineno-2-75" href="#__codelineno-2-75"></a>  PRINT &quot;  Improvement factor:&quot;, errors_trap[-1] / errors_simp[-1]
</span><span id="__span-2-76"><a id="__codelineno-2-76" name="__codelineno-2-76" href="#__codelineno-2-76"></a>
</span><span id="__span-2-77"><a id="__codelineno-2-77" name="__codelineno-2-77" href="#__codelineno-2-77"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_2"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Visual Result:</strong> The log-log plot will show two clear trends:</li>
<li>The <strong>Trapezoidal Rule</strong> (blue) follows a line with slope <span class="arithmatex">\(\approx -2\)</span>, confirming <span class="arithmatex">\(O(N^{-2}) = O(h^2)\)</span> convergence.</li>
<li>
<p><strong>Simpson's Rule</strong> (red) follows a much steeper line with slope <span class="arithmatex">\(\approx -4\)</span>, confirming <span class="arithmatex">\(O(N^{-4}) = O(h^4)\)</span> convergence.</p>
</li>
<li>
<p><strong>Quantitative Comparison:</strong> At <span class="arithmatex">\(N = 640\)</span>:</p>
</li>
<li>Trapezoidal error: <span class="arithmatex">\(\approx 10^{-5}\)</span></li>
<li>Simpson's error: <span class="arithmatex">\(\approx 10^{-11}\)</span></li>
<li>
<p><strong>Improvement factor: ~1 million times more accurate!</strong></p>
</li>
<li>
<p><strong>Practical Implications:</strong></p>
</li>
<li>For a target accuracy of <span class="arithmatex">\(10^{-8}\)</span>:<ul>
<li>Trapezoidal Rule requires <span class="arithmatex">\(N \approx 10^4\)</span> points</li>
<li>Simpson's Rule requires only <span class="arithmatex">\(N \approx 100\)</span> points</li>
</ul>
</li>
<li>
<p>This massive reduction in computational cost makes Simpson's Rule the clear winner for smooth functions.</p>
</li>
<li>
<p><strong>Limitations Observed:</strong></p>
</li>
<li>At very large <span class="arithmatex">\(N\)</span> (beyond <span class="arithmatex">\(10^6\)</span>), both methods may show deviations from ideal convergence due to <strong>round-off error</strong> accumulation.</li>
<li>
<p>For rough or noisy functions, Simpson's higher sensitivity to local variations can sometimes reduce its advantage.</p>
</li>
<li>
<p><strong>Broader Lesson:</strong> This project demonstrates why <strong>order of accuracy matters</strong>. The difference between <span class="arithmatex">\(O(h^2)\)</span> and <span class="arithmatex">\(O(h^4)\)</span> is not incrementalâ€”it's transformative. Higher-order methods achieve dramatic computational savings for smooth problems.</p>
</li>
</ul>
<h2 class="heading-with-pill" id="64-the-optimal-tile-gaussian-quadrature">6.4 The "Optimal" Tile: Gaussian Quadrature</h2>
<blockquote>
<p><strong>Concept:</strong> Optimal Sampling Points and Weights â€¢ <strong>Difficulty:</strong> â˜…â˜…â˜…â˜…â˜†</p>
<p><strong>Summary:</strong> Gaussian Quadrature achieves maximum polynomial accuracy by optimally choosing both the sample points <span class="arithmatex">\(x_i\)</span> and weights <span class="arithmatex">\(w_i\)</span>. With <span class="arithmatex">\(N\)</span> points, it perfectly integrates polynomials up to degree <span class="arithmatex">\(2N-1\)</span>, making it the most powerful method for smooth, callable functions.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_3">Theoretical Background</h3>
<p>Both the Trapezoidal Rule and Simpson's Rule use <strong>fixed, evenly-spaced grid points</strong>. Gaussian Quadrature asks a profound question: <em>What if we could choose where to sample the function and how much weight to give each sample to maximize accuracy?</em></p>
<h4 id="the-fundamental-idea">The Fundamental Idea</h4>
<p>Instead of forcing the grid to be uniform, Gaussian Quadrature uses the general weighted sum formula:</p>
<div class="arithmatex">\[I \approx \sum_{i=1}^{N} w_i f(x_i)\]</div>
<p>where:
- <span class="arithmatex">\(x_i\)</span> are the <strong>sample points</strong> (abscissas)
- <span class="arithmatex">\(w_i\)</span> are the <strong>weights</strong></p>
<p>For a fixed number of points <span class="arithmatex">\(N\)</span>, we have <span class="arithmatex">\(2N\)</span> free parameters (<span class="arithmatex">\(N\)</span> positions plus <span class="arithmatex">\(N\)</span> weights). The brilliant insight: we can use this freedom to make the formula <strong>exact</strong> for polynomials of degree up to <span class="arithmatex">\(2N - 1\)</span>.</p>
<p><strong>Examples:</strong>
- With <span class="arithmatex">\(N = 1\)</span> point: exact for polynomials up to degree 1 (linear)
- With <span class="arithmatex">\(N = 2\)</span> points: exact for polynomials up to degree 3 (cubic)
- With <span class="arithmatex">\(N = 3\)</span> points: exact for polynomials up to degree 5</p>
<p>This is dramatically more powerful than Simpson's Rule, which with 3 points is only exact for polynomials up to degree 2 (quadratic).</p>
<h4 id="the-mathematical-foundation-legendre-polynomials">The Mathematical Foundation: Legendre Polynomials</h4>
<p>The optimal sample points <span class="arithmatex">\(x_i\)</span> turn out to be the <strong>roots of Legendre polynomials</strong> <span class="arithmatex">\(P_N(x)\)</span>, which are orthogonal polynomials on the interval <span class="arithmatex">\([-1, 1]\)</span>.</p>
<p><strong>Legendre Polynomials (first few):</strong>
- <span class="arithmatex">\(P_0(x) = 1\)</span>
- <span class="arithmatex">\(P_1(x) = x\)</span>
- <span class="arithmatex">\(P_2(x) = \frac{1}{2}(3x^2 - 1)\)</span>
- <span class="arithmatex">\(P_3(x) = \frac{1}{2}(5x^3 - 3x)\)</span>
- <span class="arithmatex">\(P_4(x) = \frac{1}{8}(35x^4 - 30x^2 + 3)\)</span></p>
<p>The roots of <span class="arithmatex">\(P_N(x)\)</span> give the optimal <span class="arithmatex">\(N\)</span> sample points on <span class="arithmatex">\([-1, 1]\)</span>.</p>
<p><strong>Example:</strong> For <span class="arithmatex">\(N = 2\)</span> (Gauss-Legendre quadrature):
- Roots of <span class="arithmatex">\(P_2(x) = \frac{1}{2}(3x^2 - 1)\)</span> are <span class="arithmatex">\(x = \pm 1/\sqrt{3} \approx \pm 0.5774\)</span>
- Corresponding weights are both <span class="arithmatex">\(w = 1\)</span>
- The formula is: <span class="arithmatex">\(I \approx f(-1/\sqrt{3}) + f(1/\sqrt{3})\)</span></p>
<p>This simple two-point formula is <strong>exact</strong> for all polynomials up to degree 3!</p>
<h4 id="transforming-to-arbitrary-intervals">Transforming to Arbitrary Intervals</h4>
<p>The standard Gaussian quadrature is defined on <span class="arithmatex">\([-1, 1]\)</span>. To integrate over an arbitrary interval <span class="arithmatex">\([a, b]\)</span>, we use a change of variables:</p>
<div class="arithmatex">\[x = \frac{b - a}{2}t + \frac{a + b}{2}\]</div>
<p>where <span class="arithmatex">\(t \in [-1, 1]\)</span>. The integral transforms as:</p>
<div class="arithmatex">\[\int_a^b f(x) dx = \frac{b - a}{2} \int_{-1}^{1} f\left(\frac{b-a}{2}t + \frac{a+b}{2}\right) dt\]</div>
<h4 id="error-analysis">Error Analysis</h4>
<p>For smooth functions (not just polynomials), the error of <span class="arithmatex">\(N\)</span>-point Gaussian quadrature is:</p>
<div class="arithmatex">\[\text{Error} = \frac{(b-a)^{2N+1} (N!)^4}{(2N+1)[(2N)!]^3} f^{(2N)}(\xi)\]</div>
<p>For large <span class="arithmatex">\(N\)</span>, this error decreases <strong>exponentially fast</strong> for smooth functions, making Gaussian quadrature extraordinarily powerful.</p>
<h4 id="the-professional-tool-scipyintegratequad">The Professional Tool: <code>scipy.integrate.quad</code></h4>
<p>In practice, we access Gaussian quadrature through <strong><code>scipy.integrate.quad</code></strong>, which implements an adaptive, sophisticated version called <strong>Gauss-Kronrod quadrature</strong>:</p>
<p><strong>Features:</strong>
- Automatically chooses the number of points based on desired accuracy
- Provides an error estimate
- Handles singularities at endpoints gracefully
- <strong>Requires:</strong> A callable Python function <code>f(x)</code></p>
<p><strong>Limitation:</strong> Cannot be used with pre-existing grid dataâ€”it needs the freedom to evaluate <span class="arithmatex">\(f\)</span> at its chosen optimal points.</p>
<div class="section-divider"></div>

<h3 id="comprehension-check_3">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the "Aha! Moment" of Gaussian Quadrature?</strong></p>
<ul>
<li>A. It uses parabolic tiles for <span class="arithmatex">\(O(h^4)\)</span> accuracy</li>
<li>B. It optimally chooses both sample points <span class="arithmatex">\(x_i\)</span> and weights <span class="arithmatex">\(w_i\)</span> to maximize polynomial accuracy</li>
<li>C. It uses random sampling like Monte Carlo methods</li>
<li>D. It works only for grid-based data</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>Gaussian Quadrature breaks free from the constraint of fixed, uniform grids. By optimally choosing <strong>where</strong> to sample the function (<span class="arithmatex">\(x_i\)</span>) and <strong>how much</strong> to weight each sample (<span class="arithmatex">\(w_i\)</span>), it achieves the maximum possible polynomial accuracy for a given number of function evaluations. With <span class="arithmatex">\(N\)</span> points, it's exact for polynomials up to degree <span class="arithmatex">\(2N - 1\)</span>.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. With <span class="arithmatex">\(N = 3\)</span> Gaussian quadrature points, the method is exact for polynomials up to what degree?</strong></p>
<ul>
<li>A. Degree 2</li>
<li>B. Degree 3</li>
<li>C. Degree 5</li>
<li>D. Degree 6</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p>The general rule is that <span class="arithmatex">\(N\)</span>-point Gaussian quadrature is exact for polynomials up to degree <span class="arithmatex">\(2N - 1\)</span>. For <span class="arithmatex">\(N = 3\)</span>: <span class="arithmatex">\(2(3) - 1 = 5\)</span>. This is remarkableâ€”three carefully chosen points can exactly integrate a quintic polynomial, whereas Simpson's Rule (also using 3 points) only exactly integrates up to degree 2.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. You have a callable Python function <code>f(x)</code> and want the most accurate possible answer for <span class="arithmatex">\(\int_0^1 f(x) dx\)</span>. Which method should you use?</strong></p>
<ul>
<li>A. Manual implementation of Simpson's Rule</li>
<li>B. <code>scipy.integrate.trapezoid</code> on a uniform grid</li>
<li>C. <code>scipy.integrate.quad</code> (Gaussian Quadrature)</li>
<li>D. Monte Carlo integration</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p><code>scipy.integrate.quad</code> uses adaptive Gaussian quadrature (specifically Gauss-Kronrod), which is the gold standard for integrating smooth, callable functions. It automatically chooses optimal sample points, adapts to the function's behavior, and provides an error estimate. For a callable function (not pre-gridded data), this is always the best choice.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> I have a fixed grid of experimental data in a NumPy array. Why is <code>scipy.integrate.quad</code> the <em>wrong</em> tool to use, even though it's the most powerful 1D integrator?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests your understanding of the fundamental difference between grid-based and function-based quadrature methods.</p>
<ol>
<li>
<p><strong>The Core Issue: Function Evaluation Freedom</strong><br />
<code>scipy.integrate.quad</code> uses Gaussian quadrature, which requires the ability to evaluate the function <span class="arithmatex">\(f(x)\)</span> at <strong>arbitrary, optimally chosen points</strong> <span class="arithmatex">\(x_i\)</span>. These points are the roots of Legendre polynomials and are <strong>not</strong> evenly spaced.</p>
</li>
<li>
<p><strong>Fixed Grid Constraint:</strong><br />
   When you have experimental data in a NumPy array, your <span class="arithmatex">\(x\)</span>-coordinates are <strong>already locked in</strong>. You measured the function at specific, predetermined locations (e.g., <span class="arithmatex">\(x = 0.0, 0.1, 0.2, \ldots, 1.0\)</span>). You cannot "re-measure" the function at the optimal Gaussian points like <span class="arithmatex">\(x = 0.1127, 0.5, 0.8873\)</span>.</p>
</li>
<li>
<p><strong>Type Mismatch:</strong><br />
<code>quad</code> expects a <strong>callable function</strong> <code>def f(x): ...</code> as input, not an array of pre-computed values. You could try to create an interpolating function from your data, but this adds complexity and potential interpolation error.</p>
</li>
<li>
<p><strong>The Right Tool for the Job:</strong><br />
   For fixed-grid data, you must use grid-based methods like:</p>
</li>
<li><code>scipy.integrate.trapezoid(y, x)</code> for Trapezoidal Rule</li>
<li><code>scipy.integrate.simpson(y, x)</code> for Simpson's Rule</li>
</ol>
<p>These methods work with your existing <span class="arithmatex">\((x_i, y_i)\)</span> pairs without requiring additional function evaluations.</p>
<ol>
<li><strong>The Broader Principle:</strong><br />
   The choice of integration method depends fundamentally on your <strong>data format</strong>:</li>
<li><strong>Callable function</strong> â†’ Use Gaussian quadrature (<code>quad</code>)</li>
<li><strong>Fixed grid data</strong> â†’ Use grid-based methods (Simpson's, Trapezoidal)</li>
<li><strong>High-dimensional</strong> or <strong>noisy</strong> â†’ Consider Monte Carlo</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_3"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-quantum-mechanicsnormalizing-a-wavefunction"><strong>Project:</strong> Quantum Mechanicsâ€”Normalizing a Wavefunction</h4>
<hr />
<h4 id="project-blueprint_3"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Use Gaussian quadrature to compute the normalization constant <span class="arithmatex">\(A\)</span> for a quantum mechanical wavefunction, demonstrating the power of optimal sampling for smooth, oscillatory functions.</td>
</tr>
<tr>
<td><strong>Physical Context</strong></td>
<td>In quantum mechanics, the probability density <span class="arithmatex">\(\lvert\psi(x)\rvert^2\)</span> must integrate to 1 over all space (or the confining region). For a particle in a box of length <span class="arithmatex">\(L\)</span>, a trial wavefunction might be: <br> $<span class="arithmatex">\(\psi(x) = A \cos\left(\frac{\pi x}{L}\right)\)</span>$ for <span class="arithmatex">\(x \in [-L/2, L/2]\)</span>.</td>
</tr>
<tr>
<td><strong>Mathematical Problem</strong></td>
<td>Find the normalization constant <span class="arithmatex">\(A\)</span> such that: <br> $<span class="arithmatex">\(\int_{-L/2}^{L/2} \lvert\psi(x)\rvert^2 dx = 1\)</span>$ <br> This requires computing: <br> $<span class="arithmatex">\(I = \int_{-L/2}^{L/2} \cos^2\left(\frac{\pi x}{L}\right) dx\)</span>$ <br> Then <span class="arithmatex">\(A = 1/\sqrt{I}\)</span>.</td>
</tr>
<tr>
<td><strong>Analytical Solution</strong></td>
<td>Using the trig identity <span class="arithmatex">\(\cos^2(\theta) = \frac{1}{2}(1 + \cos(2\theta))\)</span>: <br> $<span class="arithmatex">\(I = \int_{-L/2}^{L/2} \frac{1}{2}\left[1 + \cos\left(\frac{2\pi x}{L}\right)\right] dx = \frac{L}{2}\)</span>$ <br> Therefore, <span class="arithmatex">\(A = \sqrt{2/L}\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Use <code>scipy.integrate.quad</code> to compute <span class="arithmatex">\(I\)</span> numerically. Set <span class="arithmatex">\(L = 1.0\)</span> m. Compare the numerical result to the analytical value <span class="arithmatex">\(I = 0.5\)</span> and verify <span class="arithmatex">\(A \approx \sqrt{2} \approx 1.414\)</span>.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define the integrand <span class="arithmatex">\(f(x) = \cos^2(\pi x / L)\)</span>. <br> 2. Call <code>scipy.integrate.quad(f, -L/2, L/2)</code>. <br> 3. Extract the integral value <span class="arithmatex">\(I\)</span> and error estimate. <br> 4. Compute <span class="arithmatex">\(A = 1/\sqrt{I}\)</span>. <br> 5. Compare to analytical solution.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td><code>quad</code> should return <span class="arithmatex">\(I \approx 0.5\)</span> with an error estimate near machine precision (<span class="arithmatex">\(\sim 10^{-14}\)</span>), demonstrating the power of Gaussian quadrature for smooth functions.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>L</code>: box length (m) <br> - <code>I_numerical</code>: computed integral <br> - <code>I_exact</code>: analytical value (0.5) <br> - <code>A_numerical</code>: computed normalization constant <br> - <code>A_exact</code>: analytical value (<span class="arithmatex">\(\sqrt{2}\)</span>) <br> - <code>error_estimate</code>: from <code>quad</code></td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm that the numerical normalization constant matches <span class="arithmatex">\(\sqrt{2/L}\)</span> to within the error estimate, validating both the method and the analytical calculation.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Print the integral value, error estimate, normalization constant, and comparison to analytical solution.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_3"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>BEGIN
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>  // 1. Physical Parameters
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  SET L = 1.0  // meters (box length)
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>  // 2. Define the Integrand
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>  FUNCTION integrand(x):
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>      RETURN cos(Ï€ * x / L)^2
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>  END FUNCTION
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>  // 3. Analytical Solution (for verification)
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>  SET I_exact = L / 2
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>  SET A_exact = sqrt(2 / L)
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>  // 4. Numerical Integration using Gaussian Quadrature
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>  SET lower_limit = -L / 2
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>  SET upper_limit = L / 2
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>  // Call scipy.integrate.quad (returns [result, error_estimate])
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>  SET [I_numerical, error_estimate] = quad(integrand, lower_limit, upper_limit)
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>  // 5. Compute Normalization Constant
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>  SET A_numerical = 1 / sqrt(I_numerical)
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>  // 6. Output Results
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>  PRINT &quot;===== Quantum Wavefunction Normalization =====&quot;
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>  PRINT &quot;Box length L:&quot;, L, &quot;m&quot;
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>  PRINT &quot;Wavefunction: Ïˆ(x) = A cos(Ï€x/L)&quot;
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>  PRINT &quot;----------------------------------------------&quot;
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>  PRINT &quot;Integral Computation:&quot;
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>  PRINT &quot;  Numerical result:&quot;, I_numerical
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>  PRINT &quot;  Analytical result:&quot;, I_exact
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>  PRINT &quot;  Absolute error:&quot;, ABS(I_numerical - I_exact)
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>  PRINT &quot;  Error estimate from quad:&quot;, error_estimate
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>  PRINT &quot;----------------------------------------------&quot;
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>  PRINT &quot;Normalization Constant:&quot;
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>  PRINT &quot;  A (numerical):&quot;, A_numerical
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a>  PRINT &quot;  A (exact):&quot;, A_exact
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>  PRINT &quot;  Relative error:&quot;, ABS(A_numerical - A_exact) / A_exact
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>  PRINT &quot;----------------------------------------------&quot;
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a>  // 7. Verification
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a>  IF ABS(I_numerical - I_exact) &lt; 1e-10 THEN:
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a>      PRINT &quot;âœ“ Integral matches analytical solution to machine precision&quot;
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a>  ELSE:
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a>      PRINT &quot;âœ— Warning: Numerical integral deviates from expected value&quot;
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a>  END IF
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a>  IF ABS(A_numerical - A_exact) / A_exact &lt; 1e-10 THEN:
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a>      PRINT &quot;âœ“ Normalization constant verified&quot;
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a>  ELSE:
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>      PRINT &quot;âœ— Warning: Normalization constant error exceeds tolerance&quot;
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a>  END IF
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a>  // 8. Physical Interpretation
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a>  PRINT &quot;----------------------------------------------&quot;
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a>  PRINT &quot;Physical Interpretation:&quot;
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a>  PRINT &quot;The wavefunction Ïˆ(x) = âˆš(2/L) cos(Ï€x/L) represents&quot;
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a>  PRINT &quot;the ground state of a particle in a symmetric box.&quot;
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a>  PRINT &quot;The normalization ensures âˆ«|Ïˆ|Â² dx = 1, meaning the&quot;
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a>  PRINT &quot;particle has 100% probability of being found somewhere.&quot;
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_3"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Numerical Accuracy:</strong> <code>scipy.integrate.quad</code> should return:</li>
<li><span class="arithmatex">\(I_{\text{numerical}} \approx 0.5\)</span> (within <span class="arithmatex">\(\sim 10^{-14}\)</span> of the exact value)</li>
<li>Error estimate <span class="arithmatex">\(\approx 10^{-14}\)</span> (near machine precision)</li>
<li>
<p><span class="arithmatex">\(A_{\text{numerical}} \approx 1.414213562373095\)</span> (matches <span class="arithmatex">\(\sqrt{2}\)</span> exactly)</p>
</li>
<li>
<p><strong>Why Gaussian Quadrature Excels Here:</strong></p>
</li>
<li>The integrand <span class="arithmatex">\(\cos^2(\pi x/L)\)</span> is <strong>smooth</strong> and <strong>periodic</strong>â€”ideal for polynomial approximation.</li>
<li>Gaussian quadrature exploits this smoothness to achieve exponential convergence.</li>
<li>
<p>The adaptive algorithm automatically detects that few points are needed for this well-behaved function.</p>
</li>
<li>
<p><strong>Comparison to Grid-Based Methods:</strong></p>
</li>
<li>To achieve comparable accuracy with Simpson's Rule, you'd need hundreds or thousands of grid points.</li>
<li>
<p>Gaussian quadrature achieves machine precision with perhaps 10-20 optimally placed function evaluations.</p>
</li>
<li>
<p><strong>Physical Significance:</strong></p>
</li>
<li>The normalization constant <span class="arithmatex">\(A = \sqrt{2/L}\)</span> ensures that the total probability is exactly 1.</li>
<li>This demonstrates how integration is essential for enforcing physical constraints in quantum mechanics.</li>
<li>
<p>The result <span class="arithmatex">\(A \propto 1/\sqrt{L}\)</span> shows that the wavefunction amplitude <strong>decreases</strong> as the box size increases (to maintain unit probability over a larger region).</p>
</li>
<li>
<p><strong>Broader Lesson:</strong> This project illustrates the power of <strong>adaptive, function-based integration</strong> for smooth problems. When you have analytic control over the integrand, Gaussian quadrature is unbeatable for efficiency and accuracy.</p>
</li>
</ul>
<h2 class="heading-with-pill" id="65-handling-the-hard-stuff-tricky-integrals">6.5 Handling the "Hard Stuff": Tricky Integrals</h2>
<blockquote>
<p><strong>Concept:</strong> Change of Variables to Tame Singularities and Infinite Limits â€¢ <strong>Difficulty:</strong> â˜…â˜…â˜…â˜†â˜†</p>
<p><strong>Summary:</strong> Integrals with infinite limits or singularities cannot be directly evaluated using standard numerical methods. The solution is a <strong>change of variables</strong> that transforms the problematic integral into a well-behaved, finite domain suitable for quadrature.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_4">Theoretical Background</h3>
<p>Numerical integration methods are designed for <strong>finite, well-behaved</strong> integrals. They fail catastrophically when confronted with two common pathological cases:</p>
<ol>
<li><strong>Infinite Limits:</strong> Integrals like <span class="arithmatex">\(\int_0^\infty e^{-x} dx\)</span></li>
<li><strong>Singularities:</strong> Integrals like <span class="arithmatex">\(\int_0^1 \frac{1}{\sqrt{x}} dx\)</span> where the integrand diverges</li>
</ol>
<p>The solution comes from a classical calculus technique: <strong>change of variables</strong> (also called substitution). By carefully choosing a new variable, we can transform these "impossible" integrals into "safe" ones.</p>
<h4 id="problem-1-infinite-limits">Problem 1: Infinite Limits</h4>
<p><strong>The Challenge:</strong> How do we integrate from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(\infty\)</span> when our grid can only have finitely many points?</p>
<p><strong>Example:</strong> Consider <span class="arithmatex">\(\int_0^\infty e^{-x} dx = 1\)</span> (known analytically).</p>
<p><strong>The Fix: Compactification</strong></p>
<p>We use a substitution that <strong>maps the infinite interval</strong> <span class="arithmatex">\([0, \infty)\)</span> onto a <strong>finite interval</strong> like <span class="arithmatex">\([0, 1]\)</span>.</p>
<p><strong>Standard Transformation:</strong>
$<span class="arithmatex">\(t = \frac{1}{1 + x} \quad \Rightarrow \quad x = \frac{1 - t}{t}\)</span>$</p>
<p><strong>Deriving the transformed integral:</strong></p>
<ol>
<li><strong>New limits:</strong></li>
<li>When <span class="arithmatex">\(x = 0\)</span>: <span class="arithmatex">\(t = 1/(1+0) = 1\)</span></li>
<li>
<p>When <span class="arithmatex">\(x \to \infty\)</span>: <span class="arithmatex">\(t = 1/(\infty) = 0\)</span></p>
</li>
<li>
<p><strong>Differential transformation:</strong>
   $<span class="arithmatex">\(x = \frac{1-t}{t} \quad \Rightarrow \quad dx = -\frac{1}{t^2} dt\)</span>$</p>
</li>
<li>
<p><strong>Substitute into the integral:</strong>
   $<span class="arithmatex">\(\int_0^\infty e^{-x} dx = \int_1^0 e^{-(1-t)/t} \left(-\frac{1}{t^2}\right) dt\)</span>$</p>
</li>
<li>
<p><strong>Flip limits (absorbing the negative sign):</strong>
   $<span class="arithmatex">\(= \int_0^1 \frac{1}{t^2} e^{-(1-t)/t} dt\)</span>$</p>
</li>
</ol>
<p>This is now a <strong>finite integral</strong> from 0 to 1 with a well-behaved integrand (no singularity at <span class="arithmatex">\(t=0\)</span> because the exponential decays faster than <span class="arithmatex">\(1/t^2\)</span> grows).</p>
<p><strong>Alternative Transformations:</strong>
- <span class="arithmatex">\(t = e^{-x}\)</span> (maps <span class="arithmatex">\([0, \infty) \to (0, 1]\)</span>)
- <span class="arithmatex">\(t = \arctan(x)\)</span> (maps <span class="arithmatex">\((-\infty, \infty) \to (-\pi/2, \pi/2)\)</span>)
- <span class="arithmatex">\(x = \tan(t)\)</span> (inverse of above)</p>
<h4 id="problem-2-singularities">Problem 2: Singularities</h4>
<p><strong>The Challenge:</strong> The integrand blows up at a point in the integration domain.</p>
<p><strong>Example:</strong> <span class="arithmatex">\(\int_0^1 \frac{1}{\sqrt{x}} dx = 2\)</span> (analytically).</p>
<p>At <span class="arithmatex">\(x = 0\)</span>, the integrand <span class="arithmatex">\(\frac{1}{\sqrt{x}} \to \infty\)</span>, which would cause division by zero in a numerical grid.</p>
<p><strong>The Fix: Singularity Removal</strong></p>
<p>We choose a substitution that <strong>cancels the singularity</strong>.</p>
<p><strong>Transformation:</strong>
$<span class="arithmatex">\(x = t^2 \quad \Rightarrow \quad dx = 2t \, dt\)</span>$</p>
<p><strong>Deriving the transformed integral:</strong></p>
<ol>
<li><strong>New limits:</strong></li>
<li>When <span class="arithmatex">\(x = 0\)</span>: <span class="arithmatex">\(t = 0\)</span></li>
<li>
<p>When <span class="arithmatex">\(x = 1\)</span>: <span class="arithmatex">\(t = 1\)</span></p>
</li>
<li>
<p><strong>Substitute into the integral:</strong>
   $<span class="arithmatex">\(\int_0^1 \frac{1}{\sqrt{x}} dx = \int_0^1 \frac{1}{\sqrt{t^2}} \cdot 2t \, dt = \int_0^1 \frac{1}{t} \cdot 2t \, dt = \int_0^1 2 \, dt = 2\)</span>$</p>
</li>
</ol>
<p>The <span class="arithmatex">\(1/t\)</span> term from the singularity <strong>exactly cancels</strong> with the <span class="arithmatex">\(t\)</span> from the Jacobian <span class="arithmatex">\(dx = 2t \, dt\)</span>, leaving a trivial constant integrand!</p>
<p><strong>General Strategy:</strong>
- For singularities like <span class="arithmatex">\(x^{-\alpha}\)</span> near <span class="arithmatex">\(x = 0\)</span>, use <span class="arithmatex">\(x = t^{1/\beta}\)</span> where <span class="arithmatex">\(\beta &gt; \alpha\)</span>.
- For singularities at <span class="arithmatex">\(x = a\)</span>, use <span class="arithmatex">\((x - a)^n\)</span> substitutions.</p>
<h4 id="the-professional-approach">The Professional Approach</h4>
<p>Modern libraries like <code>scipy.integrate.quad</code> have <strong>built-in handling</strong> for infinite limits and endpoint singularities:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Infinite upper limit</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># Singularity at lower endpoint</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<p>These functions detect the special cases and automatically apply appropriate transformations internally.</p>
<div class="section-divider"></div>

<h3 id="comprehension-check_4">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. How do we "tame" an integral with an infinite limit, like <span class="arithmatex">\(\int_0^\infty f(x) dx\)</span>?</strong></p>
<ul>
<li>A. Use Monte Carlo, which handles infinity automatically</li>
<li>B. Use a change of variables (e.g., <span class="arithmatex">\(t = 1/(1+x)\)</span>) to map the infinite domain to a finite one</li>
<li>C. Integrate to a "very large number" (e.g., <span class="arithmatex">\(10^{10}\)</span>) and hope it's correct</li>
<li>D. Use Simpson's Rule with an infinite number of slices</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>The mathematically rigorous approach is a <strong>change of variables</strong> that <strong>compactifies</strong> the infinite interval onto a finite one. For example, <span class="arithmatex">\(t = 1/(1+x)\)</span> maps <span class="arithmatex">\([0, \infty)\)</span> onto <span class="arithmatex">\((0, 1]\)</span>. This transforms the integral into standard form that any quadrature method can handle. Simply integrating to a "large number" is unreliableâ€”you never know how large is large enough.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. How do we "tame" an integral with a singularity, like <span class="arithmatex">\(\int_0^1 \frac{1}{\sqrt{x}} dx\)</span>?</strong></p>
<ul>
<li>A. Start the integral just after the singularity, e.g., <span class="arithmatex">\(\int_{0.0001}^1\)</span></li>
<li>B. Use a change of variables (e.g., <span class="arithmatex">\(x = t^2\)</span>) chosen to cancel the singularity</li>
<li>C. Use the Trapezoidal Rule, which is not affected by singularities</li>
<li>D. This integral is unsolvable and must be approximated</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>The key is choosing a substitution that <strong>cancels the singular behavior</strong>. For <span class="arithmatex">\(\int_0^1 x^{-1/2} dx\)</span>, the substitution <span class="arithmatex">\(x = t^2\)</span> (so <span class="arithmatex">\(dx = 2t \, dt\)</span>) transforms the integral to <span class="arithmatex">\(\int_0^1 \frac{1}{t} \cdot 2t \, dt = \int_0^1 2 \, dt\)</span>. The <span class="arithmatex">\(1/t\)</span> singularity exactly cancels with the <span class="arithmatex">\(t\)</span> from the Jacobian, leaving a constant integrand. Starting "just after" the singularity is a crude workaround that introduces systematic error.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. For the integral <span class="arithmatex">\(\int_0^\infty e^{-x^2} dx\)</span>, which transformation maps it to a finite interval?</strong></p>
<ul>
<li>A. <span class="arithmatex">\(t = x^2\)</span></li>
<li>B. <span class="arithmatex">\(t = 1/(1+x)\)</span></li>
<li>C. <span class="arithmatex">\(t = e^{-x}\)</span></li>
<li>D. <span class="arithmatex">\(t = \ln(x)\)</span></li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>The substitution <span class="arithmatex">\(t = 1/(1+x)\)</span> maps <span class="arithmatex">\(x \in [0, \infty)\)</span> to <span class="arithmatex">\(t \in (0, 1]\)</span>. From <span class="arithmatex">\(t = 1/(1+x)\)</span>, we get <span class="arithmatex">\(x = (1-t)/t\)</span> and <span class="arithmatex">\(dx = -1/t^2 \, dt\)</span>. This transforms the infinite integral into a finite one that can be evaluated with standard quadrature. Options A and D don't compactify to a finite interval, and option C maps to <span class="arithmatex">\((0, 1]\)</span> but is less straightforward for this particular integrand.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> You need to solve <span class="arithmatex">\(\int_0^\infty e^{-x} dx\)</span> numerically. Walk me through the complete process of transforming this into a "safe" integral using the substitution <span class="arithmatex">\(t = 1/(1+x)\)</span>.</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests your ability to execute a complete change of variables, a fundamental skill for handling pathological integrals.</p>
<ol>
<li>
<p><strong>Define the Substitution:</strong><br />
   Start with <span class="arithmatex">\(t = \frac{1}{1+x}\)</span>. We need to express <span class="arithmatex">\(x\)</span> in terms of <span class="arithmatex">\(t\)</span> and find <span class="arithmatex">\(dx\)</span>.</p>
</li>
<li>
<p><strong>Invert the Relationship:</strong><br />
   Solving for <span class="arithmatex">\(x\)</span>:
   $<span class="arithmatex">\(t(1+x) = 1 \quad \Rightarrow \quad t + tx = 1 \quad \Rightarrow \quad x = \frac{1-t}{t}\)</span>$</p>
</li>
<li>
<p><strong>Transform the Limits:</strong>  </p>
</li>
<li>When <span class="arithmatex">\(x = 0\)</span>: <span class="arithmatex">\(t = 1/(1+0) = 1\)</span></li>
<li>
<p>When <span class="arithmatex">\(x \to \infty\)</span>: <span class="arithmatex">\(t = 1/(\infty) \to 0\)</span></p>
</li>
<li>
<p><strong>Compute the Differential:</strong><br />
   Differentiate <span class="arithmatex">\(x = (1-t)/t = 1/t - 1\)</span>:
   $<span class="arithmatex">\(dx = -\frac{1}{t^2} dt\)</span>$</p>
</li>
<li>
<p><strong>Substitute into the Original Integral:</strong><br />
   $<span class="arithmatex">\(\int_0^\infty e^{-x} dx = \int_1^0 e^{-(1-t)/t} \left(-\frac{1}{t^2}\right) dt\)</span>$</p>
</li>
<li>
<p><strong>Flip the Limits:</strong><br />
   The negative sign from <span class="arithmatex">\(dx\)</span> flips the integration limits:
   $<span class="arithmatex">\(= \int_0^1 \frac{1}{t^2} e^{-(1-t)/t} dt\)</span>$</p>
</li>
<li>
<p><strong>Final Result:</strong><br />
   This is now a <strong>finite integral</strong> from 0 to 1 with an integrand that is well-behaved (no singularities, finite limits). Any standard quadrature method (Simpson's, Gaussian, etc.) can now be applied.</p>
</li>
<li>
<p><strong>Implementation Detail:</strong><br />
   In Python:
   <div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">transformed_integrand</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">t</span><span class="p">)</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">result</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">transformed_integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div></p>
</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_4"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-taming-the-gaussian-integral"><strong>Project:</strong> Taming the Gaussian Integral</h4>
<hr />
<h4 id="project-blueprint_4"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Numerically verify the famous Gaussian integral <span class="arithmatex">\(\int_0^\infty e^{-x^2} dx = \frac{\sqrt{\pi}}{2}\)</span> using a change of variables to map the infinite domain to <span class="arithmatex">\([0, 1]\)</span>.</td>
</tr>
<tr>
<td><strong>Mathematical Context</strong></td>
<td>The Gaussian integral is fundamental in probability theory, quantum mechanics, and statistical mechanics. Its exact value <span class="arithmatex">\(\sqrt{\pi}/2 \approx 0.8862269254527580\)</span> provides a perfect test case for our transformation technique.</td>
</tr>
<tr>
<td><strong>The Challenge</strong></td>
<td>Direct numerical integration from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(\infty\)</span> is impossible. We must transform the integral to a finite domain.</td>
</tr>
<tr>
<td><strong>Transformation</strong></td>
<td>Use the substitution <span class="arithmatex">\(t = 1/(1+x)\)</span>, which gives: <br> - <span class="arithmatex">\(x = (1-t)/t\)</span> <br> - <span class="arithmatex">\(dx = -1/t^2 \, dt\)</span> <br> - Limits: <span class="arithmatex">\(x \in [0, \infty) \to t \in (0, 1]\)</span></td>
</tr>
<tr>
<td><strong>Transformed Integral</strong></td>
<td>$<span class="arithmatex">\(\int_0^\infty e^{-x^2} dx = \int_0^1 \frac{1}{t^2} \exp\left[-\left(\frac{1-t}{t}\right)^2\right] dt\)</span>$</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Implement the transformed integrand as a Python function and integrate using <code>scipy.integrate.quad</code>. Compare to the analytical result <span class="arithmatex">\(\sqrt{\pi}/2\)</span>.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Define the transformed integrand <span class="arithmatex">\(f(t)\)</span>. <br> 2. Call <code>quad(f, 0, 1)</code> to compute the numerical result. <br> 3. Compare to <span class="arithmatex">\(\sqrt{\pi}/2\)</span>. <br> 4. Report absolute and relative errors.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>The numerical result should match the analytical value to within machine precision (<span class="arithmatex">\(\sim 10^{-14}\)</span> relative error), demonstrating that the transformation successfully tamed the infinite domain.</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>I_numerical</code>: result from <code>quad</code> <br> - <code>I_exact</code>: <span class="arithmatex">\(\sqrt{\pi}/2\)</span> <br> - <code>error_estimate</code>: from <code>quad</code> <br> - <code>abs_error</code>: <span class="arithmatex">\(\lvert I_{\text{numerical}} - I_{\text{exact}} \rvert\)</span> <br> - <code>rel_error</code>: absolute error divided by <span class="arithmatex">\(I_{\text{exact}}\)</span></td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm that: <br> 1. The transformation eliminates the infinite limit. <br> 2. The numerical result achieves high accuracy (relative error <span class="arithmatex">\(&lt; 10^{-10}\)</span>). <br> 3. The error estimate from <code>quad</code> is reliable.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Print the numerical integral, analytical result, errors, and verification status.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_4"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>BEGIN
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>  // 1. Import Necessary Libraries
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>  IMPORT numpy as np
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>  IMPORT scipy.integrate as integrate
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>  // 2. Analytical Solution
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>  SET I_exact = sqrt(Ï€) / 2  // â‰ˆ 0.8862269254527580
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>  // 3. Define the Transformed Integrand
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>  // Original: âˆ«â‚€^âˆž e^(-xÂ²) dx
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>  // After t = 1/(1+x): âˆ«â‚€Â¹ (1/tÂ²) exp[-((1-t)/t)Â²] dt
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>  FUNCTION transformed_integrand(t):
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>      // Compute x = (1-t)/t
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>      SET x = (1 - t) / t
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>      // Compute the integrand value
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>      SET integrand_value = (1 / t^2) * exp(-x^2)
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>      RETURN integrand_value
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>  END FUNCTION
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>  // 4. Perform Numerical Integration
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>  PRINT &quot;===== Gaussian Integral: Infinite to Finite Transformation =====&quot;
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>  PRINT &quot;Original integral: âˆ«â‚€^âˆž e^(-xÂ²) dx&quot;
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>  PRINT &quot;Exact value: âˆšÏ€/2 â‰ˆ&quot;, I_exact
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>  PRINT &quot;--------------------------------------------------------------&quot;
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>  // Call quad with the transformed integrand
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>  SET [I_numerical, error_estimate] = integrate.quad(transformed_integrand, 0, 1)
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>  // 5. Compute Errors
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>  SET abs_error = ABS(I_numerical - I_exact)
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>  SET rel_error = abs_error / I_exact
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>  // 6. Output Results
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>  PRINT &quot;Transformed integral: âˆ«â‚€Â¹ (1/tÂ²) exp[-((1-t)/t)Â²] dt&quot;
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>  PRINT &quot;--------------------------------------------------------------&quot;
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>  PRINT &quot;Numerical result:&quot;, I_numerical
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>  PRINT &quot;Error estimate (from quad):&quot;, error_estimate
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>  PRINT &quot;--------------------------------------------------------------&quot;
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>  PRINT &quot;Verification:&quot;
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>  PRINT &quot;  Absolute error:&quot;, abs_error
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>  PRINT &quot;  Relative error:&quot;, rel_error
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>  PRINT &quot;--------------------------------------------------------------&quot;
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>  // 7. Verification Checks
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>  IF abs_error &lt; 1e-10 THEN:
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>      PRINT &quot;âœ“ Numerical result matches analytical value&quot;
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>  ELSE:
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>      PRINT &quot;âœ— Warning: Error exceeds tolerance&quot;
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>  END IF
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>  IF error_estimate &lt; 1e-10 THEN:
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>      PRINT &quot;âœ“ Integration achieved high precision&quot;
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>  ELSE:
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a>      PRINT &quot;âš  Integration precision is moderate&quot;
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a>  END IF
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a>
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a>  // 8. Educational Notes
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a>  PRINT &quot;--------------------------------------------------------------&quot;
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a>  PRINT &quot;Key Insight:&quot;
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a>  PRINT &quot;The substitution t = 1/(1+x) transformed an INFINITE domain&quot;
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a>  PRINT &quot;[0, âˆž) into a FINITE domain (0, 1], making the integral&quot;
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a>  PRINT &quot;computationally feasible. This is the power of change of&quot;
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a>  PRINT &quot;variablesâ€”turning impossible problems into routine ones.&quot;
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a>
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_4"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Expected Results:</strong></li>
<li>Numerical value: <span class="arithmatex">\(I_{\text{numerical}} \approx 0.886226925452758\)</span></li>
<li>Exact value: <span class="arithmatex">\(\sqrt{\pi}/2 \approx 0.886226925452758\)</span></li>
<li>Absolute error: <span class="arithmatex">\(\sim 10^{-15}\)</span> (machine precision)</li>
<li>
<p>Relative error: <span class="arithmatex">\(\sim 10^{-14}\)</span></p>
</li>
<li>
<p><strong>What the Transformation Achieved:</strong></p>
</li>
<li><strong>Eliminated Infinity:</strong> The original integral from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(\infty\)</span> became a finite integral from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(1\)</span>.</li>
<li><strong>Preserved Accuracy:</strong> Despite the transformation, we achieve machine-precision accuracy.</li>
<li>
<p><strong>Enabled Computation:</strong> Without this transformation, no standard quadrature method could handle the infinite limit.</p>
</li>
<li>
<p><strong>Why This Works:</strong></p>
</li>
<li>The substitution <span class="arithmatex">\(t = 1/(1+x)\)</span> is a <strong>smooth, monotonic mapping</strong> that preserves the analytic structure of the integrand.</li>
<li>The transformed integrand <span class="arithmatex">\(\frac{1}{t^2} e^{-((1-t)/t)^2}\)</span> is well-behaved on <span class="arithmatex">\((0, 1]\)</span>â€”no singularities, no divergences.</li>
<li>
<p>Gaussian quadrature can efficiently approximate smooth functions on finite intervals.</p>
</li>
<li>
<p><strong>Comparison to Naive Approaches:</strong></p>
</li>
<li><strong>Truncation:</strong> Integrating from <span class="arithmatex">\(0\)</span> to some large number (e.g., <span class="arithmatex">\(10\)</span> or <span class="arithmatex">\(100\)</span>) introduces systematic error because the tail <span class="arithmatex">\(\int_{100}^\infty e^{-x^2} dx\)</span> is non-zero.</li>
<li><strong>How large is large enough?</strong> For <span class="arithmatex">\(e^{-x^2}\)</span>, you'd need <span class="arithmatex">\(x \sim 10\)</span> for 6-digit accuracy, but there's no automatic way to know this.</li>
<li>
<p><strong>The transformation:</strong> Rigorously captures the entire integral with no guesswork.</p>
</li>
<li>
<p><strong>Broader Applications:</strong></p>
</li>
<li>Probability theory: Normal distribution cumulative density function</li>
<li>Quantum mechanics: Gaussian wavepackets</li>
<li>Statistical mechanics: Partition functions with Gaussian weights</li>
<li>
<p>Error functions: <span class="arithmatex">\(\text{erf}(x) = \frac{2}{\sqrt{\pi}} \int_0^x e^{-t^2} dt\)</span></p>
</li>
<li>
<p><strong>Critical Lesson:</strong> When facing integrals with infinite limits or singularities, <strong>don't fight the problemâ€”transform it</strong>. Change of variables is one of the most powerful tools in the computational physicist's arsenal.</p>
</li>
</ul>
<h2 class="heading-with-pill" id="66-core-application-period-of-a-nonlinear-pendulum">6.6 Core Application: Period of a Nonlinear Pendulum</h2>
<blockquote>
<p><strong>Concept:</strong> Real-World Integration with Endpoint Singularities â€¢ <strong>Difficulty:</strong> â˜…â˜…â˜…â˜…â˜†</p>
<p><strong>Summary:</strong> The exact period of a nonlinear pendulum requires evaluating an integral with a singularity at the upper limit. This classic problem demonstrates the practical power of sophisticated quadrature methods like <code>scipy.integrate.quad</code> to handle realistic physics calculations.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_5">Theoretical Background</h3>
<p>The simple pendulum is a cornerstone of classical mechanics, but the textbook formula <span class="arithmatex">\(T = 2\pi\sqrt{L/g}\)</span> is only valid for <strong>small oscillations</strong> (the small-angle approximation <span class="arithmatex">\(\sin\theta \approx \theta\)</span>). For large swings, we must solve the full nonlinear equationâ€”and this requires numerical integration.</p>
<h4 id="the-physics-conservation-of-energy">The Physics: Conservation of Energy</h4>
<p>Consider a pendulum of length <span class="arithmatex">\(L\)</span> released from rest at angle <span class="arithmatex">\(\theta_0\)</span>. The total mechanical energy is conserved:</p>
<div class="arithmatex">\[E = \frac{1}{2}m L^2 \dot{\theta}^2 + mgL(1 - \cos\theta) = mgL(1 - \cos\theta_0)\]</div>
<p>where <span class="arithmatex">\(m\)</span> is the bob mass, and we've chosen the potential energy zero at the bottom (<span class="arithmatex">\(\theta = 0\)</span>).</p>
<p>Solving for the angular velocity:</p>
<div class="arithmatex">\[\dot{\theta} = \sqrt{\frac{2g}{L}} \sqrt{\cos\theta - \cos\theta_0}\]</div>
<h4 id="deriving-the-period-integral">Deriving the Period Integral</h4>
<p>The period <span class="arithmatex">\(T\)</span> is the time for one complete oscillation. By symmetry, this is four times the time to swing from <span class="arithmatex">\(\theta = 0\)</span> to <span class="arithmatex">\(\theta = \theta_0\)</span>:</p>
<div class="arithmatex">\[T = 4 \int_0^{\theta_0} \frac{d\theta}{\dot{\theta}}\]</div>
<p>Substituting the expression for <span class="arithmatex">\(\dot{\theta}\)</span>:</p>
<div class="arithmatex">\[T = 4 \int_0^{\theta_0} \frac{d\theta}{\sqrt{\frac{2g}{L}(\cos\theta - \cos\theta_0)}} = 4\sqrt{\frac{L}{2g}} \int_0^{\theta_0} \frac{d\theta}{\sqrt{\cos\theta - \cos\theta_0}}\]</div>
<p>Simplifying:</p>
<div class="arithmatex">\[T = \sqrt{\frac{8L}{g}} \int_0^{\theta_0} \frac{d\theta}{\sqrt{\cos\theta - \cos\theta_0}}\]</div>
<p>This is the <strong>exact period formula</strong> for a nonlinear pendulum.</p>
<h4 id="the-computational-challenge-endpoint-singularity">The Computational Challenge: Endpoint Singularity</h4>
<p>At the upper limit <span class="arithmatex">\(\theta = \theta_0\)</span>, the denominator vanishes:</p>
<div class="arithmatex">\[\sqrt{\cos\theta_0 - \cos\theta_0} = \sqrt{0} = 0\]</div>
<p>This creates a <strong>singularity</strong>â€”the integrand approaches infinity as <span class="arithmatex">\(\theta \to \theta_0^-\)</span>.</p>
<p><strong>Why is this a problem?</strong>
- A naive grid-based method (Trapezoidal, Simpson's) would evaluate the function <strong>at</strong> <span class="arithmatex">\(\theta = \theta_0\)</span>, causing division by zero.
- Even evaluating near <span class="arithmatex">\(\theta_0\)</span> leads to catastrophic round-off error due to the subtraction <span class="arithmatex">\(\cos\theta - \cos\theta_0 \approx 0\)</span>.</p>
<h4 id="the-professional-solution-scipyintegratequad">The Professional Solution: <code>scipy.integrate.quad</code></h4>
<p>The key insight: <code>scipy.integrate.quad</code> uses <strong>adaptive Gaussian quadrature</strong> with special handling for endpoint singularities. It:</p>
<ol>
<li><strong>Detects</strong> the endpoint singularity automatically</li>
<li><strong>Concentrates</strong> integration points away from the singular endpoint</li>
<li><strong>Uses weight functions</strong> that properly handle the <span class="arithmatex">\(1/\sqrt{x}\)</span> behavior</li>
<li><strong>Adaptively refines</strong> the quadrature in regions where the integrand changes rapidly</li>
</ol>
<p>This makes <code>quad</code> the ideal tool for this problem.</p>
<h4 id="small-angle-approximation-for-comparison">Small-Angle Approximation for Comparison</h4>
<p>For small <span class="arithmatex">\(\theta_0\)</span> (in radians), the standard approximation is:</p>
<div class="arithmatex">\[T_{\text{approx}} = 2\pi\sqrt{\frac{L}{g}}\]</div>
<p>This is <strong>independent of amplitude</strong>â€”a key prediction that fails for large swings.</p>
<p>For larger amplitudes, the exact period is <strong>longer</strong> than the small-angle prediction because the pendulum spends more time at the extremes where its velocity is low.</p>
<div class="section-divider"></div>

<h3 id="comprehension-check_5">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the source of the computational problem in the nonlinear pendulum period integral?</strong></p>
<ul>
<li>A. The integral has infinite limits</li>
<li>B. The integrand has a singularity at the upper endpoint <span class="arithmatex">\(\theta = \theta_0\)</span></li>
<li>C. The integral is 10-dimensional</li>
<li>D. The function is too "wiggly" for Simpson's Rule</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>At <span class="arithmatex">\(\theta = \theta_0\)</span>, the denominator <span class="arithmatex">\(\sqrt{\cos\theta - \cos\theta_0}\)</span> approaches zero, causing the integrand to diverge to infinity. This is an <strong>endpoint singularity</strong>. Grid-based methods that must evaluate the function at the endpoint will fail with division by zero or severe round-off error.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. For a large swing angle (e.g., <span class="arithmatex">\(\theta_0 = 45Â°\)</span>), how does the exact period <span class="arithmatex">\(T_{\text{exact}}\)</span> compare to the small-angle approximation <span class="arithmatex">\(T_{\text{approx}} = 2\pi\sqrt{L/g}\)</span>?</strong></p>
<ul>
<li>A. Significantly shorter</li>
<li>B. Exactly the same</li>
<li>C. Longer, due to the nonlinearity of the equation</li>
<li>D. Shorter, due to energy loss</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p>For large amplitudes, the pendulum spends more time at the extremes of its swing (where velocity is low) compared to the small-angle case. This increases the period. The nonlinear term <span class="arithmatex">\(\sin\theta\)</span> (vs. the approximation <span class="arithmatex">\(\theta\)</span>) causes this deviation. For <span class="arithmatex">\(\theta_0 = 45Â°\)</span>, the period is about 3.5% longer than the small-angle prediction.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. Why can't we use a simple grid-based method (like Simpson's Rule) directly for this integral?</strong></p>
<ul>
<li>A. The integral is too long</li>
<li>B. The function oscillates too much</li>
<li>C. Evaluating at the endpoint <span class="arithmatex">\(\theta_0\)</span> causes division by zero</li>
<li>D. Grid-based methods don't work for physics problems</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p>Grid-based methods require evaluating the function at regular intervals, including the endpoints. At <span class="arithmatex">\(\theta = \theta_0\)</span>, the integrand <span class="arithmatex">\(1/\sqrt{\cos\theta - \cos\theta_0}\)</span> is <strong>undefined</strong> (division by zero). Even evaluating extremely close to <span class="arithmatex">\(\theta_0\)</span> leads to catastrophic cancellation in the subtraction <span class="arithmatex">\(\cos\theta - \cos\theta_0\)</span>, destroying numerical accuracy.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> I have an integral with a singularity at <span class="arithmatex">\(x = 1\)</span>. If I use <code>scipy.integrate.quad(f, 0, 1)</code>, what internal mechanism does <code>quad</code> employ that prevents the code from failing, unlike a simple loop using the Trapezoidal Rule?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This question tests your understanding of why adaptive Gaussian quadrature succeeds where fixed-grid methods fail.</p>
<ol>
<li>
<p><strong>No Evaluation at the Singularity:</strong><br />
<code>quad</code> uses <strong>Gaussian quadrature</strong>, which doesn't require evaluating the function at the endpoints. The sample points are the <strong>roots of Legendre polynomials</strong>, which lie strictly <strong>inside</strong> the interval <span class="arithmatex">\((0, 1)\)</span>, never at the boundaries.</p>
</li>
<li>
<p><strong>Adaptive Refinement:</strong><br />
   When <code>quad</code> detects rapid changes in the integrand (which happens near a singularity), it automatically <strong>subdivides</strong> the interval into smaller segments and concentrates more evaluation points in the problematic regionâ€”all while avoiding the singular point itself.</p>
</li>
<li>
<p><strong>Specialized Weight Functions:</strong><br />
   For common singularities (like <span class="arithmatex">\(1/\sqrt{x}\)</span> at <span class="arithmatex">\(x=0\)</span>), <code>quad</code> can use <strong>Gauss-Kronrod rules</strong> with built-in weights that exactly match the singular behavior. This is analogous to the change-of-variables trick we saw in Section 6.5, but implemented internally.</p>
</li>
<li>
<p><strong>Error Estimation:</strong><br />
   By comparing results from different quadrature orders (Gauss vs. Kronrod), <code>quad</code> estimates the integration error. If the error is too large, it refines furtherâ€”but never by evaluating at the singularity.</p>
</li>
<li>
<p><strong>Contrast with Grid Methods:</strong><br />
   The Trapezoidal Rule in a simple loop would:</p>
</li>
<li>Evaluate <span class="arithmatex">\(f(0)\)</span> and <span class="arithmatex">\(f(1)\)</span> directly â†’ <strong>division by zero</strong></li>
<li>Use fixed, evenly-spaced points â†’ <strong>no adaptive refinement</strong></li>
<li>
<p>Lack sophisticated error control â†’ <strong>unreliable results</strong></p>
</li>
<li>
<p><strong>The Takeaway:</strong><br />
<code>quad</code> succeeds because it:</p>
</li>
<li>Avoids the singular points</li>
<li>Adapts to the integrand's behavior</li>
<li>Uses mathematically optimal sampling</li>
</ol>
<p>This makes it robust for real-world physics problems where singularities are common.</p>
</details>
</div>
<hr />
<h3 id="hands-on-project_5"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-exact-vs-approximate-pendulum-period"><strong>Project:</strong> Exact vs. Approximate Pendulum Period</h4>
<hr />
<h4 id="project-blueprint_5"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Compute the exact period of a nonlinear pendulum for various initial angles <span class="arithmatex">\(\theta_0\)</span> and compare to the small-angle approximation, demonstrating when the standard formula breaks down.</td>
</tr>
<tr>
<td><strong>Physical Setup</strong></td>
<td>Pendulum with length <span class="arithmatex">\(L = 1.0\)</span> m under Earth's gravity <span class="arithmatex">\(g = 9.81\)</span> m/sÂ². Test initial angles: <span class="arithmatex">\(\theta_0 = 5Â°, 15Â°, 30Â°, 45Â°, 60Â°, 80Â°\)</span>.</td>
</tr>
<tr>
<td><strong>Exact Period Formula</strong></td>
<td>$<span class="arithmatex">\(T_{\text{exact}} = \sqrt{\frac{8L}{g}} \int_0^{\theta_0} \frac{d\theta}{\sqrt{\cos\theta - \cos\theta_0}}\)</span>$</td>
</tr>
<tr>
<td><strong>Approximate Formula</strong></td>
<td>$<span class="arithmatex">\(T_{\text{approx}} = 2\pi\sqrt{\frac{L}{g}}\)</span>$</td>
</tr>
<tr>
<td><strong>Computational Task</strong></td>
<td>For each <span class="arithmatex">\(\theta_0\)</span>: <br> 1. Define the integrand <span class="arithmatex">\(f(\theta) = 1/\sqrt{\cos\theta - \cos\theta_0}\)</span> <br> 2. Integrate from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(\theta_0\)</span> using <code>quad</code> <br> 3. Multiply by the coefficient <span class="arithmatex">\(\sqrt{8L/g}\)</span> <br> 4. Compute the small-angle approximation <br> 5. Calculate the percentage</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>- For small angles (<span class="arithmatex">\(\theta_0 &lt; 10Â°\)</span>): exact <span class="arithmatex">\(\approx\)</span> approximate (&lt; 1% difference) <br> - For moderate angles (<span class="arithmatex">\(\theta_0 \approx 30Â°\)</span>): ~2-3% difference <br> - For large angles (<span class="arithmatex">\(\theta_0 \approx 60Â°\)</span>): ~10% difference <br> - For very large angles (<span class="arithmatex">\(\theta_0 \approx 80Â°\)</span>): ~20%</td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>theta_0_degrees</code>: initial angle in degrees <br> - <code>theta_0_radians</code>: converted to radians <br> - <code>I</code>: integral result from <code>quad</code> <br> - <code>T_exact</code>: exact period <br> - <code>T_approx</code>: approximate period <br> - <code>percent_diff</code>: percentage difference</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Create a table and plot showing how the percentage error grows with initial angle, clearly demonstrating the breakdown of the small-angle approximation.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>- Table of periods vs. initial angle <br> - Plot of percentage difference vs. <span class="arithmatex">\(\theta_0\)</span> <br> - Commentary on when the approximation is acceptable</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_5"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>BEGIN
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>  // 1. Import Libraries
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>  IMPORT numpy as np
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>  IMPORT scipy.integrate as integrate
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>  IMPORT matplotlib.pyplot as plt
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>  // 2. Physical Parameters
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>  SET L = 1.0       // meters (pendulum length)
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>  SET g = 9.81      // m/sÂ² (gravitational acceleration)
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>  SET coefficient = sqrt(8 * L / g)
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>  // 3. Small-Angle Approximation (constant)
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>  SET T_approx = 2 * Ï€ * sqrt(L / g)
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>  // 4. Test Angles
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>  SET theta_0_degrees_array = [5, 15, 30, 45, 60, 80]
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>  SET results = []  // Store [angle, T_exact, T_approx, percent_diff]
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>  // 5. Compute Exact Period for Each Angle
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>  PRINT &quot;===== Nonlinear Pendulum: Period vs. Initial Angle =====&quot;
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>  PRINT &quot;Pendulum length L =&quot;, L, &quot;m&quot;
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>  PRINT &quot;Gravity g =&quot;, g, &quot;m/sÂ²&quot;
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>  PRINT &quot;Small-angle prediction: T â‰ˆ&quot;, T_approx, &quot;s&quot;
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>  PRINT &quot;-----------------------------------------------------------&quot;
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>  PRINT &quot;Î¸â‚€(Â°)    T_exact(s)  T_approx(s)  % Difference&quot;
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>  PRINT &quot;-----------------------------------------------------------&quot;
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>  FOR each theta_0_deg in theta_0_degrees_array DO:
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>      // 5a. Convert to radians
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>      SET theta_0_rad = theta_0_deg * (Ï€ / 180)
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>      // 5b. Define integrand (with singularity at upper limit)
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>      FUNCTION integrand(theta):
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>          SET denominator = sqrt(cos(theta) - cos(theta_0_rad))
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>          RETURN 1 / denominator
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>      END FUNCTION
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a>      // 5c. Integrate using quad (handles endpoint singularity)
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>      SET [I, error_est] = integrate.quad(integrand, 0, theta_0_rad)
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a>      // 5d. Compute exact period
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>      SET T_exact = coefficient * I
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>      // 5e. Compute percentage difference
</span><span id="__span-7-46"><a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>      SET percent_diff = 100 * (T_exact - T_approx) / T_approx
</span><span id="__span-7-47"><a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>
</span><span id="__span-7-48"><a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>      // 5f. Store results
</span><span id="__span-7-49"><a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>      APPEND [theta_0_deg, T_exact, T_approx, percent_diff] to results
</span><span id="__span-7-50"><a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a>
</span><span id="__span-7-51"><a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a>      // 5g. Print row
</span><span id="__span-7-52"><a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a>      PRINT theta_0_deg, T_exact, T_approx, percent_diff
</span><span id="__span-7-53"><a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a>  END FOR
</span><span id="__span-7-54"><a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a>
</span><span id="__span-7-55"><a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a>  PRINT &quot;-----------------------------------------------------------&quot;
</span><span id="__span-7-56"><a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a>
</span><span id="__span-7-57"><a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a>  // 6. Create Visualization
</span><span id="__span-7-58"><a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a>  EXTRACT angles = [r[0] for r in results]
</span><span id="__span-7-59"><a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a>  EXTRACT percent_diffs = [r[3] for r in results]
</span><span id="__span-7-60"><a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a>
</span><span id="__span-7-61"><a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a>  FIGURE
</span><span id="__span-7-62"><a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a>  PLOT angles, percent_diffs, marker=&#39;o&#39;, color=&#39;red&#39;, linewidth=2
</span><span id="__span-7-63"><a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a>  XLABEL &quot;Initial Angle Î¸â‚€ (degrees)&quot;
</span><span id="__span-7-64"><a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a>  YLABEL &quot;% Increase from Small-Angle Formula&quot;
</span><span id="__span-7-65"><a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a>  TITLE &quot;Breakdown of Small-Angle Approximation&quot;
</span><span id="__span-7-66"><a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a>  GRID ON
</span><span id="__span-7-67"><a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a>  AXHLINE y=1, linestyle=&#39;--&#39;, color=&#39;gray&#39;, label=&#39;1% threshold&#39;)
</span><span id="__span-7-68"><a id="__codelineno-7-68" name="__codelineno-7-68" href="#__codelineno-7-68"></a>  AXHLINE y=5, linestyle=&#39;--&#39;, color=&#39;orange&#39;, label=&#39;5% threshold&#39;)
</span><span id="__span-7-69"><a id="__codelineno-7-69" name="__codelineno-7-69" href="#__codelineno-7-69"></a>  LEGEND
</span><span id="__span-7-70"><a id="__codelineno-7-70" name="__codelineno-7-70" href="#__codelineno-7-70"></a>  SHOW
</span><span id="__span-7-71"><a id="__codelineno-7-71" name="__codelineno-7-71" href="#__codelineno-7-71"></a>
</span><span id="__span-7-72"><a id="__codelineno-7-72" name="__codelineno-7-72" href="#__codelineno-7-72"></a>  // 7. Analysis and Commentary
</span><span id="__span-7-73"><a id="__codelineno-7-73" name="__codelineno-7-73" href="#__codelineno-7-73"></a>  PRINT &quot;&quot;
</span><span id="__span-7-74"><a id="__codelineno-7-74" name="__codelineno-7-74" href="#__codelineno-7-74"></a>  PRINT &quot;===== Analysis =====&quot;
</span><span id="__span-7-75"><a id="__codelineno-7-75" name="__codelineno-7-75" href="#__codelineno-7-75"></a>  PRINT &quot;â€¢ For Î¸â‚€ &lt; 10Â°: Error &lt; 1% â†’ small-angle approximation valid&quot;
</span><span id="__span-7-76"><a id="__codelineno-7-76" name="__codelineno-7-76" href="#__codelineno-7-76"></a>  PRINT &quot;â€¢ For Î¸â‚€ â‰ˆ 30Â°: Error â‰ˆ 2-3% â†’ approximation reasonable&quot;
</span><span id="__span-7-77"><a id="__codelineno-7-77" name="__codelineno-7-77" href="#__codelineno-7-77"></a>  PRINT &quot;â€¢ For Î¸â‚€ â‰ˆ 60Â°: Error â‰ˆ 10% â†’ significant deviation&quot;
</span><span id="__span-7-78"><a id="__codelineno-7-78" name="__codelineno-7-78" href="#__codelineno-7-78"></a>  PRINT &quot;â€¢ For Î¸â‚€ &gt; 70Â°: Error &gt; 15% â†’ approximation unreliable&quot;
</span><span id="__span-7-79"><a id="__codelineno-7-79" name="__codelineno-7-79" href="#__codelineno-7-79"></a>  PRINT &quot;&quot;
</span><span id="__span-7-80"><a id="__codelineno-7-80" name="__codelineno-7-80" href="#__codelineno-7-80"></a>  PRINT &quot;Physical Insight:&quot;
</span><span id="__span-7-81"><a id="__codelineno-7-81" name="__codelineno-7-81" href="#__codelineno-7-81"></a>  PRINT &quot;Large-amplitude oscillations spend more time at the extremes&quot;
</span><span id="__span-7-82"><a id="__codelineno-7-82" name="__codelineno-7-82" href="#__codelineno-7-82"></a>  PRINT &quot;where velocity is low, increasing the period beyond the&quot;
</span><span id="__span-7-83"><a id="__codelineno-7-83" name="__codelineno-7-83" href="#__codelineno-7-83"></a>  PRINT &quot;constant small-angle prediction.&quot;
</span><span id="__span-7-84"><a id="__codelineno-7-84" name="__codelineno-7-84" href="#__codelineno-7-84"></a>
</span><span id="__span-7-85"><a id="__codelineno-7-85" name="__codelineno-7-85" href="#__codelineno-7-85"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_5"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Expected Numerical Results:</strong></li>
</ul>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(\theta_0\)</span> (Â°)</th>
<th><span class="arithmatex">\(T_{\text{exact}}\)</span> (s)</th>
<th><span class="arithmatex">\(T_{\text{approx}}\)</span> (s)</th>
<th>% Difference</th>
</tr>
</thead>
<tbody>
<tr>
<td>5</td>
<td>2.0071</td>
<td>2.0063</td>
<td>0.04%</td>
</tr>
<tr>
<td>15</td>
<td>2.0104</td>
<td>2.0063</td>
<td>0.20%</td>
</tr>
<tr>
<td>30</td>
<td>2.0305</td>
<td>2.0063</td>
<td>1.21%</td>
</tr>
<tr>
<td>45</td>
<td>2.0729</td>
<td>2.0063</td>
<td>3.32%</td>
</tr>
<tr>
<td>60</td>
<td>2.1559</td>
<td>2.0063</td>
<td>7.46%</td>
</tr>
<tr>
<td>80</td>
<td>2.4485</td>
<td>2.0063</td>
<td>22.05%</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><strong>Visual Interpretation:</strong><br />
  The plot shows an <strong>exponential-like growth</strong> in percentage error as <span class="arithmatex">\(\theta_0\)</span> increases. This clearly demonstrates the breakdown of the linear approximation.</p>
</li>
<li>
<p><strong>Singularity Handling Success:</strong><br />
  Despite the endpoint singularity at <span class="arithmatex">\(\theta = \theta_0\)</span>, <code>scipy.integrate.quad</code> successfully computes all integrals with high accuracy (error estimates <span class="arithmatex">\(&lt; 10^{-10}\)</span>). This validates the robustness of adaptive Gaussian quadrature.</p>
</li>
<li>
<p><strong>Physics Validation:</strong><br />
  The fact that <span class="arithmatex">\(T_{\text{exact}} &gt; T_{\text{approx}}\)</span> for all non-zero amplitudes confirms the physical intuition: nonlinearity <strong>slows down</strong> the oscillation compared to the harmonic approximation.</p>
</li>
<li>
<p><strong>Practical Guidelines:</strong>  </p>
</li>
<li><strong>High-precision timekeeping:</strong> Use exact formula (or higher-order approximations)</li>
<li><strong>Rough estimates:</strong> Small-angle formula acceptable for <span class="arithmatex">\(\theta_0 &lt; 15Â°\)</span></li>
<li>
<p><strong>Educational demonstrations:</strong> Show both to illustrate nonlinear effects</p>
</li>
<li>
<p><strong>Broader Lesson:</strong> This project demonstrates that <strong>realistic physics problems often involve integrals with singularities</strong>. Professional numerical tools like <code>scipy.integrate.quad</code> are essential for handling these cases reliably. Hand-coded grid methods would fail catastrophically here without sophisticated singularity treatment.</p>
</li>
</ul>
<h2 class="heading-with-pill" id="67-teaser-for-volume-ii-monte-carlo-integration">6.7 Teaser for Volume II: Monte Carlo Integration</h2>
<blockquote>
<p><strong>Concept:</strong> Stochastic Sampling Defeats the Curse of Dimensionality â€¢ <strong>Difficulty:</strong> â˜…â˜…â˜…â˜…â˜†</p>
<p><strong>Summary:</strong> Monte Carlo integration uses random sampling to evaluate integrals. Its error, <span class="arithmatex">\(O(1/\sqrt{N})\)</span>, is <strong>independent of dimension</strong>, making it the only feasible method for high-dimensional integrals that appear in statistical mechanics, quantum many-body theory, and machine learning.</p>
</blockquote>
<hr />
<h3 id="theoretical-background_6">Theoretical Background</h3>
<p>We've seen that grid-based methods (Trapezoidal, Simpson's, Gaussian quadrature) achieve spectacular accuracy in one dimension. But there's a dark secret lurking: they <strong>collapse catastrophically</strong> as the dimension increases. This is known as the <strong>Curse of Dimensionality</strong>.</p>
<h4 id="the-curse-of-dimensionality">The Curse of Dimensionality</h4>
<p><strong>The Problem:</strong> In <span class="arithmatex">\(D\)</span> dimensions, a uniform grid with <span class="arithmatex">\(N\)</span> points per dimension requires <span class="arithmatex">\(N^D\)</span> total points.</p>
<p><strong>Example:</strong>
- <strong>1D:</strong> 100 points gives <span class="arithmatex">\(10^2 = 100\)</span> evaluations
- <strong>2D:</strong> <span class="arithmatex">\(100 \times 100 = 10^4\)</span> evaluations<br />
- <strong>3D:</strong> <span class="arithmatex">\(100 \times 100 \times 100 = 10^6\)</span> evaluations
- <strong>10D:</strong> <span class="arithmatex">\(100^{10} = 10^{20}\)</span> evaluations â† <strong>Impossible!</strong></p>
<p>Even worse, the <strong>effective accuracy</strong> deteriorates. Simpson's Rule has <span class="arithmatex">\(O(h^4)\)</span> accuracy in 1D, which becomes <span class="arithmatex">\(O(N^{-4})\)</span> in terms of the number of points per dimension. In <span class="arithmatex">\(D\)</span> dimensions:</p>
<div class="arithmatex">\[\text{Error} \sim O(N^{-4/D})\]</div>
<p><strong>Practical Consequence:</strong></p>
<table>
<thead>
<tr>
<th>Dimension <span class="arithmatex">\(D\)</span></th>
<th>Simpson's Error</th>
<th>Points Needed for <span class="arithmatex">\(10^{-6}\)</span> Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><span class="arithmatex">\(O(N^{-4})\)</span></td>
<td><span class="arithmatex">\(\sim 100\)</span></td>
</tr>
<tr>
<td>2</td>
<td><span class="arithmatex">\(O(N^{-2})\)</span></td>
<td><span class="arithmatex">\(\sim 1000\)</span></td>
</tr>
<tr>
<td>3</td>
<td><span class="arithmatex">\(O(N^{-4/3})\)</span></td>
<td><span class="arithmatex">\(\sim 10^5\)</span></td>
</tr>
<tr>
<td>10</td>
<td><span class="arithmatex">\(O(N^{-0.4})\)</span></td>
<td><span class="arithmatex">\(\sim 10^{15}\)</span> â† <strong>Impossible!</strong></td>
</tr>
</tbody>
</table>
<p>For high-dimensional problems (common in statistical mechanics, quantum chemistry, finance), <strong>grid methods are completely infeasible</strong>.</p>
<h4 id="the-monte-carlo-solution-random-sampling">The Monte Carlo Solution: Random Sampling</h4>
<p><strong>Monte Carlo integration</strong> bypasses the grid entirely by using <strong>random sampling</strong>.</p>
<p><strong>The Mean Value Method:</strong></p>
<p>For a <span class="arithmatex">\(D\)</span>-dimensional integral over a domain <span class="arithmatex">\(\Omega\)</span> with volume <span class="arithmatex">\(V\)</span>:</p>
<div class="arithmatex">\[I = \int_\Omega f(\mathbf{x}) \, d\mathbf{x} \approx V \cdot \frac{1}{N} \sum_{i=1}^{N} f(\mathbf{x}_i)\]</div>
<p>where <span class="arithmatex">\(\mathbf{x}_i\)</span> are <strong>random points</strong> uniformly distributed in <span class="arithmatex">\(\Omega\)</span>.</p>
<p><strong>Intuition:</strong> The integral is approximated by the <strong>volume times the average function value</strong> over random samples.</p>
<h4 id="error-analysis-the-central-limit-theorem">Error Analysis: The Central Limit Theorem</h4>
<p>From probability theory, the error of the Monte Carlo estimate is governed by the <strong>Central Limit Theorem</strong>:</p>
<div class="arithmatex">\[\text{Error} \sim \frac{\sigma}{\sqrt{N}}\]</div>
<p>where:
- <span class="arithmatex">\(\sigma\)</span> is the standard deviation of the function values
- <span class="arithmatex">\(N\)</span> is the number of random samples</p>
<p><strong>The Magic:</strong> This error formula <strong>does not depend on the dimension <span class="arithmatex">\(D\)</span></strong>!</p>
<p><strong>Comparison:</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>1D Error</th>
<th>10D Error</th>
<th>Dimension Dependence</th>
</tr>
</thead>
<tbody>
<tr>
<td>Simpson's Rule</td>
<td><span class="arithmatex">\(O(N^{-4})\)</span></td>
<td><span class="arithmatex">\(O(N^{-0.4})\)</span></td>
<td>Strong (exponential)</td>
</tr>
<tr>
<td>Monte Carlo</td>
<td><span class="arithmatex">\(O(N^{-0.5})\)</span></td>
<td><span class="arithmatex">\(O(N^{-0.5})\)</span></td>
<td>None</td>
</tr>
</tbody>
</table>
<h4 id="the-verdict-when-to-use-monte-carlo">The Verdict: When to Use Monte Carlo</h4>
<p><strong>Monte Carlo is worse than grid methods in low dimensions:</strong>
- In 1D: Simpson's <span class="arithmatex">\(O(N^{-4})\)</span> beats Monte Carlo <span class="arithmatex">\(O(N^{-0.5})\)</span> easily
- In 2D-3D: Grid methods still preferable for smooth functions</p>
<p><strong>Monte Carlo becomes the only option in high dimensions:</strong>
- For <span class="arithmatex">\(D &gt; 8\)</span>: Grid methods become impractical
- For <span class="arithmatex">\(D \sim 100-1000\)</span>: Only Monte Carlo works
- For <span class="arithmatex">\(D \sim 10^{23}\)</span> (statistical mechanics): Absolutely essential</p>
<p><strong>Applications:</strong>
- <strong>Statistical mechanics:</strong> Partition function integrals over all particle positions
- <strong>Quantum chemistry:</strong> Many-electron wavefunctions (3<span class="arithmatex">\(N\)</span> dimensions for <span class="arithmatex">\(N\)</span> electrons)
- <strong>Finance:</strong> Portfolio risk analysis (hundreds of correlated variables)
- <strong>Machine learning:</strong> High-dimensional loss function optimization</p>
<h4 id="variance-reduction-the-secret-to-practical-monte-carlo">Variance Reduction: The Secret to Practical Monte Carlo</h4>
<p>The simple random sampling described above is the baseline. In practice, we use <strong>variance reduction techniques</strong> to dramatically improve efficiency:</p>
<ul>
<li><strong>Importance sampling:</strong> Sample more where the integrand is large</li>
<li><strong>Stratified sampling:</strong> Ensure uniform coverage of the domain</li>
<li><strong>Antithetic variables:</strong> Use correlated samples to reduce variance</li>
<li><strong>Control variates:</strong> Exploit known integrals for similar functions</li>
</ul>
<p>These techniques (covered in Volume II) can reduce the effective <span class="arithmatex">\(\sigma\)</span>, making Monte Carlo competitive even in moderate dimensions.</p>
<div class="section-divider"></div>

<h3 id="comprehension-check_6">Comprehension Check</h3>
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>1. What is the "Curse of Dimensionality"?</strong></p>
<ul>
<li>A. Monte Carlo integration is <span class="arithmatex">\(O(1/\sqrt{N})\)</span></li>
<li>B. Grid-based methods become exponentially slow and less accurate as dimension <span class="arithmatex">\(D\)</span> increases</li>
<li>C. All numerical methods fail if <span class="arithmatex">\(D &gt; 3\)</span></li>
<li>D. You must use double-wide tiles for Simpson's Rule in high dimensions</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>The Curse of Dimensionality refers to the exponential scaling of computational cost with dimension for grid-based methods. In <span class="arithmatex">\(D\)</span> dimensions, you need <span class="arithmatex">\(N^D\)</span> grid points (exponential in <span class="arithmatex">\(D\)</span>), and the accuracy degrades from <span class="arithmatex">\(O(N^{-4})\)</span> in 1D to <span class="arithmatex">\(O(N^{-4/D})\)</span> in <span class="arithmatex">\(D\)</span> dimensions. For <span class="arithmatex">\(D = 10\)</span>, this becomes <span class="arithmatex">\(O(N^{-0.4})\)</span>, requiring impossibly many points for reasonable accuracy.</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>2. In which scenario is Monte Carlo integration the best (and likely only) choice?</strong></p>
<ul>
<li>A. A 1D integral of a smooth, callable function</li>
<li>B. A 2D integral of data on a fixed grid</li>
<li>C. A 1000-dimensional integral for a statistical mechanics problem</li>
<li>D. Finding the area under a simple parabola</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: C</strong></p>
<p>Monte Carlo is the <strong>only feasible method</strong> for high-dimensional integrals (typically <span class="arithmatex">\(D &gt; 8\)</span>). A 1000-dimensional grid would require <span class="arithmatex">\(N^{1000}\)</span> pointsâ€”far beyond any computational capacity. Monte Carlo's error <span class="arithmatex">\(O(1/\sqrt{N})\)</span> is <strong>independent of dimension</strong>, making it scale identically for 3D, 100D, or 1000D problems. This is why it's essential for statistical mechanics (integrating over <span class="arithmatex">\(\sim 10^{23}\)</span> degrees of freedom).</p>
</details>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">Quiz</p>
<p><strong>3. What is the "magic" property of Monte Carlo error that allows it to beat the Curse of Dimensionality?</strong></p>
<ul>
<li>A. It uses optimal Gaussian quadrature points</li>
<li>B. The error <span class="arithmatex">\(O(1/\sqrt{N})\)</span> does not depend on dimension <span class="arithmatex">\(D\)</span></li>
<li>C. It's faster than Simpson's Rule in all dimensions</li>
<li>D. It requires no function evaluations</li>
</ul>
<details class="info">
<summary>See Answer</summary>
<p><strong>Correct: B</strong></p>
<p>The critical property is <strong>dimension independence</strong>. The error term <span class="arithmatex">\(\sigma/\sqrt{N}\)</span> contains no factor of <span class="arithmatex">\(D\)</span>. While grid methods need <span class="arithmatex">\(N^D\)</span> points (exponential in <span class="arithmatex">\(D\)</span>), Monte Carlo needs only <span class="arithmatex">\(N\)</span> random samples regardless of dimension. To cut the error in half, you need 4Ã— more samples whether you're in 1D, 10D, or 1000D. This dimension-independence is what makes high-dimensional integration possible.</p>
</details>
</div>
<hr />
<div class="admonition abstract">
<p class="admonition-title">Interview-Style Question</p>
<p><strong>Q:</strong> What is the "magic" property of Monte Carlo integration's error, <span class="arithmatex">\(O(1/\sqrt{N})\)</span>, that allows it to beat the Curse of Dimensionality? And why doesn't this make it superior to Simpson's Rule in all cases?</p>
<details class="info" open="open">
<summary>Answer Strategy</summary>
<p>This two-part question tests both your understanding of Monte Carlo's strength and its limitations.</p>
<p><strong>Part 1: The Magic (Why It Beats the Curse)</strong></p>
<ol>
<li>
<p><strong>Dimension Independence:</strong><br />
   The error <span class="arithmatex">\(\sigma/\sqrt{N}\)</span> contains <strong>no dimension factor <span class="arithmatex">\(D\)</span></strong>. The same error formula applies whether you're integrating over a 1D line, a 100D hypercube, or a <span class="arithmatex">\(10^{23}\)</span>-dimensional phase space.</p>
</li>
<li>
<p><strong>Contrast with Grid Methods:</strong><br />
   Grid-based methods require <span class="arithmatex">\(N^D\)</span> total points (exponential in <span class="arithmatex">\(D\)</span>), making them impractical for <span class="arithmatex">\(D &gt; 8\)</span>. Monte Carlo requires only <span class="arithmatex">\(N\)</span> random samples, scaling <strong>linearly</strong> with computational cost regardless of dimension.</p>
</li>
<li>
<p><strong>Statistical Foundation:</strong><br />
   This dimension-independence comes from the <strong>Central Limit Theorem</strong>: the variance of a sample mean decreases as <span class="arithmatex">\(1/N\)</span>, regardless of the underlying space's dimension. It's a fundamental property of statistical sampling.</p>
</li>
</ol>
<p><strong>Part 2: Why Simpson's Still Wins in Low Dimensions</strong></p>
<ol>
<li><strong>Convergence Rate Comparison:</strong>  </li>
<li>Simpson's Rule: <span class="arithmatex">\(O(N^{-4})\)</span> in 1D (or <span class="arithmatex">\(O(N^{-4/D})\)</span> in <span class="arithmatex">\(D\)</span> dimensions)</li>
<li>Monte Carlo: <span class="arithmatex">\(O(N^{-0.5})\)</span> always</li>
</ol>
<p>In 1D: <span class="arithmatex">\(N^{-4}\)</span> converges <strong>much faster</strong> than <span class="arithmatex">\(N^{-0.5}\)</span>.</p>
<ol>
<li><strong>Numerical Example:</strong><br />
   To achieve error <span class="arithmatex">\(&lt; 10^{-6}\)</span>:</li>
<li>Simpson's (1D): <span class="arithmatex">\(N \sim 100\)</span> points</li>
<li>Monte Carlo (1D): <span class="arithmatex">\(N \sim 10^{12}\)</span> samples</li>
</ol>
<p>This is a <strong>factor of 10 billion</strong> difference!</p>
<ol>
<li><strong>The Crossover Point:</strong><br />
   The dimension where Monte Carlo becomes competitive depends on the function, but typically:</li>
<li><span class="arithmatex">\(D \leq 3\)</span>: Grid methods dominate</li>
<li><span class="arithmatex">\(D = 4-7\)</span>: Case-dependent</li>
<li>
<p><span class="arithmatex">\(D \geq 8\)</span>: Monte Carlo becomes essential</p>
</li>
<li>
<p><strong>The Takeaway:</strong><br />
   Monte Carlo is not "better"â€”it's <strong>different</strong>. It trades convergence speed for dimension scalability. Use grid methods for low-dimensional, smooth problems. Use Monte Carlo when dimension makes grids impossible. This is a fundamental trade-off in computational science.</p>
</li>
</ol>
</details>
</div>
<hr />
<h3 id="hands-on-project_6"><i class="fa-solid fa-flask"></i> Hands-On Project</h3>
<h4 id="project-1d-monte-carlo-vs-simpsons-convergence-battle"><strong>Project:</strong> 1D Monte Carlo vs. Simpson's Convergence Battle</h4>
<hr />
<h4 id="project-blueprint_6"><strong>Project Blueprint</strong></h4>
<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Objective</strong></td>
<td>Visually demonstrate why grid-based methods are superior in 1D by comparing the convergence of Monte Carlo and Simpson's Rule on the same test integral. This highlights the trade-off between convergence rate and dimension scalability.</td>
</tr>
<tr>
<td><strong>Mathematical Concept</strong></td>
<td>Simpson's Rule: <span class="arithmatex">\(O(N^{-4})\)</span> convergence (steep) <br> Monte Carlo: <span class="arithmatex">\(O(N^{-0.5})\)</span> convergence (slow, noisy)</td>
</tr>
<tr>
<td><strong>Test Function</strong></td>
<td>Use <span class="arithmatex">\(f(x) = \sin(x)\)</span> on <span class="arithmatex">\([0, \pi]\)</span>. Exact: <span class="arithmatex">\(I = 2\)</span>.</td>
</tr>
<tr>
<td><strong>Experiment Setup</strong></td>
<td>Run both methods for <span class="arithmatex">\(N = 10, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000, 20000, 50000, 100000\)</span>. For Monte Carlo, repeat 10 times at each <span class="arithmatex">\(N\)</span> to show stochastic noise. Plot <span class="arithmatex">\(\log(\text{Error})\)</span> vs. <span class="arithmatex">\(\log(N)\)</span>.</td>
</tr>
<tr>
<td><strong>Process Steps</strong></td>
<td>1. Implement Simpson's Rule (deterministic). <br> 2. Implement Mean Value Monte Carlo (random sampling). <br> 3. For each <span class="arithmatex">\(N\)</span>: compute errors for both methods. <br> 4. Create log-log plot with both error curves. <br> 5. Add reference lines showing slopes of <span class="arithmatex">\(-4\)</span> and <span class="arithmatex">\(-0.5\)</span>.</td>
</tr>
<tr>
<td><strong>Expected Behavior</strong></td>
<td>- Simpson's error: steep downward slope (<span class="arithmatex">\(-4\)</span>), smooth curve <br> - Monte Carlo error: shallow downward slope (<span class="arithmatex">\(-0.5\)</span>), noisy curve <br> - Simpson's error drops below <span class="arithmatex">\(10^{-10}\)</span> around <span class="arithmatex">\(N \sim 100\)</span> <br> - Monte Carlo still at <span class="arithmatex">\(\sim 10^{-2}\)</span> even at <span class="arithmatex">\(N = 10^5\)</span></td>
</tr>
<tr>
<td><strong>Tracking Variables</strong></td>
<td>- <code>N_values</code>: array of sample sizes <br> - <code>errors_simp</code>: Simpson's errors (deterministic) <br> - <code>errors_mc_mean</code>: average Monte Carlo errors <br> - <code>errors_mc_std</code>: standard deviation of MC errors (shows stochastic noise) <br> - <code>theoretical_slopes</code>: reference lines for visual validation</td>
</tr>
<tr>
<td><strong>Verification Goal</strong></td>
<td>Confirm that: <br> 1. Simpson's slope <span class="arithmatex">\(\approx -4\)</span> on log-log plot. <br> 2. Monte Carlo slope <span class="arithmatex">\(\approx -0.5\)</span>. <br> 3. Simpson's is orders of magnitude more accurate for same <span class="arithmatex">\(N\)</span> in 1D.</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>- Log-log plot with error bars for Monte Carlo <br> - Reference lines showing theoretical slopes <br> - Table of errors at key <span class="arithmatex">\(N\)</span> values <br> - Commentary on when each method is appropriate</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pseudocode-implementation_6"><strong>Pseudocode Implementation</strong></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>BEGIN
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>  // 1. Import Libraries
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>  IMPORT numpy as np
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>  IMPORT matplotlib.pyplot as plt
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>  // 2. Test Function
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>  FUNCTION f(x):
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>      RETURN sin(x)
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>  END FUNCTION
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>  SET a = 0.0
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>  SET b = Ï€
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>  SET I_exact = 2.0
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>  // 3. Simpson&#39;s Rule Implementation
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>  FUNCTION simpson_rule(N):
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>      SET h = (b - a) / N
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>      SET x = [a + i*h for i in 0 to N]
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>      SET y = [f(xi) for xi in x]
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>      SET I = (h / 3) * (y[0] + y[N])
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>      FOR i FROM 1 TO N-1 DO:
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>          IF i is odd THEN:
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>              I = I + (h / 3) * 4 * y[i]
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>          ELSE:
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>              I = I + (h / 3) * 2 * y[i]
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>          END IF
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>      END FOR
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>      RETURN I
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>  END FUNCTION
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>  // 4. Monte Carlo Implementation
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>  FUNCTION monte_carlo(N):
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>      // Generate N random points in [a, b]
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>      SET x_random = a + (b - a) * random_uniform(size=N)
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>      // Evaluate function at random points
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a>      SET f_values = [f(x) for x in x_random]
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>      // Mean value estimate
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a>      SET volume = b - a
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a>      SET I = volume * mean(f_values)
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a>      RETURN I
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a>  END FUNCTION
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a>
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a>  // 5. Test Sample Sizes
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a>  SET N_values = [10, 20, 50, 100, 200, 500, 1000, 2000, 5000, 
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a>                  10000, 20000, 50000, 100000]
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a>  SET errors_simp = []
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a>  SET errors_mc_mean = []
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a>  SET errors_mc_std = []
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a>  // 6. Run Convergence Tests
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a>  PRINT &quot;===== Convergence Comparison: Simpson&#39;s vs. Monte Carlo =====&quot;
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a>  PRINT &quot;Function: sin(x), Interval: [0, Ï€], Exact: I = 2.0&quot;
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59" href="#__codelineno-8-59"></a>  PRINT &quot;-------------------------------------------------------------&quot;
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60" href="#__codelineno-8-60"></a>  PRINT &quot;     N      Simpson Error    MC Error (mean Â± std)&quot;
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61" href="#__codelineno-8-61"></a>  PRINT &quot;-------------------------------------------------------------&quot;
</span><span id="__span-8-62"><a id="__codelineno-8-62" name="__codelineno-8-62" href="#__codelineno-8-62"></a>
</span><span id="__span-8-63"><a id="__codelineno-8-63" name="__codelineno-8-63" href="#__codelineno-8-63"></a>  FOR each N in N_values DO:
</span><span id="__span-8-64"><a id="__codelineno-8-64" name="__codelineno-8-64" href="#__codelineno-8-64"></a>      // 6a. Simpson&#39;s Rule (deterministic)
</span><span id="__span-8-65"><a id="__codelineno-8-65" name="__codelineno-8-65" href="#__codelineno-8-65"></a>      IF N is even THEN:  // Simpson&#39;s requires even N
</span><span id="__span-8-66"><a id="__codelineno-8-66" name="__codelineno-8-66" href="#__codelineno-8-66"></a>          SET I_simp = simpson_rule(N)
</span><span id="__span-8-67"><a id="__codelineno-8-67" name="__codelineno-8-67" href="#__codelineno-8-67"></a>          SET error_simp = ABS(I_exact - I_simp)
</span><span id="__span-8-68"><a id="__codelineno-8-68" name="__codelineno-8-68" href="#__codelineno-8-68"></a>      ELSE:
</span><span id="__span-8-69"><a id="__codelineno-8-69" name="__codelineno-8-69" href="#__codelineno-8-69"></a>          SET error_simp = NaN  // Skip odd N
</span><span id="__span-8-70"><a id="__codelineno-8-70" name="__codelineno-8-70" href="#__codelineno-8-70"></a>      END IF
</span><span id="__span-8-71"><a id="__codelineno-8-71" name="__codelineno-8-71" href="#__codelineno-8-71"></a>      APPEND error_simp to errors_simp
</span><span id="__span-8-72"><a id="__codelineno-8-72" name="__codelineno-8-72" href="#__codelineno-8-72"></a>
</span><span id="__span-8-73"><a id="__codelineno-8-73" name="__codelineno-8-73" href="#__codelineno-8-73"></a>      // 6b. Monte Carlo (run multiple times to estimate variance)
</span><span id="__span-8-74"><a id="__codelineno-8-74" name="__codelineno-8-74" href="#__codelineno-8-74"></a>      SET mc_errors = []
</span><span id="__span-8-75"><a id="__codelineno-8-75" name="__codelineno-8-75" href="#__codelineno-8-75"></a>      FOR trial FROM 1 TO 10 DO:
</span><span id="__span-8-76"><a id="__codelineno-8-76" name="__codelineno-8-76" href="#__codelineno-8-76"></a>          SET I_mc = monte_carlo(N)
</span><span id="__span-8-77"><a id="__codelineno-8-77" name="__codelineno-8-77" href="#__codelineno-8-77"></a>          SET error_mc = ABS(I_exact - I_mc)
</span><span id="__span-8-78"><a id="__codelineno-8-78" name="__codelineno-8-78" href="#__codelineno-8-78"></a>          APPEND error_mc to mc_errors
</span><span id="__span-8-79"><a id="__codelineno-8-79" name="__codelineno-8-79" href="#__codelineno-8-79"></a>      END FOR
</span><span id="__span-8-80"><a id="__codelineno-8-80" name="__codelineno-8-80" href="#__codelineno-8-80"></a>      SET error_mc_mean = mean(mc_errors)
</span><span id="__span-8-81"><a id="__codelineno-8-81" name="__codelineno-8-81" href="#__codelineno-8-81"></a>      SET error_mc_std = std(mc_errors)
</span><span id="__span-8-82"><a id="__codelineno-8-82" name="__codelineno-8-82" href="#__codelineno-8-82"></a>
</span><span id="__span-8-83"><a id="__codelineno-8-83" name="__codelineno-8-83" href="#__codelineno-8-83"></a>      APPEND error_mc_mean to errors_mc_mean
</span><span id="__span-8-84"><a id="__codelineno-8-84" name="__codelineno-8-84" href="#__codelineno-8-84"></a>      APPEND error_mc_std to errors_mc_std
</span><span id="__span-8-85"><a id="__codelineno-8-85" name="__codelineno-8-85" href="#__codelineno-8-85"></a>
</span><span id="__span-8-86"><a id="__codelineno-8-86" name="__codelineno-8-86" href="#__codelineno-8-86"></a>      // 6c. Print results
</span><span id="__span-8-87"><a id="__codelineno-8-87" name="__codelineno-8-87" href="#__codelineno-8-87"></a>      PRINT N, error_simp, error_mc_mean, &quot;Â±&quot;, error_mc_std
</span><span id="__span-8-88"><a id="__codelineno-8-88" name="__codelineno-8-88" href="#__codelineno-8-88"></a>  END FOR
</span><span id="__span-8-89"><a id="__codelineno-8-89" name="__codelineno-8-89" href="#__codelineno-8-89"></a>
</span><span id="__span-8-90"><a id="__codelineno-8-90" name="__codelineno-8-90" href="#__codelineno-8-90"></a>  PRINT &quot;-------------------------------------------------------------&quot;
</span><span id="__span-8-91"><a id="__codelineno-8-91" name="__codelineno-8-91" href="#__codelineno-8-91"></a>
</span><span id="__span-8-92"><a id="__codelineno-8-92" name="__codelineno-8-92" href="#__codelineno-8-92"></a>  // 7. Create Log-Log Plot
</span><span id="__span-8-93"><a id="__codelineno-8-93" name="__codelineno-8-93" href="#__codelineno-8-93"></a>  FIGURE with size (10, 6)
</span><span id="__span-8-94"><a id="__codelineno-8-94" name="__codelineno-8-94" href="#__codelineno-8-94"></a>
</span><span id="__span-8-95"><a id="__codelineno-8-95" name="__codelineno-8-95" href="#__codelineno-8-95"></a>  // 7a. Simpson&#39;s Rule (solid line, no error bars)
</span><span id="__span-8-96"><a id="__codelineno-8-96" name="__codelineno-8-96" href="#__codelineno-8-96"></a>  SET valid_simp = [e for e in errors_simp if not isnan(e)]
</span><span id="__span-8-97"><a id="__codelineno-8-97" name="__codelineno-8-97" href="#__codelineno-8-97"></a>  SET valid_N_simp = [N_values[i] for i where errors_simp[i] not nan]
</span><span id="__span-8-98"><a id="__codelineno-8-98" name="__codelineno-8-98" href="#__codelineno-8-98"></a>  PLOT log(valid_N_simp), log(valid_simp), 
</span><span id="__span-8-99"><a id="__codelineno-8-99" name="__codelineno-8-99" href="#__codelineno-8-99"></a>       color=&#39;blue&#39;, marker=&#39;o&#39;, linewidth=2, label=&quot;Simpson&#39;s Rule&quot;
</span><span id="__span-8-100"><a id="__codelineno-8-100" name="__codelineno-8-100" href="#__codelineno-8-100"></a>
</span><span id="__span-8-101"><a id="__codelineno-8-101" name="__codelineno-8-101" href="#__codelineno-8-101"></a>  // 7b. Monte Carlo (with error bars)
</span><span id="__span-8-102"><a id="__codelineno-8-102" name="__codelineno-8-102" href="#__codelineno-8-102"></a>  ERRORBAR log(N_values), log(errors_mc_mean), yerr=errors_mc_std/errors_mc_mean,
</span><span id="__span-8-103"><a id="__codelineno-8-103" name="__codelineno-8-103" href="#__codelineno-8-103"></a>           color=&#39;red&#39;, marker=&#39;s&#39;, linewidth=2, label=&quot;Monte Carlo&quot;, alpha=0.7
</span><span id="__span-8-104"><a id="__codelineno-8-104" name="__codelineno-8-104" href="#__codelineno-8-104"></a>
</span><span id="__span-8-105"><a id="__codelineno-8-105" name="__codelineno-8-105" href="#__codelineno-8-105"></a>  // 7c. Theoretical Reference Lines
</span><span id="__span-8-106"><a id="__codelineno-8-106" name="__codelineno-8-106" href="#__codelineno-8-106"></a>  SET N_ref = 100
</span><span id="__span-8-107"><a id="__codelineno-8-107" name="__codelineno-8-107" href="#__codelineno-8-107"></a>  SET E_ref_simp = errors_simp where N=100
</span><span id="__span-8-108"><a id="__codelineno-8-108" name="__codelineno-8-108" href="#__codelineno-8-108"></a>  SET E_ref_mc = errors_mc_mean where N=100
</span><span id="__span-8-109"><a id="__codelineno-8-109" name="__codelineno-8-109" href="#__codelineno-8-109"></a>
</span><span id="__span-8-110"><a id="__codelineno-8-110" name="__codelineno-8-110" href="#__codelineno-8-110"></a>  PLOT log(N_values), log(E_ref_simp * (N_ref / N_values)^4),
</span><span id="__span-8-111"><a id="__codelineno-8-111" name="__codelineno-8-111" href="#__codelineno-8-111"></a>       linestyle=&#39;--&#39;, color=&#39;blue&#39;, alpha=0.5, label=&quot;O(Nâ»â´) reference&quot;
</span><span id="__span-8-112"><a id="__codelineno-8-112" name="__codelineno-8-112" href="#__codelineno-8-112"></a>  PLOT log(N_values), log(E_ref_mc * (N_ref / N_values)^0.5),
</span><span id="__span-8-113"><a id="__codelineno-8-113" name="__codelineno-8-113" href="#__codelineno-8-113"></a>       linestyle=&#39;--&#39;, color=&#39;red&#39;, alpha=0.5, label=&quot;O(Nâ»â°Â·âµ) reference&quot;
</span><span id="__span-8-114"><a id="__codelineno-8-114" name="__codelineno-8-114" href="#__codelineno-8-114"></a>
</span><span id="__span-8-115"><a id="__codelineno-8-115" name="__codelineno-8-115" href="#__codelineno-8-115"></a>  // 7d. Formatting
</span><span id="__span-8-116"><a id="__codelineno-8-116" name="__codelineno-8-116" href="#__codelineno-8-116"></a>  XLABEL &quot;log(N) [Number of samples/points]&quot;
</span><span id="__span-8-117"><a id="__codelineno-8-117" name="__codelineno-8-117" href="#__codelineno-8-117"></a>  YLABEL &quot;log(Error)&quot;
</span><span id="__span-8-118"><a id="__codelineno-8-118" name="__codelineno-8-118" href="#__codelineno-8-118"></a>  TITLE &quot;Convergence: Simpson&#39;s O(Nâ»â´) vs. Monte Carlo O(Nâ»â°Â·âµ)&quot;
</span><span id="__span-8-119"><a id="__codelineno-8-119" name="__codelineno-8-119" href="#__codelineno-8-119"></a>  LEGEND location=&#39;upper right&#39;
</span><span id="__span-8-120"><a id="__codelineno-8-120" name="__codelineno-8-120" href="#__codelineno-8-120"></a>  GRID ON, alpha=0.3
</span><span id="__span-8-121"><a id="__codelineno-8-121" name="__codelineno-8-121" href="#__codelineno-8-121"></a>  SHOW
</span><span id="__span-8-122"><a id="__codelineno-8-122" name="__codelineno-8-122" href="#__codelineno-8-122"></a>
</span><span id="__span-8-123"><a id="__codelineno-8-123" name="__codelineno-8-123" href="#__codelineno-8-123"></a>  // 8. Analysis
</span><span id="__span-8-124"><a id="__codelineno-8-124" name="__codelineno-8-124" href="#__codelineno-8-124"></a>  PRINT &quot;&quot;
</span><span id="__span-8-125"><a id="__codelineno-8-125" name="__codelineno-8-125" href="#__codelineno-8-125"></a>  PRINT &quot;===== Key Observations =====&quot;
</span><span id="__span-8-126"><a id="__codelineno-8-126" name="__codelineno-8-126" href="#__codelineno-8-126"></a>  PRINT &quot;1. Simpson&#39;s Rule (blue) shows steep, smooth descent (slope â‰ˆ -4)&quot;
</span><span id="__span-8-127"><a id="__codelineno-8-127" name="__codelineno-8-127" href="#__codelineno-8-127"></a>  PRINT &quot;2. Monte Carlo (red) shows shallow, noisy descent (slope â‰ˆ -0.5)&quot;
</span><span id="__span-8-128"><a id="__codelineno-8-128" name="__codelineno-8-128" href="#__codelineno-8-128"></a>  PRINT &quot;3. At N=100: Simpson&#39;s achieves ~10â»â¸ error, MC achieves ~10â»Â¹ error&quot;
</span><span id="__span-8-129"><a id="__codelineno-8-129" name="__codelineno-8-129" href="#__codelineno-8-129"></a>  PRINT &quot;4. To match Simpson&#39;s N=100 accuracy, MC needs N ~ 10â¸ samples!&quot;
</span><span id="__span-8-130"><a id="__codelineno-8-130" name="__codelineno-8-130" href="#__codelineno-8-130"></a>  PRINT &quot;&quot;
</span><span id="__span-8-131"><a id="__codelineno-8-131" name="__codelineno-8-131" href="#__codelineno-8-131"></a>  PRINT &quot;===== The Lesson =====&quot;
</span><span id="__span-8-132"><a id="__codelineno-8-132" name="__codelineno-8-132" href="#__codelineno-8-132"></a>  PRINT &quot;In 1D, grid-based methods are VASTLY superior to Monte Carlo.&quot;
</span><span id="__span-8-133"><a id="__codelineno-8-133" name="__codelineno-8-133" href="#__codelineno-8-133"></a>  PRINT &quot;However, in 10D, Simpson&#39;s would need N^10 points (impossible),&quot;
</span><span id="__span-8-134"><a id="__codelineno-8-134" name="__codelineno-8-134" href="#__codelineno-8-134"></a>  PRINT &quot;while MC still needs only ~10â¸ samples (feasible).&quot;
</span><span id="__span-8-135"><a id="__codelineno-8-135" name="__codelineno-8-135" href="#__codelineno-8-135"></a>  PRINT &quot;This is why Monte Carlo is essential for high-dimensional problems.&quot;
</span><span id="__span-8-136"><a id="__codelineno-8-136" name="__codelineno-8-136" href="#__codelineno-8-136"></a>
</span><span id="__span-8-137"><a id="__codelineno-8-137" name="__codelineno-8-137" href="#__codelineno-8-137"></a>END
</span></code></pre></div>
<hr />
<h4 id="outcome-and-interpretation_6"><strong>Outcome and Interpretation</strong></h4>
<ul>
<li><strong>Visual Result:</strong> The log-log plot shows two dramatically different behaviors:</li>
<li><strong>Simpson's Rule (blue):</strong> Clean, steep downward line with slope <span class="arithmatex">\(\approx -4\)</span></li>
<li>
<p><strong>Monte Carlo (red):</strong> Noisy, shallow downward line with slope <span class="arithmatex">\(\approx -0.5\)</span></p>
</li>
<li>
<p><strong>Quantitative Comparison at Key Points:</strong></p>
</li>
</ul>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(N\)</span></th>
<th>Simpson's Error</th>
<th>Monte Carlo Error</th>
</tr>
</thead>
<tbody>
<tr>
<td>100</td>
<td><span class="arithmatex">\(\sim 10^{-8}\)</span></td>
<td><span class="arithmatex">\(\sim 10^{-1}\)</span></td>
</tr>
<tr>
<td>1,000</td>
<td><span class="arithmatex">\(\sim 10^{-14}\)</span></td>
<td><span class="arithmatex">\(\sim 10^{-1.5}\)</span></td>
</tr>
<tr>
<td>10,000</td>
<td>(machine limit)</td>
<td><span class="arithmatex">\(\sim 10^{-2}\)</span></td>
</tr>
<tr>
<td>100,000</td>
<td>(machine limit)</td>
<td><span class="arithmatex">\(\sim 10^{-2.5}\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>The Dramatic Difference:</strong> To achieve error <span class="arithmatex">\(&lt; 10^{-6}\)</span>:</li>
<li>Simpson's needs: <span class="arithmatex">\(N \approx 50\)</span> points</li>
<li>Monte Carlo needs: <span class="arithmatex">\(N \approx 10^{12}\)</span> samples</li>
<li>
<p><strong>Factor difference: 20 billion!</strong></p>
</li>
<li>
<p><strong>Why Monte Carlo Shows Noise:</strong> </p>
</li>
<li>The error bars on the Monte Carlo curve come from running multiple trials at each <span class="arithmatex">\(N\)</span>.</li>
<li>This demonstrates the <strong>stochastic nature</strong> of Monte Carloâ€”different random samples give different results.</li>
<li>
<p>The noise decreases as <span class="arithmatex">\(1/\sqrt{N}\)</span> but never disappears entirely.</p>
</li>
<li>
<p><strong>The Critical Insight:</strong><br />
  This project proves that <strong>in 1D, Monte Carlo is terrible</strong> compared to grid methods. But remember: this is a 1D problem. In 100D:</p>
</li>
<li>Simpson's would need <span class="arithmatex">\(50^{100} \approx 10^{170}\)</span> points (more atoms than in the universe!)</li>
<li>
<p>Monte Carlo still needs only <span class="arithmatex">\(\sim 10^{12}\)</span> samples (feasible on modern supercomputers)</p>
</li>
<li>
<p><strong>Broader Applications (Volume II Preview):</strong></p>
</li>
<li><strong>Statistical Mechanics:</strong> Partition functions integrate over <span class="arithmatex">\(3N\)</span> spatial dimensions for <span class="arithmatex">\(N\)</span> particles</li>
<li><strong>Quantum Chemistry:</strong> Many-electron wavefunctions live in <span class="arithmatex">\(3N\)</span> dimensions</li>
<li><strong>Machine Learning:</strong> Loss functions in deep learning have millions of parameters</li>
<li>
<p><strong>Finance:</strong> Risk analysis over hundreds of correlated assets</p>
</li>
<li>
<p><strong>The Fundamental Trade-off:</strong>  </p>
</li>
<li><strong>Grid methods:</strong> Fast convergence, exponential cost scaling with dimension</li>
<li><strong>Monte Carlo:</strong> Slow convergence, constant cost scaling with dimension</li>
<li><strong>The crossover:</strong> Around <span class="arithmatex">\(D = 4-8\)</span> depending on accuracy requirements</li>
</ul>
<p>This project sets the stage for Volume II, where Monte Carlo methods become not just useful but <strong>absolutely essential</strong> for realistic many-body physics simulations.</p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../chapter-5/Chapter-5-WorkBook/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 5. Numerical Differentiation">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                5. Numerical Differentiation
              </div>
            </div>
          </a>
        
        
          
          <a href="../../chapter-7/Chapter-7-WorkBook/" class="md-footer__link md-footer__link--next" aria-label="Next: 7. Initial Value Problems I">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                7. Initial Value Problems I
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://bigbookofcomputing.github.io" target="_blank" rel="noopener" title="bigbookofcomputing.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bigbookofcomputing" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@big-book-of-computing" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../static/mathjax-config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>